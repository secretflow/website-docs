:target{#secretflow-ml-nn-sl-agglayer-package}

# secretflow\.ml.nn.sl.agglayer package

:target{#submodules}

## Submodules

:target{id="module-secretflow.ml.nn.sl.agglayer.agg_layer"}

## secretflow\.ml.nn.sl.agglayer.agg\_layer module

Aggregation Layer for SLModel

<strong>Classes:</strong>

<table>
  <tbody>
    <tr>
      <td>
        [`AggLayer`](#secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer "secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer")(device\_agg, parties, device\_y\[, ...])
      </td>

      <td>
        The aggregation layer is situated between Basenet and Fusenet and is responsible for feature fusion, communication compression, and other intermediate layer logic.
      </td>
    </tr>
  </tbody>
</table>

<Outline domain="py" objectType="class" target={"secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer"} module={"secretflow.ml.nn.sl.agglayer.agg_layer"} fullname={"AggLayer"} parameters={["device_agg", "parties", "device_y", "agg_method", "backend", "compressor"]} description={"\u57fa\u7c7b\uff1aobject"}>
  <Outline.Signature fullname="AggLayer" id="secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer">
    <Outline.Keyword>class<span>{" "}</span></Outline.Keyword><Outline.Prefix>secretflow\.ml.nn.sl.agglayer.agg\_layer.</Outline.Prefix><Outline.Name>AggLayer</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">device\_agg</span><span>:</span><span>{" "}</span><span className="name">[PYU](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYU "secretflow.device.device.pyu.PYU")<span>{" "}</span><span>|</span><span>{" "}</span>[SPU](secretflow.device.device.device.mdx#secretflow.device.device.spu.SPU "secretflow.device.device.spu.SPU")<span>{" "}</span><span>|</span><span>{" "}</span>[HEU](secretflow.device.device.device.mdx#secretflow.device.device.heu.HEU "secretflow.device.device.heu.HEU")</span></Outline.Parameter>, <Outline.Parameter><span className="name">parties</span><span>:</span><span>{" "}</span><span className="name">[List](https://docs.python.org/3/library/typing.html#typing.List "（在 Python v3.11）")<span>\[</span>[PYU](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYU "secretflow.device.device.pyu.PYU")<span>]</span></span></Outline.Parameter>, <Outline.Parameter><span className="name">device\_y</span><span>:</span><span>{" "}</span><span className="name">[PYU](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYU "secretflow.device.device.pyu.PYU")</span></Outline.Parameter>, <Outline.Parameter><span className="name">agg\_method</span><span>:</span><span>{" "}</span><span className="name">[AggMethod](#secretflow.ml.nn.sl.agglayer.agg_method.AggMethod "secretflow.ml.nn.sl.agglayer.agg_method.AggMethod")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "（在 Python v3.11）")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter>, <Outline.Parameter><span className="name">backend</span><span>:</span><span>{" "}</span><span className="name">[str](https://docs.python.org/3/library/stdtypes.html#str "（在 Python v3.11）")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>'tensorflow'</span></Outline.Parameter>, <Outline.Parameter><span className="name">compressor</span><span>:</span><span>{" "}</span><span className="name">[Compressor](secretflow.utils.utils.compressor.mdx#secretflow.utils.compressor.base.Compressor "secretflow.utils.compressor.base.Compressor")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "（在 Python v3.11）")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter><span>)</span></Outline.ParameterList>
  </Outline.Signature>

  <Outline.Content>
    基类：[`object`](https://docs.python.org/3/library/functions.html#object "（在 Python v3.11）")

    The aggregation layer is situated between Basenet and Fusenet and is responsible for feature fusion, communication compression, and other intermediate layer logic.
    .. attribute:: device\_agg

    > The party do aggregation,it can be a PYU,SPU,etc.

    <Outline domain="py" objectType="attribute" target={"secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.parties"} module={"secretflow.ml.nn.sl.agglayer.agg_layer"} fullname={"AggLayer.parties"} parameters={["device_agg", "parties", "device_y", "agg_method", "backend", "compressor"]} description={"List of all parties."}>
      <Outline.Signature fullname="AggLayer.parties" id="secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.parties">
        <Outline.Name>parties</Outline.Name>
      </Outline.Signature>

      <Outline.Content>
        List of all parties.
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="attribute" target={"secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.device_y"} module={"secretflow.ml.nn.sl.agglayer.agg_layer"} fullname={"AggLayer.device_y"} parameters={["device_agg", "parties", "device_y", "agg_method", "backend", "compressor"]} description={"The party which has fusenet"}>
      <Outline.Signature fullname="AggLayer.device_y" id="secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.device_y">
        <Outline.Name>device\_y</Outline.Name>
      </Outline.Signature>

      <Outline.Content>
        The party which has fusenet
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="attribute" target={"secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.agg_method"} module={"secretflow.ml.nn.sl.agglayer.agg_layer"} fullname={"AggLayer.agg_method"} parameters={["device_agg", "parties", "device_y", "agg_method", "backend", "compressor"]} description={"Aggregation method must inherit from agg_method.AggMethod"}>
      <Outline.Signature fullname="AggLayer.agg_method" id="secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.agg_method">
        <Outline.Name>agg\_method</Outline.Name>
      </Outline.Signature>

      <Outline.Content>
        Aggregation method must inherit from agg\_method.AggMethod
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="attribute" target={"secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.backend"} module={"secretflow.ml.nn.sl.agglayer.agg_layer"} fullname={"AggLayer.backend"} parameters={["device_agg", "parties", "device_y", "agg_method", "backend", "compressor"]} description={"tensorflow or torch"}>
      <Outline.Signature fullname="AggLayer.backend" id="secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.backend">
        <Outline.Name>backend</Outline.Name>
      </Outline.Signature>

      <Outline.Content>
        tensorflow or torch
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="attribute" target={"secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.compressor"} module={"secretflow.ml.nn.sl.agglayer.agg_layer"} fullname={"AggLayer.compressor"} parameters={["device_agg", "parties", "device_y", "agg_method", "backend", "compressor"]} description={"Define strategy tensor compression algorithms to speed up transmission."}>
      <Outline.Signature fullname="AggLayer.compressor" id="secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.compressor">
        <Outline.Name>compressor</Outline.Name>
      </Outline.Signature>

      <Outline.Content>
        Define strategy tensor compression algorithms to speed up transmission.
      </Outline.Content>
    </Outline>

    <strong>Methods:</strong>

    <table>
      <tbody>
        <tr>
          <td>
            [`__init__`](#secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.__init__ "secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.__init__")(device\_agg, parties, device\_y\[, ...])
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [`get_parties`](#secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.get_parties "secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.get_parties")()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [`set_basenet_output_num`](#secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.set_basenet_output_num "secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.set_basenet_output_num")(basenet\_output\_num)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [`convert_to_ndarray`](#secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.convert_to_ndarray "secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.convert_to_ndarray")(\*data)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [`convert_to_tensor`](#secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.convert_to_tensor "secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.convert_to_tensor")(hidden, backend)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [`get_hiddens`](#secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.get_hiddens "secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.get_hiddens")(f\_data)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [`get_reg_loss`](#secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.get_reg_loss "secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.get_reg_loss")(f\_data)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [`set_forward_data`](#secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.set_forward_data "secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.set_forward_data")(hidden, losses)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [`decompress_hiddens`](#secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.decompress_hiddens "secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.decompress_hiddens")(data, compressor)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [`compress_gradients`](#secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.compress_gradients "secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.compress_gradients")(gradients, ...)
          </td>

          <td>
            compress gradients to sparse format
          </td>
        </tr>

        <tr>
          <td>
            [`split_to_parties`](#secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.split_to_parties "secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.split_to_parties")(data)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [`collect`](#secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.collect "secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.collect")(data)
          </td>

          <td>
            Collect data from participates TODO: Support compress communication when using agg method.
          </td>
        </tr>

        <tr>
          <td>
            [`parse_gradients`](#secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.parse_gradients "secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.parse_gradients")(gradients)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [`scatter`](#secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.scatter "secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.scatter")(data)
          </td>

          <td>
            Send ForwardData to participates
          </td>
        </tr>

        <tr>
          <td>
            [`forward`](#secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.forward "secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.forward")(data\[, axis, weights])
          </td>

          <td>
            Forward aggregate the embeddings calculated by all parties according to the agg\_method
          </td>
        </tr>

        <tr>
          <td>
            [`backward`](#secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.backward "secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.backward")(gradient\[, weights])
          </td>

          <td>
            Backward split the gradients to all parties according to the agg\_method
          </td>
        </tr>
      </tbody>
    </table>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.__init__"} module={"secretflow.ml.nn.sl.agglayer.agg_layer"} fullname={"AggLayer.__init__"} parameters={["device_agg", "parties", "device_y", "agg_method", "backend", "compressor"]} description={"\u57fa\u7c7b\uff1aobject"}>
      <Outline.Signature fullname="AggLayer.__init__" id="secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.__init__">
        <Outline.Name>\_\_init\_\_</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">device\_agg</span><span>:</span><span>{" "}</span><span className="name">[PYU](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYU "secretflow.device.device.pyu.PYU")<span>{" "}</span><span>|</span><span>{" "}</span>[SPU](secretflow.device.device.device.mdx#secretflow.device.device.spu.SPU "secretflow.device.device.spu.SPU")<span>{" "}</span><span>|</span><span>{" "}</span>[HEU](secretflow.device.device.device.mdx#secretflow.device.device.heu.HEU "secretflow.device.device.heu.HEU")</span></Outline.Parameter>, <Outline.Parameter><span className="name">parties</span><span>:</span><span>{" "}</span><span className="name">[List](https://docs.python.org/3/library/typing.html#typing.List "（在 Python v3.11）")<span>\[</span>[PYU](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYU "secretflow.device.device.pyu.PYU")<span>]</span></span></Outline.Parameter>, <Outline.Parameter><span className="name">device\_y</span><span>:</span><span>{" "}</span><span className="name">[PYU](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYU "secretflow.device.device.pyu.PYU")</span></Outline.Parameter>, <Outline.Parameter><span className="name">agg\_method</span><span>:</span><span>{" "}</span><span className="name">[AggMethod](#secretflow.ml.nn.sl.agglayer.agg_method.AggMethod "secretflow.ml.nn.sl.agglayer.agg_method.AggMethod")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "（在 Python v3.11）")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter>, <Outline.Parameter><span className="name">backend</span><span>:</span><span>{" "}</span><span className="name">[str](https://docs.python.org/3/library/stdtypes.html#str "（在 Python v3.11）")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>'tensorflow'</span></Outline.Parameter>, <Outline.Parameter><span className="name">compressor</span><span>:</span><span>{" "}</span><span className="name">[Compressor](secretflow.utils.utils.compressor.mdx#secretflow.utils.compressor.base.Compressor "secretflow.utils.compressor.base.Compressor")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "（在 Python v3.11）")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.get_parties"} module={"secretflow.ml.nn.sl.agglayer.agg_layer"} fullname={"AggLayer.get_parties"} parameters={[]} description={"\u57fa\u7c7b\uff1aobject"}>
      <Outline.Signature fullname="AggLayer.get_parties" id="secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.get_parties">
        <Outline.Name>get\_parties</Outline.Name><Outline.ParameterList><span>(</span><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.set_basenet_output_num"} module={"secretflow.ml.nn.sl.agglayer.agg_layer"} fullname={"AggLayer.set_basenet_output_num"} parameters={["basenet_output_num"]} description={"\u57fa\u7c7b\uff1aobject"}>
      <Outline.Signature fullname="AggLayer.set_basenet_output_num" id="secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.set_basenet_output_num">
        <Outline.Name>set\_basenet\_output\_num</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">basenet\_output\_num</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "（在 Python v3.11）")</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.convert_to_ndarray"} module={"secretflow.ml.nn.sl.agglayer.agg_layer"} fullname={"AggLayer.convert_to_ndarray"} parameters={["data"]} description={"\u57fa\u7c7b\uff1aobject"}>
      <Outline.Signature fullname="AggLayer.convert_to_ndarray" id="secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.convert_to_ndarray">
        <Outline.Keyword>static<span>{" "}</span></Outline.Keyword><Outline.Name>convert\_to\_ndarray</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span>\*</span><span className="name">data</span><span>:</span><span>{" "}</span><span className="name">[List](https://docs.python.org/3/library/typing.html#typing.List "（在 Python v3.11）")</span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[List](https://docs.python.org/3/library/typing.html#typing.List "（在 Python v3.11）")<span>\[</span>Array<span>]</span><span>{" "}</span><span>|</span><span>{" "}</span>Array</Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.convert_to_tensor"} module={"secretflow.ml.nn.sl.agglayer.agg_layer"} fullname={"AggLayer.convert_to_tensor"} parameters={["hidden", "backend"]} description={"\u57fa\u7c7b\uff1aobject"}>
      <Outline.Signature fullname="AggLayer.convert_to_tensor" id="secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.convert_to_tensor">
        <Outline.Keyword>static<span>{" "}</span></Outline.Keyword><Outline.Name>convert\_to\_tensor</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">hidden</span><span>:</span><span>{" "}</span><span className="name">[List](https://docs.python.org/3/library/typing.html#typing.List "（在 Python v3.11）")<span>{" "}</span><span>|</span><span>{" "}</span>[Tuple](https://docs.python.org/3/library/typing.html#typing.Tuple "（在 Python v3.11）")</span></Outline.Parameter>, <Outline.Parameter><span className="name">backend</span><span>:</span><span>{" "}</span><span className="name">[str](https://docs.python.org/3/library/stdtypes.html#str "（在 Python v3.11）")</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.get_hiddens"} module={"secretflow.ml.nn.sl.agglayer.agg_layer"} fullname={"AggLayer.get_hiddens"} parameters={["f_data"]} description={"\u57fa\u7c7b\uff1aobject"}>
      <Outline.Signature fullname="AggLayer.get_hiddens" id="secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.get_hiddens">
        <Outline.Keyword>static<span>{" "}</span></Outline.Keyword><Outline.Name>get\_hiddens</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">f\_data</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.get_reg_loss"} module={"secretflow.ml.nn.sl.agglayer.agg_layer"} fullname={"AggLayer.get_reg_loss"} parameters={["f_data"]} description={"\u57fa\u7c7b\uff1aobject"}>
      <Outline.Signature fullname="AggLayer.get_reg_loss" id="secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.get_reg_loss">
        <Outline.Keyword>static<span>{" "}</span></Outline.Keyword><Outline.Name>get\_reg\_loss</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">f\_data</span><span>:</span><span>{" "}</span><span className="name">[ForwardData](secretflow.utils.mdx#secretflow.utils.communicate.ForwardData "secretflow.utils.communicate.ForwardData")</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.set_forward_data"} module={"secretflow.ml.nn.sl.agglayer.agg_layer"} fullname={"AggLayer.set_forward_data"} parameters={["hidden", "losses"]} description={"\u57fa\u7c7b\uff1aobject"}>
      <Outline.Signature fullname="AggLayer.set_forward_data" id="secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.set_forward_data">
        <Outline.Keyword>static<span>{" "}</span></Outline.Keyword><Outline.Name>set\_forward\_data</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">hidden</span></Outline.Parameter>, <Outline.Parameter><span className="name">losses</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.decompress_hiddens"} module={"secretflow.ml.nn.sl.agglayer.agg_layer"} fullname={"AggLayer.decompress_hiddens"} parameters={["data", "compressor"]} description={"\u57fa\u7c7b\uff1aobject"}>
      <Outline.Signature fullname="AggLayer.decompress_hiddens" id="secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.decompress_hiddens">
        <Outline.Keyword>static<span>{" "}</span></Outline.Keyword><Outline.Name>decompress\_hiddens</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">data</span></Outline.Parameter>, <Outline.Parameter><span className="name">compressor</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.compress_gradients"} module={"secretflow.ml.nn.sl.agglayer.agg_layer"} fullname={"AggLayer.compress_gradients"} parameters={["gradients", "fuse_sparse_masks", "compressor", "iscompressed"]} description={"compress gradients to sparse format"}>
      <Outline.Signature fullname="AggLayer.compress_gradients" id="secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.compress_gradients">
        <Outline.Keyword>static<span>{" "}</span></Outline.Keyword><Outline.Name>compress\_gradients</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">gradients</span></Outline.Parameter>, <Outline.Parameter><span className="name">fuse\_sparse\_masks</span></Outline.Parameter>, <Outline.Parameter><span className="name">compressor</span></Outline.Parameter>, <Outline.Parameter><span className="name">iscompressed</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content>
        compress gradients to sparse format
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.split_to_parties"} module={"secretflow.ml.nn.sl.agglayer.agg_layer"} fullname={"AggLayer.split_to_parties"} parameters={["data"]} description={"\u57fa\u7c7b\uff1aobject"}>
      <Outline.Signature fullname="AggLayer.split_to_parties" id="secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.split_to_parties">
        <Outline.Name>split\_to\_parties</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">data</span><span>:</span><span>{" "}</span><span className="name">[List](https://docs.python.org/3/library/typing.html#typing.List "（在 Python v3.11）")</span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[List](https://docs.python.org/3/library/typing.html#typing.List "（在 Python v3.11）")<span>\[</span>[PYUObject](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYUObject "secretflow.device.device.pyu.PYUObject")<span>]</span></Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.collect"} module={"secretflow.ml.nn.sl.agglayer.agg_layer"} fullname={"AggLayer.collect"} parameters={["data"]} description={"Collect data from participates\nTODO: Support compress communication when using agg method."}>
      <Outline.Signature fullname="AggLayer.collect" id="secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.collect">
        <Outline.Name>collect</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">data</span><span>:</span><span>{" "}</span><span className="name">[Dict](https://docs.python.org/3/library/typing.html#typing.Dict "（在 Python v3.11）")<span>\[</span>[PYU](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYU "secretflow.device.device.pyu.PYU")<span>,</span><span>{" "}</span>[DeviceObject](secretflow.device.device.device.mdx#secretflow.device.device.base.DeviceObject "secretflow.device.device.base.DeviceObject")<span>]</span></span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[List](https://docs.python.org/3/library/typing.html#typing.List "（在 Python v3.11）")<span>\[</span>[DeviceObject](secretflow.device.device.device.mdx#secretflow.device.device.base.DeviceObject "secretflow.device.device.base.DeviceObject")<span>]</span></Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content>
        Collect data from participates
        TODO: Support compress communication when using agg method.
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.parse_gradients"} module={"secretflow.ml.nn.sl.agglayer.agg_layer"} fullname={"AggLayer.parse_gradients"} parameters={["gradients"]} description={"\u57fa\u7c7b\uff1aobject"}>
      <Outline.Signature fullname="AggLayer.parse_gradients" id="secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.parse_gradients">
        <Outline.Keyword>static<span>{" "}</span></Outline.Keyword><Outline.Name>parse\_gradients</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">gradients</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.scatter"} module={"secretflow.ml.nn.sl.agglayer.agg_layer"} fullname={"AggLayer.scatter"} parameters={["data"]} description={"Send ForwardData to participates"}>
      <Outline.Signature fullname="AggLayer.scatter" id="secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.scatter">
        <Outline.Name>scatter</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">data</span><span>:</span><span>{" "}</span><span className="name">[List](https://docs.python.org/3/library/typing.html#typing.List "（在 Python v3.11）")<span>{" "}</span><span>|</span><span>{" "}</span>[PYUObject](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYUObject "secretflow.device.device.pyu.PYUObject")</span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[Dict](https://docs.python.org/3/library/typing.html#typing.Dict "（在 Python v3.11）")<span>\[</span>[PYU](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYU "secretflow.device.device.pyu.PYU")<span>,</span><span>{" "}</span>[DeviceObject](secretflow.device.device.device.mdx#secretflow.device.device.base.DeviceObject "secretflow.device.device.base.DeviceObject")<span>]</span></Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content>
        Send ForwardData to participates
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.forward"} module={"secretflow.ml.nn.sl.agglayer.agg_layer"} fullname={"AggLayer.forward"} parameters={["data", "axis", "weights"]} description={"Forward aggregate the embeddings calculated by all parties according to the agg_method"}>
      <Outline.Signature fullname="AggLayer.forward" id="secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.forward">
        <Outline.Name>forward</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">data</span><span>:</span><span>{" "}</span><span className="name">[Dict](https://docs.python.org/3/library/typing.html#typing.Dict "（在 Python v3.11）")<span>\[</span>[PYU](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYU "secretflow.device.device.pyu.PYU")<span>,</span><span>{" "}</span>[DeviceObject](secretflow.device.device.device.mdx#secretflow.device.device.base.DeviceObject "secretflow.device.device.base.DeviceObject")<span>]</span></span></Outline.Parameter>, <Outline.Parameter><span className="name">axis</span><span>=</span><span>0</span></Outline.Parameter>, <Outline.Parameter><span className="name">weights</span><span>=</span><span>None</span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[DeviceObject](secretflow.device.device.device.mdx#secretflow.device.device.base.DeviceObject "secretflow.device.device.base.DeviceObject")</Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content>
        Forward aggregate the embeddings calculated by all parties according to the agg\_method

        <FieldList>
          <dl>
            <dt className="field-name">
              参数
            </dt>

            <dd className="field-body">
              - <strong>data</strong> – A dict contain PYU and ForwardData
              - <strong>axis</strong> – Along which axis will the merge be done, default 0
              - <strong>weights</strong> – weight of each side, default to be none
            </dd>

            <dt className="field-name">
              返回
            </dt>

            <dd className="field-body">
              return aggregated result in tensor type
            </dd>

            <dt className="field-name">
              返回类型
            </dt>

            <dd className="field-body">
              agg\_data\_tensor
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.backward"} module={"secretflow.ml.nn.sl.agglayer.agg_layer"} fullname={"AggLayer.backward"} parameters={["gradient", "weights"]} description={"Backward split the gradients to all parties according to the agg_method"}>
      <Outline.Signature fullname="AggLayer.backward" id="secretflow.ml.nn.sl.agglayer.agg_layer.AggLayer.backward">
        <Outline.Name>backward</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">gradient</span><span>:</span><span>{" "}</span><span className="name">[DeviceObject](secretflow.device.device.device.mdx#secretflow.device.device.base.DeviceObject "secretflow.device.device.base.DeviceObject")</span></Outline.Parameter>, <Outline.Parameter><span className="name">weights</span><span>=</span><span>None</span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[Dict](https://docs.python.org/3/library/typing.html#typing.Dict "（在 Python v3.11）")<span>\[</span>[PYU](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYU "secretflow.device.device.pyu.PYU")<span>,</span><span>{" "}</span>[DeviceObject](secretflow.device.device.device.mdx#secretflow.device.device.base.DeviceObject "secretflow.device.device.base.DeviceObject")<span>]</span></Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content>
        Backward split the gradients to all parties according to the agg\_method

        <FieldList>
          <dl>
            <dt className="field-name">
              参数
            </dt>

            <dd className="field-body">
              - <strong>gradient</strong> – Gradient, tensor format calculated from fusenet
              - <strong>weights</strong> – Weights of each side, default to be none
            </dd>

            <dt className="field-name">
              返回
            </dt>

            <dd className="field-body">
              Return gradients computed following the agg\_method.backward and send to each parties
            </dd>

            <dt className="field-name">
              返回类型
            </dt>

            <dd className="field-body">
              scatter\_gragient
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>
  </Outline.Content>
</Outline>

:target{id="module-secretflow.ml.nn.sl.agglayer.agg_method"}

## secretflow\.ml.nn.sl.agglayer.agg\_method module

AggLayer method

<strong>Functions:</strong>

<table>
  <tbody>
    <tr>
      <td>
        [`auto_grad`](#secretflow.ml.nn.sl.agglayer.agg_method.auto_grad "secretflow.ml.nn.sl.agglayer.agg_method.auto_grad")(func)
      </td>

      <td>

      </td>
    </tr>
  </tbody>
</table>

<strong>Classes:</strong>

<table>
  <tbody>
    <tr>
      <td>
        [`AggMethod`](#secretflow.ml.nn.sl.agglayer.agg_method.AggMethod "secretflow.ml.nn.sl.agglayer.agg_method.AggMethod")()
      </td>

      <td>
        Base class of aggregation method for AggLayer The object of subclass will be passed into AggLayer for use.
      </td>
    </tr>

    <tr>
      <td>
        [`Average`](#secretflow.ml.nn.sl.agglayer.agg_method.Average "secretflow.ml.nn.sl.agglayer.agg_method.Average")()
      </td>

      <td>
        Built-in Average Aggregation Method.
      </td>
    </tr>
  </tbody>
</table>

<Outline domain="py" objectType="function" target={"secretflow.ml.nn.sl.agglayer.agg_method.auto_grad"} module={"secretflow.ml.nn.sl.agglayer.agg_method"} fullname={"auto_grad"} parameters={["func"]}>
  <Outline.Signature fullname="auto_grad" id="secretflow.ml.nn.sl.agglayer.agg_method.auto_grad">
    <Outline.Prefix>secretflow\.ml.nn.sl.agglayer.agg\_method.</Outline.Prefix><Outline.Name>auto\_grad</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">func</span></Outline.Parameter><span>)</span></Outline.ParameterList>
  </Outline.Signature>

  <Outline.Content />
</Outline>

<Outline domain="py" objectType="class" target={"secretflow.ml.nn.sl.agglayer.agg_method.AggMethod"} module={"secretflow.ml.nn.sl.agglayer.agg_method"} fullname={"AggMethod"} description={"\u57fa\u7c7b\uff1aABC"}>
  <Outline.Signature fullname="AggMethod" id="secretflow.ml.nn.sl.agglayer.agg_method.AggMethod">
    <Outline.Keyword>class<span>{" "}</span></Outline.Keyword><Outline.Prefix>secretflow\.ml.nn.sl.agglayer.agg\_method.</Outline.Prefix><Outline.Name>AggMethod</Outline.Name>
  </Outline.Signature>

  <Outline.Content>
    基类：[`ABC`](https://docs.python.org/3/library/abc.html#abc.ABC "（在 Python v3.11）")

    Base class of aggregation method for AggLayer
    The object of subclass will be passed into AggLayer for use.
    custum aggmethod should inherit this class, and override ‘forward’ and ‘backward’
    Since aggmethod can support secure computation and plaintext computation, please use jax-numpy for development

    <strong>Methods:</strong>

    <table>
      <tbody>
        <tr>
          <td>
            [`__init__`](#secretflow.ml.nn.sl.agglayer.agg_method.AggMethod.__init__ "secretflow.ml.nn.sl.agglayer.agg_method.AggMethod.__init__")()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [`forward`](#secretflow.ml.nn.sl.agglayer.agg_method.AggMethod.forward "secretflow.ml.nn.sl.agglayer.agg_method.AggMethod.forward")(data, \*\*kwargs)
          </td>

          <td>
            define how to merge data from parties
          </td>
        </tr>

        <tr>
          <td>
            [`backward`](#secretflow.ml.nn.sl.agglayer.agg_method.AggMethod.backward "secretflow.ml.nn.sl.agglayer.agg_method.AggMethod.backward")(\*gradients, parties\_num, weights, ...)
          </td>

          <td>

          </td>
        </tr>
      </tbody>
    </table>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.agglayer.agg_method.AggMethod.__init__"} module={"secretflow.ml.nn.sl.agglayer.agg_method"} fullname={"AggMethod.__init__"} description={"\u57fa\u7c7b\uff1aABC"} parameters={[]}>
      <Outline.Signature fullname="AggMethod.__init__" id="secretflow.ml.nn.sl.agglayer.agg_method.AggMethod.__init__">
        <Outline.Name>\_\_init\_\_</Outline.Name><Outline.ParameterList><span>(</span><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[None](https://docs.python.org/3/library/constants.html#None "（在 Python v3.11）")</Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.agglayer.agg_method.AggMethod.forward"} module={"secretflow.ml.nn.sl.agglayer.agg_method"} fullname={"AggMethod.forward"} description={"define how to merge data from parties"} parameters={["data", "kwargs"]}>
      <Outline.Signature fullname="AggMethod.forward" id="secretflow.ml.nn.sl.agglayer.agg_method.AggMethod.forward">
        <Outline.Keyword>abstract<span>{" "}</span></Outline.Keyword><Outline.Name>forward</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">data</span><span>:</span><span>{" "}</span><span className="name">[List](https://docs.python.org/3/library/typing.html#typing.List "（在 Python v3.11）")</span></Outline.Parameter>, <Outline.Parameter><span>\*\*</span><span className="name">kwargs</span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>Array</Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content>
        define how to merge data from parties
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.agglayer.agg_method.AggMethod.backward"} module={"secretflow.ml.nn.sl.agglayer.agg_method"} fullname={"AggMethod.backward"} description={"\u57fa\u7c7b\uff1aABC"} parameters={["gradients", "parties_num", "weights", "inputs"]}>
      <Outline.Signature fullname="AggMethod.backward" id="secretflow.ml.nn.sl.agglayer.agg_method.AggMethod.backward">
        <Outline.Name>backward</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span>\*</span><span className="name">gradients</span></Outline.Parameter>, <Outline.Parameter><span className="name">parties\_num</span></Outline.Parameter>, <Outline.Parameter><span className="name">weights</span></Outline.Parameter>, <Outline.Parameter><span className="name">inputs</span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[List](https://docs.python.org/3/library/typing.html#typing.List "（在 Python v3.11）")</Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content />
    </Outline>
  </Outline.Content>
</Outline>

<Outline domain="py" objectType="class" target={"secretflow.ml.nn.sl.agglayer.agg_method.Average"} module={"secretflow.ml.nn.sl.agglayer.agg_method"} fullname={"Average"} description={"\u57fa\u7c7b\uff1aAggMethod"}>
  <Outline.Signature fullname="Average" id="secretflow.ml.nn.sl.agglayer.agg_method.Average">
    <Outline.Keyword>class<span>{" "}</span></Outline.Keyword><Outline.Prefix>secretflow\.ml.nn.sl.agglayer.agg\_method.</Outline.Prefix><Outline.Name>Average</Outline.Name>
  </Outline.Signature>

  <Outline.Content>
    基类：[`AggMethod`](#secretflow.ml.nn.sl.agglayer.agg_method.AggMethod "secretflow.ml.nn.sl.agglayer.agg_method.AggMethod")

    Built-in Average Aggregation Method.

    <strong>Methods:</strong>

    <table>
      <tbody>
        <tr>
          <td>
            [`__init__`](#secretflow.ml.nn.sl.agglayer.agg_method.Average.__init__ "secretflow.ml.nn.sl.agglayer.agg_method.Average.__init__")()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [`forward`](#secretflow.ml.nn.sl.agglayer.agg_method.Average.forward "secretflow.ml.nn.sl.agglayer.agg_method.Average.forward")(\*data\[, axis, weights])
          </td>

          <td>
            define how to merge data from parties
          </td>
        </tr>
      </tbody>
    </table>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.agglayer.agg_method.Average.__init__"} module={"secretflow.ml.nn.sl.agglayer.agg_method"} fullname={"Average.__init__"} description={"\u57fa\u7c7b\uff1aAggMethod"} parameters={[]}>
      <Outline.Signature fullname="Average.__init__" id="secretflow.ml.nn.sl.agglayer.agg_method.Average.__init__">
        <Outline.Name>\_\_init\_\_</Outline.Name><Outline.ParameterList><span>(</span><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[None](https://docs.python.org/3/library/constants.html#None "（在 Python v3.11）")</Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.agglayer.agg_method.Average.forward"} module={"secretflow.ml.nn.sl.agglayer.agg_method"} fullname={"Average.forward"} description={"define how to merge data from parties"} parameters={["data", "axis", "weights"]}>
      <Outline.Signature fullname="Average.forward" id="secretflow.ml.nn.sl.agglayer.agg_method.Average.forward">
        <Outline.Name>forward</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span>\*</span><span className="name">data</span></Outline.Parameter>, <Outline.Parameter><span className="name">axis</span><span>=</span><span>0</span></Outline.Parameter>, <Outline.Parameter><span className="name">weights</span><span>=</span><span>None</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content>
        define how to merge data from parties
      </Outline.Content>
    </Outline>
  </Outline.Content>
</Outline>

:target{id="module-secretflow.ml.nn.sl.agglayer"}

## Module contents
