:target{#secretflow-ml-nn-fl-backend-torch-package}

# secretflow\.ml.nn.fl.backend.torch package

:target{#subpackages}

## Subpackages

<TableOfContents>


  - [secretflow.ml.nn.fl.backend.torch.strategy package](secretflow.ml.nn.fl.backend.torch.ml.nn.fl.backend.torch.strategy.mdx)
    - [Submodules](secretflow.ml.nn.fl.backend.torch.ml.nn.fl.backend.torch.strategy.mdx#submodules)
    - [secretflow.ml.nn.fl.backend.torch.strategy.fed\_avg\_g module](secretflow.ml.nn.fl.backend.torch.ml.nn.fl.backend.torch.strategy.mdx#module-secretflow.ml.nn.fl.backend.torch.strategy.fed_avg_g)
    - [secretflow.ml.nn.fl.backend.torch.strategy.fed\_avg\_u module](secretflow.ml.nn.fl.backend.torch.ml.nn.fl.backend.torch.strategy.mdx#module-secretflow.ml.nn.fl.backend.torch.strategy.fed_avg_u)
    - [secretflow.ml.nn.fl.backend.torch.strategy.fed\_avg\_w module](secretflow.ml.nn.fl.backend.torch.ml.nn.fl.backend.torch.strategy.mdx#module-secretflow.ml.nn.fl.backend.torch.strategy.fed_avg_w)
    - [secretflow.ml.nn.fl.backend.torch.strategy.fed\_prox module](secretflow.ml.nn.fl.backend.torch.ml.nn.fl.backend.torch.strategy.mdx#module-secretflow.ml.nn.fl.backend.torch.strategy.fed_prox)
    - [secretflow.ml.nn.fl.backend.torch.strategy.fed\_scr module](secretflow.ml.nn.fl.backend.torch.ml.nn.fl.backend.torch.strategy.mdx#module-secretflow.ml.nn.fl.backend.torch.strategy.fed_scr)
    - [secretflow.ml.nn.fl.backend.torch.strategy.fed\_stc module](secretflow.ml.nn.fl.backend.torch.ml.nn.fl.backend.torch.strategy.mdx#module-secretflow.ml.nn.fl.backend.torch.strategy.fed_stc)
    - [Module contents](secretflow.ml.nn.fl.backend.torch.ml.nn.fl.backend.torch.strategy.mdx#module-secretflow.ml.nn.fl.backend.torch.strategy)
</TableOfContents>

:target{#submodules}

## Submodules

:target{id="module-secretflow.ml.nn.fl.backend.torch.fl_base"}

## secretflow\.ml.nn.fl.backend.torch.fl\_base module

Torch model on worker side

<strong>Classes:</strong>

<table>
  <tbody>
    <tr>
      <td>
        [<code>BaseTorchModel</code>](#secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel "secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel")(builder\_base\[, random\_seed])
      </td>

      <td>

      </td>
    </tr>
  </tbody>
</table>

<Outline domain="py" objectType="class" target={"secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel"} module={"secretflow.ml.nn.fl.backend.torch.fl_base"} fullname={"BaseTorchModel"} parameters={["builder_base", "random_seed"]} description={"\u57fa\u7c7b\uff1aABC"}>
  <Outline.Signature fullname="BaseTorchModel" id="secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel">
    <Outline.Keyword>class<span>{" "}</span></Outline.Keyword><Outline.Prefix>secretflow\.ml.nn.fl.backend.torch.fl\_base.</Outline.Prefix><Outline.Name>BaseTorchModel</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">builder\_base</span><span>:</span><span>{" "}</span><span className="name">[Callable](https://docs.python.org/3/library/typing.html#typing.Callable "（在 Python v3.11）")<span>\[</span><span>\[</span><span>]</span><span>,</span><span>{" "}</span>[TorchModel](secretflow.ml.ml.nn.mdx#secretflow.ml.nn.utils.TorchModel "secretflow.ml.nn.utils.TorchModel")<span>]</span></span></Outline.Parameter>, <Outline.Parameter><span className="name">random\_seed</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "（在 Python v3.11）")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "（在 Python v3.11）")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter><span>)</span></Outline.ParameterList>
  </Outline.Signature>

  <Outline.Content>
    基类：[<code>ABC</code>](https://docs.python.org/3/library/abc.html#abc.ABC "（在 Python v3.11）")

    <strong>Methods:</strong>

    <table>
      <tbody>
        <tr>
          <td>
            [<code>\_\_init\_\_</code>](#secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.__init__ "secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.__init__")(builder\_base\[, random\_seed])
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>build\_dataset\_from\_csv</code>](#secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.build_dataset_from_csv "secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.build_dataset_from_csv")(csv\_file\_path, label)
          </td>

          <td>
            build torch.dataloader
          </td>
        </tr>

        <tr>
          <td>
            [<code>build\_dataset</code>](#secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.build_dataset "secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.build_dataset")(x\[, y, s\_w, sampling\_rate, ...])
          </td>

          <td>
            build torch.dataloader
          </td>
        </tr>

        <tr>
          <td>
            [<code>build\_dataset\_from\_builder</code>](#secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.build_dataset_from_builder "secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.build_dataset_from_builder")(dataset\_builder, x)
          </td>

          <td>
            build tf.data.Dataset
          </td>
        </tr>

        <tr>
          <td>
            [<code>get\_rows\_count</code>](#secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.get_rows_count "secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.get_rows_count")(filename)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>get\_weights</code>](#secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.get_weights "secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.get_weights")()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>set\_weights</code>](#secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.set_weights "secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.set_weights")(weights)
          </td>

          <td>
            set weights of client model
          </td>
        </tr>

        <tr>
          <td>
            [<code>set\_validation\_metrics</code>](#secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.set_validation_metrics "secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.set_validation_metrics")(global\_metrics)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>wrap\_local\_metrics</code>](#secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.wrap_local_metrics "secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.wrap_local_metrics")()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>evaluate</code>](#secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.evaluate "secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.evaluate")(\[evaluate\_steps])
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>predict</code>](#secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.predict "secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.predict")(\[predict\_steps])
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>init\_training</code>](#secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.init_training "secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.init_training")(callbacks\[, epochs, steps, ...])
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>on\_train\_begin</code>](#secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.on_train_begin "secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.on_train_begin")()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>on\_epoch\_begin</code>](#secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.on_epoch_begin "secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.on_epoch_begin")(epoch)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>on\_epoch\_end</code>](#secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.on_epoch_end "secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.on_epoch_end")(epoch)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>transform\_metrics</code>](#secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.transform_metrics "secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.transform_metrics")(logs\[, stage])
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>on\_train\_end</code>](#secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.on_train_end "secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.on_train_end")()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>get\_stop\_training</code>](#secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.get_stop_training "secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.get_stop_training")()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>train\_step</code>](#secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.train_step "secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.train_step")(weights, cur\_steps, train\_steps, ...)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>save\_model</code>](#secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.save_model "secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.save_model")(model\_path)
          </td>

          <td>
            For compatibility reasons it is recommended to instead save only its state dict Ref\:https\://pytorch.org/docs/master/notes/serialization.html#id5
          </td>
        </tr>

        <tr>
          <td>
            [<code>load\_model</code>](#secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.load_model "secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.load_model")(model\_path)
          </td>

          <td>
            load model from state dict, model structure must be defined before load
          </td>
        </tr>
      </tbody>
    </table>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.__init__"} module={"secretflow.ml.nn.fl.backend.torch.fl_base"} fullname={"BaseTorchModel.__init__"} parameters={["builder_base", "random_seed"]} description={"\u57fa\u7c7b\uff1aABC"}>
      <Outline.Signature fullname="BaseTorchModel.__init__" id="secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.__init__">
        <Outline.Name>\_\_init\_\_</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">builder\_base</span><span>:</span><span>{" "}</span><span className="name">[Callable](https://docs.python.org/3/library/typing.html#typing.Callable "（在 Python v3.11）")<span>\[</span><span>\[</span><span>]</span><span>,</span><span>{" "}</span>[TorchModel](secretflow.ml.ml.nn.mdx#secretflow.ml.nn.utils.TorchModel "secretflow.ml.nn.utils.TorchModel")<span>]</span></span></Outline.Parameter>, <Outline.Parameter><span className="name">random\_seed</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "（在 Python v3.11）")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "（在 Python v3.11）")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.build_dataset_from_csv"} module={"secretflow.ml.nn.fl.backend.torch.fl_base"} fullname={"BaseTorchModel.build_dataset_from_csv"} parameters={["csv_file_path", "label", "sampling_rate", "shuffle", "random_seed", "na_value", "repeat_count", "sample_length", "buffer_size", "ignore_errors", "prefetch_buffer_size", "stage", "label_decoder"]} description={"build torch.dataloader"}>
      <Outline.Signature fullname="BaseTorchModel.build_dataset_from_csv" id="secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.build_dataset_from_csv">
        <Outline.Name>build\_dataset\_from\_csv</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">csv\_file\_path</span><span>:</span><span>{" "}</span><span className="name">[str](https://docs.python.org/3/library/stdtypes.html#str "（在 Python v3.11）")</span></Outline.Parameter>, <Outline.Parameter><span className="name">label</span><span>:</span><span>{" "}</span><span className="name">[str](https://docs.python.org/3/library/stdtypes.html#str "（在 Python v3.11）")</span></Outline.Parameter>, <Outline.Parameter><span className="name">sampling\_rate</span><span>=</span><span>None</span></Outline.Parameter>, <Outline.Parameter><span className="name">shuffle</span><span>=</span><span>False</span></Outline.Parameter>, <Outline.Parameter><span className="name">random\_seed</span><span>=</span><span>1234</span></Outline.Parameter>, <Outline.Parameter><span className="name">na\_value</span><span>=</span><span>'?'</span></Outline.Parameter>, <Outline.Parameter><span className="name">repeat\_count</span><span>=</span><span>1</span></Outline.Parameter>, <Outline.Parameter><span className="name">sample\_length</span><span>=</span><span>0</span></Outline.Parameter>, <Outline.Parameter><span className="name">buffer\_size</span><span>=</span><span>None</span></Outline.Parameter>, <Outline.Parameter><span className="name">ignore\_errors</span><span>=</span><span>True</span></Outline.Parameter>, <Outline.Parameter><span className="name">prefetch\_buffer\_size</span><span>=</span><span>None</span></Outline.Parameter>, <Outline.Parameter><span className="name">stage</span><span>=</span><span>'train'</span></Outline.Parameter>, <Outline.Parameter><span className="name">label\_decoder</span><span>=</span><span>None</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content>
        build torch.dataloader

        <FieldList>
          <dl>
            <dt className="field-name">
              参数
            </dt>

            <dd className="field-body">
              - <strong>csv\_file\_path</strong> – Dict of csv file path
              - <strong>label</strong> – label column name
              - <strong>sampling\_rate</strong> – Sampling rate of a batch
              - <strong>shuffle</strong> – A bool that indicates whether the input should be shuffled
              - <strong>random\_seed</strong> – Randomization seed to use for shuffling.
              - <strong>na\_value</strong> – Additional string to recognize as NA/NaN.
              - <strong>repeat\_count</strong> – num of repeats
              - <strong>sample\_length</strong> – num of sample length
              - <strong>buffer\_size</strong> – shuffle size
              - <strong>ignore\_errors</strong> – if <cite>True</cite>, ignores errors with CSV file parsing,
              - <strong>prefetch\_buffer\_size</strong> – An int specifying the number of feature batches to prefetch for performance improvement.
              - <strong>stage</strong> – the stage of the datset
              - <strong>label\_decoder</strong> – callable function for label preprocess
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.build_dataset"} module={"secretflow.ml.nn.fl.backend.torch.fl_base"} fullname={"BaseTorchModel.build_dataset"} parameters={["x", "y", "s_w", "sampling_rate", "buffer_size", "shuffle", "random_seed", "repeat_count", "sampler_method", "stage"]} description={"build torch.dataloader"}>
      <Outline.Signature fullname="BaseTorchModel.build_dataset" id="secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.build_dataset">
        <Outline.Name>build\_dataset</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">x</span><span>:</span><span>{" "}</span><span className="name">[ndarray](https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray "（在 NumPy v1.25）")</span></Outline.Parameter>, <Outline.Parameter><span className="name">y</span><span>:</span><span>{" "}</span><span className="name">[ndarray](https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray "（在 NumPy v1.25）")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "（在 Python v3.11）")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter>, <Outline.Parameter><span className="name">s\_w</span><span>:</span><span>{" "}</span><span className="name">[ndarray](https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray "（在 NumPy v1.25）")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "（在 Python v3.11）")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter>, <Outline.Parameter><span className="name">sampling\_rate</span><span>=</span><span>None</span></Outline.Parameter>, <Outline.Parameter><span className="name">buffer\_size</span><span>=</span><span>None</span></Outline.Parameter>, <Outline.Parameter><span className="name">shuffle</span><span>=</span><span>False</span></Outline.Parameter>, <Outline.Parameter><span className="name">random\_seed</span><span>=</span><span>1234</span></Outline.Parameter>, <Outline.Parameter><span className="name">repeat\_count</span><span>=</span><span>1</span></Outline.Parameter>, <Outline.Parameter><span className="name">sampler\_method</span><span>=</span><span>'batch'</span></Outline.Parameter>, <Outline.Parameter><span className="name">stage</span><span>=</span><span>'train'</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content>
        build torch.dataloader

        <FieldList>
          <dl>
            <dt className="field-name">
              参数
            </dt>

            <dd className="field-body">
              - <strong>x</strong> – feature, FedNdArray or HDataFrame
              - <strong>y</strong> – label, FedNdArray or HDataFrame
              - <strong>s\_w</strong> – sample weight of this dataset
              - <strong>sampling\_rate</strong> – Sampling rate of a batch
              - <strong>buffer\_size</strong> – shuffle size
              - <strong>shuffle</strong> – A bool that indicates whether the input should be shuffled
              - <strong>random\_seed</strong> – Prg seed for shuffling
              - <strong>repeat\_count</strong> – num of repeats
              - <strong>sampler</strong> – method of sampler
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.build_dataset_from_builder"} module={"secretflow.ml.nn.fl.backend.torch.fl_base"} fullname={"BaseTorchModel.build_dataset_from_builder"} parameters={["dataset_builder", "x", "y", "s_w", "repeat_count", "stage"]} description={"build tf.data.Dataset"}>
      <Outline.Signature fullname="BaseTorchModel.build_dataset_from_builder" id="secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.build_dataset_from_builder">
        <Outline.Name>build\_dataset\_from\_builder</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">dataset\_builder</span><span>:</span><span>{" "}</span><span className="name">[Callable](https://docs.python.org/3/library/typing.html#typing.Callable "（在 Python v3.11）")</span></Outline.Parameter>, <Outline.Parameter><span className="name">x</span><span>:</span><span>{" "}</span><span className="name">[DataFrame](https://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.html#pandas.DataFrame "（在 pandas v2.1.0rc0+34.gd8d4522319）")<span>{" "}</span><span>|</span><span>{" "}</span>[str](https://docs.python.org/3/library/stdtypes.html#str "（在 Python v3.11）")</span></Outline.Parameter>, <Outline.Parameter><span className="name">y</span><span>:</span><span>{" "}</span><span className="name">[ndarray](https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray "（在 NumPy v1.25）")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "（在 Python v3.11）")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter>, <Outline.Parameter><span className="name">s\_w</span><span>:</span><span>{" "}</span><span className="name">[ndarray](https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray "（在 NumPy v1.25）")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "（在 Python v3.11）")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter>, <Outline.Parameter><span className="name">repeat\_count</span><span>=</span><span>1</span></Outline.Parameter>, <Outline.Parameter><span className="name">stage</span><span>=</span><span>'train'</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content>
        build tf.data.Dataset

        <FieldList>
          <dl>
            <dt className="field-name">
              参数
            </dt>

            <dd className="field-body">
              - <strong>dataset\_builder</strong> – Function of how to build dataset, must return dataset and step\_per\_epoch
              - <strong>x</strong> – A pandas Dataframe or A string representing the path to a CSV file or data folder containing the input data.
              - <strong>y</strong> – label, An optional NumPy array containing the labels for the dataset. Defaults to None.
              - <strong>s\_w</strong> – An optional NumPy array containing the sample weights for the dataset. Defaults to None.
              - <strong>repeat\_count</strong> – An integer specifying the number of times to repeat the dataset. This is useful for increasing the effective size of the dataset.
              - <strong>stage</strong> – A string indicating the stage of the dataset (either “train”, “eval”). Defaults to “train”.
            </dd>

            <dt className="field-name">
              返回
            </dt>

            <dd className="field-body">
              A tensorflow dataset
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.get_rows_count"} module={"secretflow.ml.nn.fl.backend.torch.fl_base"} fullname={"BaseTorchModel.get_rows_count"} parameters={["filename"]} description={"\u57fa\u7c7b\uff1aABC"}>
      <Outline.Signature fullname="BaseTorchModel.get_rows_count" id="secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.get_rows_count">
        <Outline.Name>get\_rows\_count</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">filename</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.get_weights"} module={"secretflow.ml.nn.fl.backend.torch.fl_base"} fullname={"BaseTorchModel.get_weights"} parameters={[]} description={"\u57fa\u7c7b\uff1aABC"}>
      <Outline.Signature fullname="BaseTorchModel.get_weights" id="secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.get_weights">
        <Outline.Name>get\_weights</Outline.Name><Outline.ParameterList><span>(</span><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.set_weights"} module={"secretflow.ml.nn.fl.backend.torch.fl_base"} fullname={"BaseTorchModel.set_weights"} parameters={["weights"]} description={"set weights of client model"}>
      <Outline.Signature fullname="BaseTorchModel.set_weights" id="secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.set_weights">
        <Outline.Name>set\_weights</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">weights</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content>
        set weights of client model
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.set_validation_metrics"} module={"secretflow.ml.nn.fl.backend.torch.fl_base"} fullname={"BaseTorchModel.set_validation_metrics"} parameters={["global_metrics"]} description={"\u57fa\u7c7b\uff1aABC"}>
      <Outline.Signature fullname="BaseTorchModel.set_validation_metrics" id="secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.set_validation_metrics">
        <Outline.Name>set\_validation\_metrics</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">global\_metrics</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.wrap_local_metrics"} module={"secretflow.ml.nn.fl.backend.torch.fl_base"} fullname={"BaseTorchModel.wrap_local_metrics"} parameters={[]} description={"\u57fa\u7c7b\uff1aABC"}>
      <Outline.Signature fullname="BaseTorchModel.wrap_local_metrics" id="secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.wrap_local_metrics">
        <Outline.Name>wrap\_local\_metrics</Outline.Name><Outline.ParameterList><span>(</span><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.evaluate"} module={"secretflow.ml.nn.fl.backend.torch.fl_base"} fullname={"BaseTorchModel.evaluate"} parameters={["evaluate_steps"]} description={"\u57fa\u7c7b\uff1aABC"}>
      <Outline.Signature fullname="BaseTorchModel.evaluate" id="secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.evaluate">
        <Outline.Name>evaluate</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">evaluate\_steps</span><span>=</span><span>0</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.predict"} module={"secretflow.ml.nn.fl.backend.torch.fl_base"} fullname={"BaseTorchModel.predict"} parameters={["predict_steps"]} description={"\u57fa\u7c7b\uff1aABC"}>
      <Outline.Signature fullname="BaseTorchModel.predict" id="secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.predict">
        <Outline.Name>predict</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">predict\_steps</span><span>=</span><span>0</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.init_training"} module={"secretflow.ml.nn.fl.backend.torch.fl_base"} fullname={"BaseTorchModel.init_training"} parameters={["callbacks", "epochs", "steps", "verbose"]} description={"\u57fa\u7c7b\uff1aABC"}>
      <Outline.Signature fullname="BaseTorchModel.init_training" id="secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.init_training">
        <Outline.Name>init\_training</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">callbacks</span></Outline.Parameter>, <Outline.Parameter><span className="name">epochs</span><span>=</span><span>1</span></Outline.Parameter>, <Outline.Parameter><span className="name">steps</span><span>=</span><span>0</span></Outline.Parameter>, <Outline.Parameter><span className="name">verbose</span><span>=</span><span>0</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.on_train_begin"} module={"secretflow.ml.nn.fl.backend.torch.fl_base"} fullname={"BaseTorchModel.on_train_begin"} parameters={[]} description={"\u57fa\u7c7b\uff1aABC"}>
      <Outline.Signature fullname="BaseTorchModel.on_train_begin" id="secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.on_train_begin">
        <Outline.Name>on\_train\_begin</Outline.Name><Outline.ParameterList><span>(</span><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.on_epoch_begin"} module={"secretflow.ml.nn.fl.backend.torch.fl_base"} fullname={"BaseTorchModel.on_epoch_begin"} parameters={["epoch"]} description={"\u57fa\u7c7b\uff1aABC"}>
      <Outline.Signature fullname="BaseTorchModel.on_epoch_begin" id="secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.on_epoch_begin">
        <Outline.Name>on\_epoch\_begin</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">epoch</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.on_epoch_end"} module={"secretflow.ml.nn.fl.backend.torch.fl_base"} fullname={"BaseTorchModel.on_epoch_end"} parameters={["epoch"]} description={"\u57fa\u7c7b\uff1aABC"}>
      <Outline.Signature fullname="BaseTorchModel.on_epoch_end" id="secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.on_epoch_end">
        <Outline.Name>on\_epoch\_end</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">epoch</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.transform_metrics"} module={"secretflow.ml.nn.fl.backend.torch.fl_base"} fullname={"BaseTorchModel.transform_metrics"} parameters={["logs", "stage"]} description={"\u57fa\u7c7b\uff1aABC"}>
      <Outline.Signature fullname="BaseTorchModel.transform_metrics" id="secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.transform_metrics">
        <Outline.Name>transform\_metrics</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">logs</span></Outline.Parameter>, <Outline.Parameter><span className="name">stage</span><span>=</span><span>'train'</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.on_train_end"} module={"secretflow.ml.nn.fl.backend.torch.fl_base"} fullname={"BaseTorchModel.on_train_end"} parameters={[]} description={"\u57fa\u7c7b\uff1aABC"}>
      <Outline.Signature fullname="BaseTorchModel.on_train_end" id="secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.on_train_end">
        <Outline.Name>on\_train\_end</Outline.Name><Outline.ParameterList><span>(</span><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.get_stop_training"} module={"secretflow.ml.nn.fl.backend.torch.fl_base"} fullname={"BaseTorchModel.get_stop_training"} parameters={[]} description={"\u57fa\u7c7b\uff1aABC"}>
      <Outline.Signature fullname="BaseTorchModel.get_stop_training" id="secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.get_stop_training">
        <Outline.Name>get\_stop\_training</Outline.Name><Outline.ParameterList><span>(</span><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.train_step"} module={"secretflow.ml.nn.fl.backend.torch.fl_base"} fullname={"BaseTorchModel.train_step"} parameters={["weights", "cur_steps", "train_steps", "kwargs"]} description={"\u57fa\u7c7b\uff1aABC"}>
      <Outline.Signature fullname="BaseTorchModel.train_step" id="secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.train_step">
        <Outline.Keyword>abstract<span>{" "}</span></Outline.Keyword><Outline.Name>train\_step</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">weights</span></Outline.Parameter>, <Outline.Parameter><span className="name">cur\_steps</span></Outline.Parameter>, <Outline.Parameter><span className="name">train\_steps</span></Outline.Parameter>, <Outline.Parameter><span>\*\*</span><span className="name">kwargs</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.save_model"} module={"secretflow.ml.nn.fl.backend.torch.fl_base"} fullname={"BaseTorchModel.save_model"} parameters={["model_path"]} description={"For compatibility reasons it is recommended to instead save only its state dict Ref:https://pytorch.org/docs/master/notes/serialization.html#id5"}>
      <Outline.Signature fullname="BaseTorchModel.save_model" id="secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.save_model">
        <Outline.Name>save\_model</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">model\_path</span><span>:</span><span>{" "}</span><span className="name">[str](https://docs.python.org/3/library/stdtypes.html#str "（在 Python v3.11）")</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content>
        For compatibility reasons it is recommended to instead save only its state dict Ref\:https\://pytorch.org/docs/master/notes/serialization.html#id5
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.load_model"} module={"secretflow.ml.nn.fl.backend.torch.fl_base"} fullname={"BaseTorchModel.load_model"} parameters={["model_path"]} description={"load model from state dict, model structure must be defined before load"}>
      <Outline.Signature fullname="BaseTorchModel.load_model" id="secretflow.ml.nn.fl.backend.torch.fl_base.BaseTorchModel.load_model">
        <Outline.Name>load\_model</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">model\_path</span><span>:</span><span>{" "}</span><span className="name">[str](https://docs.python.org/3/library/stdtypes.html#str "（在 Python v3.11）")</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content>
        load model from state dict, model structure must be defined before load
      </Outline.Content>
    </Outline>
  </Outline.Content>
</Outline>

:target{id="module-secretflow.ml.nn.fl.backend.torch.sampler"}

## secretflow\.ml.nn.fl.backend.torch.sampler module

<strong>Functions:</strong>

<table>
  <tbody>
    <tr>
      <td>
        [<code>batch\_sampler</code>](#secretflow.ml.nn.fl.backend.torch.sampler.batch_sampler "secretflow.ml.nn.fl.backend.torch.sampler.batch_sampler")(x, y, s\_w, sampling\_rate, ...)
      </td>

      <td>
        implementation of batch sampler
      </td>
    </tr>

    <tr>
      <td>
        [<code>possion\_sampler</code>](#secretflow.ml.nn.fl.backend.torch.sampler.possion_sampler "secretflow.ml.nn.fl.backend.torch.sampler.possion_sampler")(x, y, s\_w, sampling\_rate, ...)
      </td>

      <td>
        implementation of possion sampler
      </td>
    </tr>

    <tr>
      <td>
        [<code>sampler\_data</code>](#secretflow.ml.nn.fl.backend.torch.sampler.sampler_data "secretflow.ml.nn.fl.backend.torch.sampler.sampler_data")(\[sampler\_method, x, y, s\_w, ...])
      </td>

      <td>
        do sample data by sampler\_method
      </td>
    </tr>
  </tbody>
</table>

<Outline domain="py" objectType="function" target={"secretflow.ml.nn.fl.backend.torch.sampler.batch_sampler"} module={"secretflow.ml.nn.fl.backend.torch.sampler"} fullname={"batch_sampler"} parameters={["x", "y", "s_w", "sampling_rate", "buffer_size", "shuffle", "repeat_count", "random_seed"]} description={"implementation of batch sampler"}>
  <Outline.Signature fullname="batch_sampler" id="secretflow.ml.nn.fl.backend.torch.sampler.batch_sampler">
    <Outline.Prefix>secretflow\.ml.nn.fl.backend.torch.sampler.</Outline.Prefix><Outline.Name>batch\_sampler</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">x</span></Outline.Parameter>, <Outline.Parameter><span className="name">y</span></Outline.Parameter>, <Outline.Parameter><span className="name">s\_w</span></Outline.Parameter>, <Outline.Parameter><span className="name">sampling\_rate</span></Outline.Parameter>, <Outline.Parameter><span className="name">buffer\_size</span></Outline.Parameter>, <Outline.Parameter><span className="name">shuffle</span></Outline.Parameter>, <Outline.Parameter><span className="name">repeat\_count</span></Outline.Parameter>, <Outline.Parameter><span className="name">random\_seed</span></Outline.Parameter><span>)</span></Outline.ParameterList>
  </Outline.Signature>

  <Outline.Content>
    implementation of batch sampler

    <FieldList>
      <dl>
        <dt className="field-name">
          参数
        </dt>

        <dd className="field-body">
          - <strong>x</strong> – feature, FedNdArray or HDataFrame
          - <strong>y</strong> – label, FedNdArray or HDataFrame
          - <strong>s\_w</strong> – sample weight of this dataset
          - <strong>sampling\_rate</strong> – Sampling rate of a batch
          - <strong>buffer\_size</strong> – shuffle size
          - <strong>shuffle</strong> – A bool that indicates whether the input should be shuffled
          - <strong>repeat\_count</strong> – num of repeats
          - <strong>random\_seed</strong> – Prg seed for shuffling
        </dd>

        <dt className="field-name">
          返回
        </dt>

        <dd className="field-body">
          tf.data.Dataset
        </dd>

        <dt className="field-name">
          返回类型
        </dt>

        <dd className="field-body">
          data\_set
        </dd>
      </dl>
    </FieldList>
  </Outline.Content>
</Outline>

<Outline domain="py" objectType="function" target={"secretflow.ml.nn.fl.backend.torch.sampler.possion_sampler"} module={"secretflow.ml.nn.fl.backend.torch.sampler"} fullname={"possion_sampler"} parameters={["x", "y", "s_w", "sampling_rate", "random_seed"]} description={"implementation of possion sampler"}>
  <Outline.Signature fullname="possion_sampler" id="secretflow.ml.nn.fl.backend.torch.sampler.possion_sampler">
    <Outline.Prefix>secretflow\.ml.nn.fl.backend.torch.sampler.</Outline.Prefix><Outline.Name>possion\_sampler</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">x</span></Outline.Parameter>, <Outline.Parameter><span className="name">y</span></Outline.Parameter>, <Outline.Parameter><span className="name">s\_w</span></Outline.Parameter>, <Outline.Parameter><span className="name">sampling\_rate</span></Outline.Parameter>, <Outline.Parameter><span className="name">random\_seed</span></Outline.Parameter><span>)</span></Outline.ParameterList>
  </Outline.Signature>

  <Outline.Content>
    implementation of possion sampler

    <FieldList>
      <dl>
        <dt className="field-name">
          参数
        </dt>

        <dd className="field-body">
          - <strong>x</strong> – feature, FedNdArray or HDataFrame
          - <strong>y</strong> – label, FedNdArray or HDataFrame
          - <strong>s\_w</strong> – sample weight of this dataset
          - <strong>sampling\_rate</strong> – Sampling rate of a batch
          - <strong>random\_seed</strong> – Prg seed for shuffling
        </dd>

        <dt className="field-name">
          返回
        </dt>

        <dd className="field-body">
          tf.data.Dataset
        </dd>

        <dt className="field-name">
          返回类型
        </dt>

        <dd className="field-body">
          dataloader
        </dd>
      </dl>
    </FieldList>
  </Outline.Content>
</Outline>

<Outline domain="py" objectType="function" target={"secretflow.ml.nn.fl.backend.torch.sampler.sampler_data"} module={"secretflow.ml.nn.fl.backend.torch.sampler"} fullname={"sampler_data"} parameters={["sampler_method", "x", "y", "s_w", "sampling_rate", "buffer_size", "shuffle", "repeat_count", "random_seed"]} description={"do sample data by sampler_method"}>
  <Outline.Signature fullname="sampler_data" id="secretflow.ml.nn.fl.backend.torch.sampler.sampler_data">
    <Outline.Prefix>secretflow\.ml.nn.fl.backend.torch.sampler.</Outline.Prefix><Outline.Name>sampler\_data</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">sampler\_method</span><span>=</span><span>'batch'</span></Outline.Parameter>, <Outline.Parameter><span className="name">x</span><span>=</span><span>None</span></Outline.Parameter>, <Outline.Parameter><span className="name">y</span><span>=</span><span>None</span></Outline.Parameter>, <Outline.Parameter><span className="name">s\_w</span><span>=</span><span>None</span></Outline.Parameter>, <Outline.Parameter><span className="name">sampling\_rate</span><span>=</span><span>None</span></Outline.Parameter>, <Outline.Parameter><span className="name">buffer\_size</span><span>=</span><span>None</span></Outline.Parameter>, <Outline.Parameter><span className="name">shuffle</span><span>=</span><span>False</span></Outline.Parameter>, <Outline.Parameter><span className="name">repeat\_count</span><span>=</span><span>1</span></Outline.Parameter>, <Outline.Parameter><span className="name">random\_seed</span><span>=</span><span>1234</span></Outline.Parameter><span>)</span></Outline.ParameterList>
  </Outline.Signature>

  <Outline.Content>
    do sample data by sampler\_method

    <FieldList>
      <dl>
        <dt className="field-name">
          参数
        </dt>

        <dd className="field-body">
          - <strong>x</strong> – feature, FedNdArray or HDataFrame
          - <strong>y</strong> – label, FedNdArray or HDataFrame
          - <strong>s\_w</strong> – sample weight of this dataset
          - <strong>sampling\_rate</strong> – Sampling rate of a batch
          - <strong>buffer\_size</strong> – shuffle size
          - <strong>shuffle</strong> – A bool that indicates whether the input should be shuffled
          - <strong>repeat\_count</strong> – num of repeats
          - <strong>random\_seed</strong> – Prg seed for shuffling
        </dd>

        <dt className="field-name">
          返回
        </dt>

        <dd className="field-body">
          tf.data.Dataset
        </dd>

        <dt className="field-name">
          返回类型
        </dt>

        <dd className="field-body">
          data\_set
        </dd>
      </dl>
    </FieldList>
  </Outline.Content>
</Outline>

:target{id="module-secretflow.ml.nn.fl.backend.torch"}

## Module contents
