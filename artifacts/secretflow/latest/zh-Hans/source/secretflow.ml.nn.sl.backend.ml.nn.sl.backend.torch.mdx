:target{#secretflow-ml-nn-sl-backend-torch-package}

# secretflow\.ml.nn.sl.backend.torch package

:target{#subpackages}

## Subpackages

<TableOfContents>


  - [secretflow.ml.nn.sl.backend.torch.strategy package](secretflow.ml.nn.sl.backend.torch.ml.nn.sl.backend.torch.strategy.mdx)
    - [Submodules](secretflow.ml.nn.sl.backend.torch.ml.nn.sl.backend.torch.strategy.mdx#submodules)
    - [secretflow.ml.nn.sl.backend.torch.strategy.split\_nn module](secretflow.ml.nn.sl.backend.torch.ml.nn.sl.backend.torch.strategy.mdx#module-secretflow.ml.nn.sl.backend.torch.strategy.split_nn)
    - [Module contents](secretflow.ml.nn.sl.backend.torch.ml.nn.sl.backend.torch.strategy.mdx#module-secretflow.ml.nn.sl.backend.torch.strategy)
</TableOfContents>

:target{#submodules}

## Submodules

:target{id="module-secretflow.ml.nn.sl.backend.torch.callback"}

## secretflow\.ml.nn.sl.backend.torch.callback module

<strong>Classes:</strong>

<table>
  <tbody>
    <tr>
      <td>
        [<code>Callback</code>](#secretflow.ml.nn.sl.backend.torch.callback.Callback "secretflow.ml.nn.sl.backend.torch.callback.Callback")()
      </td>

      <td>

      </td>
    </tr>
  </tbody>
</table>

<Outline domain="py" objectType="class" target={"secretflow.ml.nn.sl.backend.torch.callback.Callback"} module={"secretflow.ml.nn.sl.backend.torch.callback"} fullname={"Callback"} description={"\u57fa\u7c7b\uff1aobject"}>
  <Outline.Signature fullname="Callback" id="secretflow.ml.nn.sl.backend.torch.callback.Callback">
    <Outline.Keyword>class<span>{" "}</span></Outline.Keyword><Outline.Prefix>secretflow\.ml.nn.sl.backend.torch.callback.</Outline.Prefix><Outline.Name>Callback</Outline.Name>
  </Outline.Signature>

  <Outline.Content>
    基类：[<code>object</code>](https://docs.python.org/3/library/functions.html#object "（在 Python v3.11）")

    <strong>Methods:</strong>

    <table>
      <tbody>
        <tr>
          <td>
            [<code>\_\_init\_\_</code>](#secretflow.ml.nn.sl.backend.torch.callback.Callback.__init__ "secretflow.ml.nn.sl.backend.torch.callback.Callback.__init__")()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>init\_model</code>](#secretflow.ml.nn.sl.backend.torch.callback.Callback.init_model "secretflow.ml.nn.sl.backend.torch.callback.Callback.init_model")(model\_base, model\_fuse)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>on\_train\_begin</code>](#secretflow.ml.nn.sl.backend.torch.callback.Callback.on_train_begin "secretflow.ml.nn.sl.backend.torch.callback.Callback.on_train_begin")()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>on\_train\_end</code>](#secretflow.ml.nn.sl.backend.torch.callback.Callback.on_train_end "secretflow.ml.nn.sl.backend.torch.callback.Callback.on_train_end")(\[logs])
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>on\_epoch\_begin</code>](#secretflow.ml.nn.sl.backend.torch.callback.Callback.on_epoch_begin "secretflow.ml.nn.sl.backend.torch.callback.Callback.on_epoch_begin")(epoch)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>on\_epoch\_end</code>](#secretflow.ml.nn.sl.backend.torch.callback.Callback.on_epoch_end "secretflow.ml.nn.sl.backend.torch.callback.Callback.on_epoch_end")(epoch\[, logs])
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>on\_batch\_begin</code>](#secretflow.ml.nn.sl.backend.torch.callback.Callback.on_batch_begin "secretflow.ml.nn.sl.backend.torch.callback.Callback.on_batch_begin")(step)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>on\_batch\_end</code>](#secretflow.ml.nn.sl.backend.torch.callback.Callback.on_batch_end "secretflow.ml.nn.sl.backend.torch.callback.Callback.on_batch_end")(step\[, logs])
          </td>

          <td>

          </td>
        </tr>
      </tbody>
    </table>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.callback.Callback.__init__"} module={"secretflow.ml.nn.sl.backend.torch.callback"} fullname={"Callback.__init__"} description={"\u57fa\u7c7b\uff1aobject"} parameters={[]}>
      <Outline.Signature fullname="Callback.__init__" id="secretflow.ml.nn.sl.backend.torch.callback.Callback.__init__">
        <Outline.Name>\_\_init\_\_</Outline.Name><Outline.ParameterList><span>(</span><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.callback.Callback.init_model"} module={"secretflow.ml.nn.sl.backend.torch.callback"} fullname={"Callback.init_model"} description={"\u57fa\u7c7b\uff1aobject"} parameters={["model_base", "model_fuse"]}>
      <Outline.Signature fullname="Callback.init_model" id="secretflow.ml.nn.sl.backend.torch.callback.Callback.init_model">
        <Outline.Name>init\_model</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">model\_base</span></Outline.Parameter>, <Outline.Parameter><span className="name">model\_fuse</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.callback.Callback.on_train_begin"} module={"secretflow.ml.nn.sl.backend.torch.callback"} fullname={"Callback.on_train_begin"} description={"\u57fa\u7c7b\uff1aobject"} parameters={[]}>
      <Outline.Signature fullname="Callback.on_train_begin" id="secretflow.ml.nn.sl.backend.torch.callback.Callback.on_train_begin">
        <Outline.Name>on\_train\_begin</Outline.Name><Outline.ParameterList><span>(</span><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.callback.Callback.on_train_end"} module={"secretflow.ml.nn.sl.backend.torch.callback"} fullname={"Callback.on_train_end"} description={"\u57fa\u7c7b\uff1aobject"} parameters={["logs"]}>
      <Outline.Signature fullname="Callback.on_train_end" id="secretflow.ml.nn.sl.backend.torch.callback.Callback.on_train_end">
        <Outline.Name>on\_train\_end</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">logs</span><span>=</span><span>None</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.callback.Callback.on_epoch_begin"} module={"secretflow.ml.nn.sl.backend.torch.callback"} fullname={"Callback.on_epoch_begin"} description={"\u57fa\u7c7b\uff1aobject"} parameters={["epoch"]}>
      <Outline.Signature fullname="Callback.on_epoch_begin" id="secretflow.ml.nn.sl.backend.torch.callback.Callback.on_epoch_begin">
        <Outline.Name>on\_epoch\_begin</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">epoch</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.callback.Callback.on_epoch_end"} module={"secretflow.ml.nn.sl.backend.torch.callback"} fullname={"Callback.on_epoch_end"} description={"\u57fa\u7c7b\uff1aobject"} parameters={["epoch", "logs"]}>
      <Outline.Signature fullname="Callback.on_epoch_end" id="secretflow.ml.nn.sl.backend.torch.callback.Callback.on_epoch_end">
        <Outline.Name>on\_epoch\_end</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">epoch</span></Outline.Parameter>, <Outline.Parameter><span className="name">logs</span><span>=</span><span>None</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.callback.Callback.on_batch_begin"} module={"secretflow.ml.nn.sl.backend.torch.callback"} fullname={"Callback.on_batch_begin"} description={"\u57fa\u7c7b\uff1aobject"} parameters={["step"]}>
      <Outline.Signature fullname="Callback.on_batch_begin" id="secretflow.ml.nn.sl.backend.torch.callback.Callback.on_batch_begin">
        <Outline.Name>on\_batch\_begin</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">step</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.callback.Callback.on_batch_end"} module={"secretflow.ml.nn.sl.backend.torch.callback"} fullname={"Callback.on_batch_end"} description={"\u57fa\u7c7b\uff1aobject"} parameters={["step", "logs"]}>
      <Outline.Signature fullname="Callback.on_batch_end" id="secretflow.ml.nn.sl.backend.torch.callback.Callback.on_batch_end">
        <Outline.Name>on\_batch\_end</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">step</span></Outline.Parameter>, <Outline.Parameter><span className="name">logs</span><span>=</span><span>None</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>
  </Outline.Content>
</Outline>

:target{id="module-secretflow.ml.nn.sl.backend.torch.sl_base"}

## secretflow\.ml.nn.sl.backend.torch.sl\_base module

<strong>Classes:</strong>

<table>
  <tbody>
    <tr>
      <td>
        [<code>SLBaseModel</code>](#secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseModel "secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseModel")(builder\_base, builder\_fuse)
      </td>

      <td>

      </td>
    </tr>

    <tr>
      <td>
        [<code>FuseOp</code>](#secretflow.ml.nn.sl.backend.torch.sl_base.FuseOp "secretflow.ml.nn.sl.backend.torch.sl_base.FuseOp")(\*args, \*\*kwargs)
      </td>

      <td>

      </td>
    </tr>

    <tr>
      <td>
        [<code>SLBaseTorchModel</code>](#secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel "secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel")(builder\_base, builder\_fuse, ...)
      </td>

      <td>

      </td>
    </tr>
  </tbody>
</table>

<Outline domain="py" objectType="class" target={"secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseModel"} module={"secretflow.ml.nn.sl.backend.torch.sl_base"} fullname={"SLBaseModel"} parameters={["builder_base", "builder_fuse"]} description={"\u57fa\u7c7b\uff1aABC"}>
  <Outline.Signature fullname="SLBaseModel" id="secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseModel">
    <Outline.Keyword>class<span>{" "}</span></Outline.Keyword><Outline.Prefix>secretflow\.ml.nn.sl.backend.torch.sl\_base.</Outline.Prefix><Outline.Name>SLBaseModel</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">builder\_base</span><span>:</span><span>{" "}</span><span className="name">[Callable](https://docs.python.org/3/library/typing.html#typing.Callable "（在 Python v3.11）")<span>\[</span><span>\[</span><span>]</span><span>,</span><span>{" "}</span>[TorchModel](secretflow.ml.ml.nn.mdx#secretflow.ml.nn.utils.TorchModel "secretflow.ml.nn.utils.TorchModel")<span>]</span></span></Outline.Parameter>, <Outline.Parameter><span className="name">builder\_fuse</span><span>:</span><span>{" "}</span><span className="name">[Callable](https://docs.python.org/3/library/typing.html#typing.Callable "（在 Python v3.11）")<span>\[</span><span>\[</span><span>]</span><span>,</span><span>{" "}</span>[TorchModel](secretflow.ml.ml.nn.mdx#secretflow.ml.nn.utils.TorchModel "secretflow.ml.nn.utils.TorchModel")<span>]</span></span></Outline.Parameter><span>)</span></Outline.ParameterList>
  </Outline.Signature>

  <Outline.Content>
    基类：[<code>ABC</code>](https://docs.python.org/3/library/abc.html#abc.ABC "（在 Python v3.11）")

    <strong>Methods:</strong>

    <table>
      <tbody>
        <tr>
          <td>
            [<code>\_\_init\_\_</code>](#secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseModel.__init__ "secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseModel.__init__")(builder\_base, builder\_fuse)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>base\_forward</code>](#secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseModel.base_forward "secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseModel.base_forward")()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>base\_backward</code>](#secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseModel.base_backward "secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseModel.base_backward")()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>fuse\_net</code>](#secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseModel.fuse_net "secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseModel.fuse_net")(hiddens)
          </td>

          <td>

          </td>
        </tr>
      </tbody>
    </table>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseModel.__init__"} module={"secretflow.ml.nn.sl.backend.torch.sl_base"} fullname={"SLBaseModel.__init__"} parameters={["builder_base", "builder_fuse"]} description={"\u57fa\u7c7b\uff1aABC"}>
      <Outline.Signature fullname="SLBaseModel.__init__" id="secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseModel.__init__">
        <Outline.Name>\_\_init\_\_</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">builder\_base</span><span>:</span><span>{" "}</span><span className="name">[Callable](https://docs.python.org/3/library/typing.html#typing.Callable "（在 Python v3.11）")<span>\[</span><span>\[</span><span>]</span><span>,</span><span>{" "}</span>[TorchModel](secretflow.ml.ml.nn.mdx#secretflow.ml.nn.utils.TorchModel "secretflow.ml.nn.utils.TorchModel")<span>]</span></span></Outline.Parameter>, <Outline.Parameter><span className="name">builder\_fuse</span><span>:</span><span>{" "}</span><span className="name">[Callable](https://docs.python.org/3/library/typing.html#typing.Callable "（在 Python v3.11）")<span>\[</span><span>\[</span><span>]</span><span>,</span><span>{" "}</span>[TorchModel](secretflow.ml.ml.nn.mdx#secretflow.ml.nn.utils.TorchModel "secretflow.ml.nn.utils.TorchModel")<span>]</span></span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseModel.base_forward"} module={"secretflow.ml.nn.sl.backend.torch.sl_base"} fullname={"SLBaseModel.base_forward"} parameters={[]} description={"\u57fa\u7c7b\uff1aABC"}>
      <Outline.Signature fullname="SLBaseModel.base_forward" id="secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseModel.base_forward">
        <Outline.Keyword>abstract<span>{" "}</span></Outline.Keyword><Outline.Name>base\_forward</Outline.Name><Outline.ParameterList><span>(</span><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseModel.base_backward"} module={"secretflow.ml.nn.sl.backend.torch.sl_base"} fullname={"SLBaseModel.base_backward"} parameters={[]} description={"\u57fa\u7c7b\uff1aABC"}>
      <Outline.Signature fullname="SLBaseModel.base_backward" id="secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseModel.base_backward">
        <Outline.Keyword>abstract<span>{" "}</span></Outline.Keyword><Outline.Name>base\_backward</Outline.Name><Outline.ParameterList><span>(</span><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseModel.fuse_net"} module={"secretflow.ml.nn.sl.backend.torch.sl_base"} fullname={"SLBaseModel.fuse_net"} parameters={["hiddens"]} description={"\u57fa\u7c7b\uff1aABC"}>
      <Outline.Signature fullname="SLBaseModel.fuse_net" id="secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseModel.fuse_net">
        <Outline.Keyword>abstract<span>{" "}</span></Outline.Keyword><Outline.Name>fuse\_net</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">hiddens</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>
  </Outline.Content>
</Outline>

<Outline domain="py" objectType="class" target={"secretflow.ml.nn.sl.backend.torch.sl_base.FuseOp"} module={"secretflow.ml.nn.sl.backend.torch.sl_base"} fullname={"FuseOp"} parameters={["args", "kwargs"]} description={"\u57fa\u7c7b\uff1aFunction"}>
  <Outline.Signature fullname="FuseOp" id="secretflow.ml.nn.sl.backend.torch.sl_base.FuseOp">
    <Outline.Keyword>class<span>{" "}</span></Outline.Keyword><Outline.Prefix>secretflow\.ml.nn.sl.backend.torch.sl\_base.</Outline.Prefix><Outline.Name>FuseOp</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span>\*</span><span className="name">args</span></Outline.Parameter>, <Outline.Parameter><span>\*\*</span><span className="name">kwargs</span></Outline.Parameter><span>)</span></Outline.ParameterList>
  </Outline.Signature>

  <Outline.Content>
    基类：<code>Function</code>

    <strong>Methods:</strong>

    <table>
      <tbody>
        <tr>
          <td>
            [<code>forward</code>](#secretflow.ml.nn.sl.backend.torch.sl_base.FuseOp.forward "secretflow.ml.nn.sl.backend.torch.sl_base.FuseOp.forward")(ctx, x, y)
          </td>

          <td>
            This function is to be overridden by all subclasses.
          </td>
        </tr>

        <tr>
          <td>
            [<code>backward</code>](#secretflow.ml.nn.sl.backend.torch.sl_base.FuseOp.backward "secretflow.ml.nn.sl.backend.torch.sl_base.FuseOp.backward")(ctx, grad\_output)
          </td>

          <td>
            Defines a formula for differentiating the operation with backward mode automatic differentiation (alias to the vjp function).
          </td>
        </tr>
      </tbody>
    </table>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.sl_base.FuseOp.forward"} module={"secretflow.ml.nn.sl.backend.torch.sl_base"} fullname={"FuseOp.forward"} parameters={["ctx", "x", "y"]} description={"This function is to be overridden by all subclasses. There are two ways\nto define forward:"}>
      <Outline.Signature fullname="FuseOp.forward" id="secretflow.ml.nn.sl.backend.torch.sl_base.FuseOp.forward">
        <Outline.Keyword>static<span>{" "}</span></Outline.Keyword><Outline.Name>forward</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">ctx</span></Outline.Parameter>, <Outline.Parameter><span className="name">x</span></Outline.Parameter>, <Outline.Parameter><span className="name">y</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content>
        This function is to be overridden by all subclasses. There are two ways
        to define forward:

        Usage 1 (Combined forward and ctx):

        ```default
        @staticmethod
        def forward(ctx: Any, *args: Any, **kwargs: Any) -> Any:
            pass
        ```

        - It must accept a context ctx as the first argument, followed by any
          number of arguments (tensors or other types).
        - See <span>combining-forward-context</span> for more details

        Usage 2 (Separate forward and ctx):

        ```default
        @staticmethod
        def forward(*args: Any, **kwargs: Any) -> Any:
            pass

        @staticmethod
        def setup_context(ctx: Any, inputs: Tuple[Any, ...], output: Any) -> None:
            pass
        ```

        - The forward no longer accepts a ctx argument.
        - Instead, you must also override the <code>torch.autograd.Function.setup\_context()</code>
          staticmethod to handle setting up the <code>ctx</code> object.
          <code>output</code> is the output of the forward, <code>inputs</code> are a Tuple of inputs
          to the forward.
        - See <span>extending-autograd</span> for more details

        The context can be used to store arbitrary data that can be then
        retrieved during the backward pass. Tensors should not be stored
        directly on <cite>ctx</cite> (though this is not currently enforced for
        backward compatibility). Instead, tensors should be saved either with
        <code>ctx.save\_for\_backward()</code> if they are intended to be used in
        <code>backward</code> (equivalently, <code>vjp</code>) or <code>ctx.save\_for\_forward()</code>
        if they are intended to be used for in <code>jvp</code>.
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.sl_base.FuseOp.backward"} module={"secretflow.ml.nn.sl.backend.torch.sl_base"} fullname={"FuseOp.backward"} parameters={["ctx", "grad_output"]} description={"Defines a formula for differentiating the operation with backward mode\nautomatic differentiation (alias to the vjp function)."}>
      <Outline.Signature fullname="FuseOp.backward" id="secretflow.ml.nn.sl.backend.torch.sl_base.FuseOp.backward">
        <Outline.Keyword>static<span>{" "}</span></Outline.Keyword><Outline.Name>backward</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">ctx</span></Outline.Parameter>, <Outline.Parameter><span className="name">grad\_output</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content>
        Defines a formula for differentiating the operation with backward mode
        automatic differentiation (alias to the vjp function).

        This function is to be overridden by all subclasses.

        It must accept a context <code>ctx</code> as the first argument, followed by
        as many outputs as the [<code>forward()</code>](#secretflow.ml.nn.sl.backend.torch.sl_base.FuseOp.forward "secretflow.ml.nn.sl.backend.torch.sl_base.FuseOp.forward") returned (None will be passed in
        for non tensor outputs of the forward function),
        and it should return as many tensors, as there were inputs to
        [<code>forward()</code>](#secretflow.ml.nn.sl.backend.torch.sl_base.FuseOp.forward "secretflow.ml.nn.sl.backend.torch.sl_base.FuseOp.forward"). Each argument is the gradient w\.r.t the given output,
        and each returned value should be the gradient w\.r.t. the
        corresponding input. If an input is not a Tensor or is a Tensor not
        requiring grads, you can just pass None as a gradient for that input.

        The context can be used to retrieve tensors saved during the forward
        pass. It also has an attribute <code>ctx.needs\_input\_grad</code> as a tuple
        of booleans representing whether each input needs gradient. E.g.,
        [<code>backward()</code>](#secretflow.ml.nn.sl.backend.torch.sl_base.FuseOp.backward "secretflow.ml.nn.sl.backend.torch.sl_base.FuseOp.backward") will have <code>ctx.needs\_input\_grad\[0] = True</code> if the
        first input to [<code>forward()</code>](#secretflow.ml.nn.sl.backend.torch.sl_base.FuseOp.forward "secretflow.ml.nn.sl.backend.torch.sl_base.FuseOp.forward") needs gradient computated w\.r.t. the
        output.
      </Outline.Content>
    </Outline>
  </Outline.Content>
</Outline>

<Outline domain="py" objectType="class" target={"secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel"} module={"secretflow.ml.nn.sl.backend.torch.sl_base"} fullname={"SLBaseTorchModel"} parameters={["builder_base", "builder_fuse", "dp_strategy", "random_seed", "args", "kwargs"]} description={"\u57fa\u7c7b\uff1aSLBaseModel"}>
  <Outline.Signature fullname="SLBaseTorchModel" id="secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel">
    <Outline.Keyword>class<span>{" "}</span></Outline.Keyword><Outline.Prefix>secretflow\.ml.nn.sl.backend.torch.sl\_base.</Outline.Prefix><Outline.Name>SLBaseTorchModel</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">builder\_base</span><span>:</span><span>{" "}</span><span className="name">[Callable](https://docs.python.org/3/library/typing.html#typing.Callable "（在 Python v3.11）")<span>\[</span><span>\[</span><span>]</span><span>,</span><span>{" "}</span>[TorchModel](secretflow.ml.ml.nn.mdx#secretflow.ml.nn.utils.TorchModel "secretflow.ml.nn.utils.TorchModel")<span>]</span></span></Outline.Parameter>, <Outline.Parameter><span className="name">builder\_fuse</span><span>:</span><span>{" "}</span><span className="name">[Callable](https://docs.python.org/3/library/typing.html#typing.Callable "（在 Python v3.11）")<span>\[</span><span>\[</span><span>]</span><span>,</span><span>{" "}</span>[TorchModel](secretflow.ml.ml.nn.mdx#secretflow.ml.nn.utils.TorchModel "secretflow.ml.nn.utils.TorchModel")<span>]</span></span></Outline.Parameter>, <Outline.Parameter><span className="name">dp\_strategy</span><span>:</span><span>{" "}</span><span className="name">[DPStrategy](secretflow.security.security.privacy.mdx#secretflow.security.privacy.strategy.DPStrategy "secretflow.security.privacy.strategy.DPStrategy")</span></Outline.Parameter>, <Outline.Parameter><span className="name">random\_seed</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "（在 Python v3.11）")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "（在 Python v3.11）")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter>, <Outline.Parameter><span>\*</span><span className="name">args</span></Outline.Parameter>, <Outline.Parameter><span>\*\*</span><span className="name">kwargs</span></Outline.Parameter><span>)</span></Outline.ParameterList>
  </Outline.Signature>

  <Outline.Content>
    基类：[<code>SLBaseModel</code>](#secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseModel "secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseModel")

    <strong>Methods:</strong>

    <table>
      <tbody>
        <tr>
          <td>
            [<code>\_\_init\_\_</code>](#secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.__init__ "secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.__init__")(builder\_base, builder\_fuse, dp\_strategy)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>init\_data</code>](#secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.init_data "secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.init_data")()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>set\_steps\_per\_epoch</code>](#secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.set_steps_per_epoch "secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.set_steps_per_epoch")(steps\_per\_epoch)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>get\_basenet\_output\_num</code>](#secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.get_basenet_output_num "secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.get_basenet_output_num")()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>get\_batch\_data</code>](#secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.get_batch_data "secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.get_batch_data")(\[stage])
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>build\_dataset\_from\_numeric</code>](#secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.build_dataset_from_numeric "secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.build_dataset_from_numeric")(\*x\[, y, s\_w, ...])
          </td>

          <td>
            build torch.data.Dataset
          </td>
        </tr>

        <tr>
          <td>
            [<code>init\_training</code>](#secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.init_training "secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.init_training")(callbacks\[, epochs, steps, ...])
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>init\_predict</code>](#secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.init_predict "secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.init_predict")(callbacks\[, steps, verbose])
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>build\_dataset\_from\_builder</code>](#secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.build_dataset_from_builder "secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.build_dataset_from_builder")(\*x\[, y, s\_w, ...])
          </td>

          <td>
            build torch.data.Dataset
          </td>
        </tr>

        <tr>
          <td>
            [<code>set\_dataset\_stage</code>](#secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.set_dataset_stage "secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.set_dataset_stage")(data\_set\[, stage, has\_y, ...])
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>base\_forward\_internal</code>](#secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.base_forward_internal "secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.base_forward_internal")(data\_x)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>fuse\_net\_internal</code>](#secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.fuse_net_internal "secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.fuse_net_internal")(hiddens, train\_y, ...)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>get\_base\_weights</code>](#secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.get_base_weights "secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.get_base_weights")()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>get\_fuse\_weights</code>](#secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.get_fuse_weights "secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.get_fuse_weights")()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>get\_stop\_training</code>](#secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.get_stop_training "secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.get_stop_training")()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>on\_train\_begin</code>](#secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.on_train_begin "secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.on_train_begin")()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>on\_train\_end</code>](#secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.on_train_end "secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.on_train_end")()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>on\_epoch\_begin</code>](#secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.on_epoch_begin "secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.on_epoch_begin")(epoch)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>on\_epoch\_end</code>](#secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.on_epoch_end "secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.on_epoch_end")(epoch)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>on\_train\_batch\_begin</code>](#secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.on_train_batch_begin "secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.on_train_batch_begin")(\[step])
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>on\_train\_batch\_end</code>](#secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.on_train_batch_end "secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.on_train_batch_end")(\[step])
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>on\_validation</code>](#secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.on_validation "secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.on_validation")(val\_logs)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>on\_predict\_batch\_begin</code>](#secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.on_predict_batch_begin "secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.on_predict_batch_begin")(batch)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>on\_predict\_batch\_end</code>](#secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.on_predict_batch_end "secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.on_predict_batch_end")(batch)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>on\_predict\_begin</code>](#secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.on_predict_begin "secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.on_predict_begin")()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>on\_predict\_end</code>](#secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.on_predict_end "secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.on_predict_end")()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>set\_sample\_weight</code>](#secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.set_sample_weight "secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.set_sample_weight")(sample\_weight\[, stage])
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>reset\_metrics</code>](#secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.reset_metrics "secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.reset_metrics")()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>evaluate</code>](#secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.evaluate "secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.evaluate")(\*hidden\_features)
          </td>

          <td>
            Returns the loss value & metrics values for the model in test mode.
          </td>
        </tr>

        <tr>
          <td>
            [<code>wrap\_local\_metrics</code>](#secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.wrap_local_metrics "secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.wrap_local_metrics")()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>metrics</code>](#secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.metrics "secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.metrics")()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>predict</code>](#secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.predict "secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.predict")(\*hidden\_features)
          </td>

          <td>
            Generates output predictions for the input hidden layer features.
          </td>
        </tr>

        <tr>
          <td>
            [<code>save\_base\_model</code>](#secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.save_base_model "secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.save_base_model")(base\_model\_path, \*\*kwargs)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>save\_fuse\_model</code>](#secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.save_fuse_model "secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.save_fuse_model")(fuse\_model\_path, \*\*kwargs)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>load\_base\_model</code>](#secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.load_base_model "secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.load_base_model")(base\_model\_path, \*\*kwargs)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>load\_fuse\_model</code>](#secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.load_fuse_model "secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.load_fuse_model")(fuse\_model\_path, \*\*kwargs)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>export\_base\_model</code>](#secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.export_base_model "secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.export_base_model")(model\_path\[, save\_format])
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>export\_fuse\_model</code>](#secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.export_fuse_model "secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.export_fuse_model")(model\_path\[, save\_format])
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [<code>get\_privacy\_spent</code>](#secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.get_privacy_spent "secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.get_privacy_spent")(step\[, orders])
          </td>

          <td>
            Get accountant of dp mechanism.
          </td>
        </tr>
      </tbody>
    </table>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.__init__"} module={"secretflow.ml.nn.sl.backend.torch.sl_base"} fullname={"SLBaseTorchModel.__init__"} parameters={["builder_base", "builder_fuse", "dp_strategy", "random_seed", "args", "kwargs"]} description={"\u57fa\u7c7b\uff1aSLBaseModel"}>
      <Outline.Signature fullname="SLBaseTorchModel.__init__" id="secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.__init__">
        <Outline.Name>\_\_init\_\_</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">builder\_base</span><span>:</span><span>{" "}</span><span className="name">[Callable](https://docs.python.org/3/library/typing.html#typing.Callable "（在 Python v3.11）")<span>\[</span><span>\[</span><span>]</span><span>,</span><span>{" "}</span>[TorchModel](secretflow.ml.ml.nn.mdx#secretflow.ml.nn.utils.TorchModel "secretflow.ml.nn.utils.TorchModel")<span>]</span></span></Outline.Parameter>, <Outline.Parameter><span className="name">builder\_fuse</span><span>:</span><span>{" "}</span><span className="name">[Callable](https://docs.python.org/3/library/typing.html#typing.Callable "（在 Python v3.11）")<span>\[</span><span>\[</span><span>]</span><span>,</span><span>{" "}</span>[TorchModel](secretflow.ml.ml.nn.mdx#secretflow.ml.nn.utils.TorchModel "secretflow.ml.nn.utils.TorchModel")<span>]</span></span></Outline.Parameter>, <Outline.Parameter><span className="name">dp\_strategy</span><span>:</span><span>{" "}</span><span className="name">[DPStrategy](secretflow.security.security.privacy.mdx#secretflow.security.privacy.strategy.DPStrategy "secretflow.security.privacy.strategy.DPStrategy")</span></Outline.Parameter>, <Outline.Parameter><span className="name">random\_seed</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "（在 Python v3.11）")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "（在 Python v3.11）")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter>, <Outline.Parameter><span>\*</span><span className="name">args</span></Outline.Parameter>, <Outline.Parameter><span>\*\*</span><span className="name">kwargs</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.init_data"} module={"secretflow.ml.nn.sl.backend.torch.sl_base"} fullname={"SLBaseTorchModel.init_data"} parameters={[]} description={"\u57fa\u7c7b\uff1aSLBaseModel"}>
      <Outline.Signature fullname="SLBaseTorchModel.init_data" id="secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.init_data">
        <Outline.Name>init\_data</Outline.Name><Outline.ParameterList><span>(</span><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.set_steps_per_epoch"} module={"secretflow.ml.nn.sl.backend.torch.sl_base"} fullname={"SLBaseTorchModel.set_steps_per_epoch"} parameters={["steps_per_epoch"]} description={"\u57fa\u7c7b\uff1aSLBaseModel"}>
      <Outline.Signature fullname="SLBaseTorchModel.set_steps_per_epoch" id="secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.set_steps_per_epoch">
        <Outline.Name>set\_steps\_per\_epoch</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">steps\_per\_epoch</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.get_basenet_output_num"} module={"secretflow.ml.nn.sl.backend.torch.sl_base"} fullname={"SLBaseTorchModel.get_basenet_output_num"} parameters={[]} description={"\u57fa\u7c7b\uff1aSLBaseModel"}>
      <Outline.Signature fullname="SLBaseTorchModel.get_basenet_output_num" id="secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.get_basenet_output_num">
        <Outline.Name>get\_basenet\_output\_num</Outline.Name><Outline.ParameterList><span>(</span><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.get_batch_data"} module={"secretflow.ml.nn.sl.backend.torch.sl_base"} fullname={"SLBaseTorchModel.get_batch_data"} parameters={["stage"]} description={"\u57fa\u7c7b\uff1aSLBaseModel"}>
      <Outline.Signature fullname="SLBaseTorchModel.get_batch_data" id="secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.get_batch_data">
        <Outline.Name>get\_batch\_data</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">stage</span><span>=</span><span>'train'</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.build_dataset_from_numeric"} module={"secretflow.ml.nn.sl.backend.torch.sl_base"} fullname={"SLBaseTorchModel.build_dataset_from_numeric"} parameters={["x", "y", "s_w", "batch_size", "buffer_size", "shuffle", "repeat_count", "stage", "random_seed"]} description={"build torch.data.Dataset"}>
      <Outline.Signature fullname="SLBaseTorchModel.build_dataset_from_numeric" id="secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.build_dataset_from_numeric">
        <Outline.Name>build\_dataset\_from\_numeric</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span>\*</span><span className="name">x</span><span>:</span><span>{" "}</span><span className="name">[List](https://docs.python.org/3/library/typing.html#typing.List "（在 Python v3.11）")<span>\[</span>[ndarray](https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray "（在 NumPy v1.25）")<span>]</span></span></Outline.Parameter>, <Outline.Parameter><span className="name">y</span><span>:</span><span>{" "}</span><span className="name">[ndarray](https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray "（在 NumPy v1.25）")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "（在 Python v3.11）")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter>, <Outline.Parameter><span className="name">s\_w</span><span>:</span><span>{" "}</span><span className="name">[ndarray](https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray "（在 NumPy v1.25）")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "（在 Python v3.11）")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter>, <Outline.Parameter><span className="name">batch\_size</span><span>=</span><span>32</span></Outline.Parameter>, <Outline.Parameter><span className="name">buffer\_size</span><span>=</span><span>128</span></Outline.Parameter>, <Outline.Parameter><span className="name">shuffle</span><span>=</span><span>False</span></Outline.Parameter>, <Outline.Parameter><span className="name">repeat\_count</span><span>=</span><span>1</span></Outline.Parameter>, <Outline.Parameter><span className="name">stage</span><span>=</span><span>'train'</span></Outline.Parameter>, <Outline.Parameter><span className="name">random\_seed</span><span>=</span><span>1234</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content>
        build torch.data.Dataset

        <FieldList>
          <dl>
            <dt className="field-name">
              参数
            </dt>

            <dd className="field-body">
              - <strong>x</strong> – feature, FedNdArray or HDataFrame
              - <strong>y</strong> – label, FedNdArray or HDataFrame
              - <strong>s\_w</strong> – sample weight, FedNdArray or HDataFrame
              - <strong>batch\_size</strong> – Number of samples per gradient update
              - <strong>buffer\_size</strong> – buffer size for shuffling
              - <strong>shuffle</strong> – whether shuffle the dataset or not
              - <strong>repeat\_count</strong> – num of repeats
              - <strong>stage</strong> – stage of this datset
              - <strong>random\_seed</strong> – Prg seed for shuffling
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.init_training"} module={"secretflow.ml.nn.sl.backend.torch.sl_base"} fullname={"SLBaseTorchModel.init_training"} parameters={["callbacks", "epochs", "steps", "verbose"]} description={"\u57fa\u7c7b\uff1aSLBaseModel"}>
      <Outline.Signature fullname="SLBaseTorchModel.init_training" id="secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.init_training">
        <Outline.Name>init\_training</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">callbacks</span></Outline.Parameter>, <Outline.Parameter><span className="name">epochs</span><span>=</span><span>1</span></Outline.Parameter>, <Outline.Parameter><span className="name">steps</span><span>=</span><span>0</span></Outline.Parameter>, <Outline.Parameter><span className="name">verbose</span><span>=</span><span>0</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.init_predict"} module={"secretflow.ml.nn.sl.backend.torch.sl_base"} fullname={"SLBaseTorchModel.init_predict"} parameters={["callbacks", "steps", "verbose"]} description={"\u57fa\u7c7b\uff1aSLBaseModel"}>
      <Outline.Signature fullname="SLBaseTorchModel.init_predict" id="secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.init_predict">
        <Outline.Name>init\_predict</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">callbacks</span></Outline.Parameter>, <Outline.Parameter><span className="name">steps</span><span>=</span><span>1</span></Outline.Parameter>, <Outline.Parameter><span className="name">verbose</span><span>=</span><span>0</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.build_dataset_from_builder"} module={"secretflow.ml.nn.sl.backend.torch.sl_base"} fullname={"SLBaseTorchModel.build_dataset_from_builder"} parameters={["x", "y", "s_w", "batch_size", "random_seed", "stage", "dataset_builder"]} description={"build torch.data.Dataset"}>
      <Outline.Signature fullname="SLBaseTorchModel.build_dataset_from_builder" id="secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.build_dataset_from_builder">
        <Outline.Name>build\_dataset\_from\_builder</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span>\*</span><span className="name">x</span><span>:</span><span>{" "}</span><span className="name">[List](https://docs.python.org/3/library/typing.html#typing.List "（在 Python v3.11）")<span>\[</span>[ndarray](https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray "（在 NumPy v1.25）")<span>]</span></span></Outline.Parameter>, <Outline.Parameter><span className="name">y</span><span>:</span><span>{" "}</span><span className="name">[ndarray](https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray "（在 NumPy v1.25）")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "（在 Python v3.11）")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter>, <Outline.Parameter><span className="name">s\_w</span><span>:</span><span>{" "}</span><span className="name">[ndarray](https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray "（在 NumPy v1.25）")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "（在 Python v3.11）")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter>, <Outline.Parameter><span className="name">batch\_size</span><span>=</span><span>-1</span></Outline.Parameter>, <Outline.Parameter><span className="name">random\_seed</span><span>=</span><span>1234</span></Outline.Parameter>, <Outline.Parameter><span className="name">stage</span><span>=</span><span>'train'</span></Outline.Parameter>, <Outline.Parameter><span className="name">dataset\_builder</span><span>:</span><span>{" "}</span><span className="name">[Callable](https://docs.python.org/3/library/typing.html#typing.Callable "（在 Python v3.11）")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "（在 Python v3.11）")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content>
        build torch.data.Dataset

        <FieldList>
          <dl>
            <dt className="field-name">
              参数
            </dt>

            <dd className="field-body">
              - <strong>x</strong> – feature, FedNdArray or HDataFrame
              - <strong>y</strong> – label, FedNdArray or HDataFrame
              - <strong>s\_w</strong> – sample weight, FedNdArray or HDataFrame
              - <strong>batch\_size</strong> – An integer representing the size of the batches to be used.
              - <strong>random\_seed</strong> – An integer representing the random seed used for shuffling.
              - <strong>stage</strong> – stage of this datset
              - <strong>dataset\_builder</strong> – dataset build callable function of worker
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.set_dataset_stage"} module={"secretflow.ml.nn.sl.backend.torch.sl_base"} fullname={"SLBaseTorchModel.set_dataset_stage"} parameters={["data_set", "stage", "has_y", "has_s_w"]} description={"\u57fa\u7c7b\uff1aSLBaseModel"}>
      <Outline.Signature fullname="SLBaseTorchModel.set_dataset_stage" id="secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.set_dataset_stage">
        <Outline.Name>set\_dataset\_stage</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">data\_set</span></Outline.Parameter>, <Outline.Parameter><span className="name">stage</span><span>=</span><span>'train'</span></Outline.Parameter>, <Outline.Parameter><span className="name">has\_y</span><span>=</span><span>None</span></Outline.Parameter>, <Outline.Parameter><span className="name">has\_s\_w</span><span>=</span><span>None</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.base_forward_internal"} module={"secretflow.ml.nn.sl.backend.torch.sl_base"} fullname={"SLBaseTorchModel.base_forward_internal"} parameters={["data_x"]} description={"\u57fa\u7c7b\uff1aSLBaseModel"}>
      <Outline.Signature fullname="SLBaseTorchModel.base_forward_internal" id="secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.base_forward_internal">
        <Outline.Name>base\_forward\_internal</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">data\_x</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.fuse_net_internal"} module={"secretflow.ml.nn.sl.backend.torch.sl_base"} fullname={"SLBaseTorchModel.fuse_net_internal"} parameters={["hiddens", "train_y", "train_sample_weight", "logs"]} description={"\u57fa\u7c7b\uff1aSLBaseModel"}>
      <Outline.Signature fullname="SLBaseTorchModel.fuse_net_internal" id="secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.fuse_net_internal">
        <Outline.Name>fuse\_net\_internal</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">hiddens</span></Outline.Parameter>, <Outline.Parameter><span className="name">train\_y</span></Outline.Parameter>, <Outline.Parameter><span className="name">train\_sample\_weight</span></Outline.Parameter>, <Outline.Parameter><span className="name">logs</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.get_base_weights"} module={"secretflow.ml.nn.sl.backend.torch.sl_base"} fullname={"SLBaseTorchModel.get_base_weights"} parameters={[]} description={"\u57fa\u7c7b\uff1aSLBaseModel"}>
      <Outline.Signature fullname="SLBaseTorchModel.get_base_weights" id="secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.get_base_weights">
        <Outline.Name>get\_base\_weights</Outline.Name><Outline.ParameterList><span>(</span><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.get_fuse_weights"} module={"secretflow.ml.nn.sl.backend.torch.sl_base"} fullname={"SLBaseTorchModel.get_fuse_weights"} parameters={[]} description={"\u57fa\u7c7b\uff1aSLBaseModel"}>
      <Outline.Signature fullname="SLBaseTorchModel.get_fuse_weights" id="secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.get_fuse_weights">
        <Outline.Name>get\_fuse\_weights</Outline.Name><Outline.ParameterList><span>(</span><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.get_stop_training"} module={"secretflow.ml.nn.sl.backend.torch.sl_base"} fullname={"SLBaseTorchModel.get_stop_training"} parameters={[]} description={"\u57fa\u7c7b\uff1aSLBaseModel"}>
      <Outline.Signature fullname="SLBaseTorchModel.get_stop_training" id="secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.get_stop_training">
        <Outline.Name>get\_stop\_training</Outline.Name><Outline.ParameterList><span>(</span><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.on_train_begin"} module={"secretflow.ml.nn.sl.backend.torch.sl_base"} fullname={"SLBaseTorchModel.on_train_begin"} parameters={[]} description={"\u57fa\u7c7b\uff1aSLBaseModel"}>
      <Outline.Signature fullname="SLBaseTorchModel.on_train_begin" id="secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.on_train_begin">
        <Outline.Name>on\_train\_begin</Outline.Name><Outline.ParameterList><span>(</span><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.on_train_end"} module={"secretflow.ml.nn.sl.backend.torch.sl_base"} fullname={"SLBaseTorchModel.on_train_end"} parameters={[]} description={"\u57fa\u7c7b\uff1aSLBaseModel"}>
      <Outline.Signature fullname="SLBaseTorchModel.on_train_end" id="secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.on_train_end">
        <Outline.Name>on\_train\_end</Outline.Name><Outline.ParameterList><span>(</span><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.on_epoch_begin"} module={"secretflow.ml.nn.sl.backend.torch.sl_base"} fullname={"SLBaseTorchModel.on_epoch_begin"} parameters={["epoch"]} description={"\u57fa\u7c7b\uff1aSLBaseModel"}>
      <Outline.Signature fullname="SLBaseTorchModel.on_epoch_begin" id="secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.on_epoch_begin">
        <Outline.Name>on\_epoch\_begin</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">epoch</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.on_epoch_end"} module={"secretflow.ml.nn.sl.backend.torch.sl_base"} fullname={"SLBaseTorchModel.on_epoch_end"} parameters={["epoch"]} description={"\u57fa\u7c7b\uff1aSLBaseModel"}>
      <Outline.Signature fullname="SLBaseTorchModel.on_epoch_end" id="secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.on_epoch_end">
        <Outline.Name>on\_epoch\_end</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">epoch</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.on_train_batch_begin"} module={"secretflow.ml.nn.sl.backend.torch.sl_base"} fullname={"SLBaseTorchModel.on_train_batch_begin"} parameters={["step"]} description={"\u57fa\u7c7b\uff1aSLBaseModel"}>
      <Outline.Signature fullname="SLBaseTorchModel.on_train_batch_begin" id="secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.on_train_batch_begin">
        <Outline.Name>on\_train\_batch\_begin</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">step</span><span>=</span><span>None</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.on_train_batch_end"} module={"secretflow.ml.nn.sl.backend.torch.sl_base"} fullname={"SLBaseTorchModel.on_train_batch_end"} parameters={["step"]} description={"\u57fa\u7c7b\uff1aSLBaseModel"}>
      <Outline.Signature fullname="SLBaseTorchModel.on_train_batch_end" id="secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.on_train_batch_end">
        <Outline.Name>on\_train\_batch\_end</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">step</span><span>=</span><span>None</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.on_validation"} module={"secretflow.ml.nn.sl.backend.torch.sl_base"} fullname={"SLBaseTorchModel.on_validation"} parameters={["val_logs"]} description={"\u57fa\u7c7b\uff1aSLBaseModel"}>
      <Outline.Signature fullname="SLBaseTorchModel.on_validation" id="secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.on_validation">
        <Outline.Name>on\_validation</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">val\_logs</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.on_predict_batch_begin"} module={"secretflow.ml.nn.sl.backend.torch.sl_base"} fullname={"SLBaseTorchModel.on_predict_batch_begin"} parameters={["batch"]} description={"\u57fa\u7c7b\uff1aSLBaseModel"}>
      <Outline.Signature fullname="SLBaseTorchModel.on_predict_batch_begin" id="secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.on_predict_batch_begin">
        <Outline.Name>on\_predict\_batch\_begin</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">batch</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.on_predict_batch_end"} module={"secretflow.ml.nn.sl.backend.torch.sl_base"} fullname={"SLBaseTorchModel.on_predict_batch_end"} parameters={["batch"]} description={"\u57fa\u7c7b\uff1aSLBaseModel"}>
      <Outline.Signature fullname="SLBaseTorchModel.on_predict_batch_end" id="secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.on_predict_batch_end">
        <Outline.Name>on\_predict\_batch\_end</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">batch</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.on_predict_begin"} module={"secretflow.ml.nn.sl.backend.torch.sl_base"} fullname={"SLBaseTorchModel.on_predict_begin"} parameters={[]} description={"\u57fa\u7c7b\uff1aSLBaseModel"}>
      <Outline.Signature fullname="SLBaseTorchModel.on_predict_begin" id="secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.on_predict_begin">
        <Outline.Name>on\_predict\_begin</Outline.Name><Outline.ParameterList><span>(</span><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.on_predict_end"} module={"secretflow.ml.nn.sl.backend.torch.sl_base"} fullname={"SLBaseTorchModel.on_predict_end"} parameters={[]} description={"\u57fa\u7c7b\uff1aSLBaseModel"}>
      <Outline.Signature fullname="SLBaseTorchModel.on_predict_end" id="secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.on_predict_end">
        <Outline.Name>on\_predict\_end</Outline.Name><Outline.ParameterList><span>(</span><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.set_sample_weight"} module={"secretflow.ml.nn.sl.backend.torch.sl_base"} fullname={"SLBaseTorchModel.set_sample_weight"} parameters={["sample_weight", "stage"]} description={"\u57fa\u7c7b\uff1aSLBaseModel"}>
      <Outline.Signature fullname="SLBaseTorchModel.set_sample_weight" id="secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.set_sample_weight">
        <Outline.Name>set\_sample\_weight</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">sample\_weight</span></Outline.Parameter>, <Outline.Parameter><span className="name">stage</span><span>=</span><span>'train'</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.reset_metrics"} module={"secretflow.ml.nn.sl.backend.torch.sl_base"} fullname={"SLBaseTorchModel.reset_metrics"} parameters={[]} description={"\u57fa\u7c7b\uff1aSLBaseModel"}>
      <Outline.Signature fullname="SLBaseTorchModel.reset_metrics" id="secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.reset_metrics">
        <Outline.Name>reset\_metrics</Outline.Name><Outline.ParameterList><span>(</span><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.evaluate"} module={"secretflow.ml.nn.sl.backend.torch.sl_base"} fullname={"SLBaseTorchModel.evaluate"} parameters={["hidden_features"]} description={"Returns the loss value & metrics values for the model in test mode."}>
      <Outline.Signature fullname="SLBaseTorchModel.evaluate" id="secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.evaluate">
        <Outline.Name>evaluate</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span>\*</span><span className="name">hidden\_features</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content>
        Returns the loss value & metrics values for the model in test mode.

        <FieldList>
          <dl>
            <dt className="field-name">
              参数
            </dt>

            <dd className="field-body">
              <strong>hidden\_features</strong> – A list of hidden layers for each party to compute
            </dd>

            <dt className="field-name">
              返回
            </dt>

            <dd className="field-body">
              map of model metrics.
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.wrap_local_metrics"} module={"secretflow.ml.nn.sl.backend.torch.sl_base"} fullname={"SLBaseTorchModel.wrap_local_metrics"} parameters={[]} description={"\u57fa\u7c7b\uff1aSLBaseModel"}>
      <Outline.Signature fullname="SLBaseTorchModel.wrap_local_metrics" id="secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.wrap_local_metrics">
        <Outline.Name>wrap\_local\_metrics</Outline.Name><Outline.ParameterList><span>(</span><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.metrics"} module={"secretflow.ml.nn.sl.backend.torch.sl_base"} fullname={"SLBaseTorchModel.metrics"} parameters={[]} description={"\u57fa\u7c7b\uff1aSLBaseModel"}>
      <Outline.Signature fullname="SLBaseTorchModel.metrics" id="secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.metrics">
        <Outline.Name>metrics</Outline.Name><Outline.ParameterList><span>(</span><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.predict"} module={"secretflow.ml.nn.sl.backend.torch.sl_base"} fullname={"SLBaseTorchModel.predict"} parameters={["hidden_features"]} description={"Generates output predictions for the input hidden layer features."}>
      <Outline.Signature fullname="SLBaseTorchModel.predict" id="secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.predict">
        <Outline.Name>predict</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span>\*</span><span className="name">hidden\_features</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content>
        Generates output predictions for the input hidden layer features.

        <FieldList>
          <dl>
            <dt className="field-name">
              参数
            </dt>

            <dd className="field-body">
              <strong>hidden\_features</strong> – A list of hidden layers for each party to compute
            </dd>

            <dt className="field-name">
              返回
            </dt>

            <dd className="field-body">
              Array(s) of predictions.
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.save_base_model"} module={"secretflow.ml.nn.sl.backend.torch.sl_base"} fullname={"SLBaseTorchModel.save_base_model"} parameters={["base_model_path", "kwargs"]} description={"\u57fa\u7c7b\uff1aSLBaseModel"}>
      <Outline.Signature fullname="SLBaseTorchModel.save_base_model" id="secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.save_base_model">
        <Outline.Name>save\_base\_model</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">base\_model\_path</span><span>:</span><span>{" "}</span><span className="name">[str](https://docs.python.org/3/library/stdtypes.html#str "（在 Python v3.11）")</span></Outline.Parameter>, <Outline.Parameter><span>\*\*</span><span className="name">kwargs</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.save_fuse_model"} module={"secretflow.ml.nn.sl.backend.torch.sl_base"} fullname={"SLBaseTorchModel.save_fuse_model"} parameters={["fuse_model_path", "kwargs"]} description={"\u57fa\u7c7b\uff1aSLBaseModel"}>
      <Outline.Signature fullname="SLBaseTorchModel.save_fuse_model" id="secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.save_fuse_model">
        <Outline.Name>save\_fuse\_model</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">fuse\_model\_path</span><span>:</span><span>{" "}</span><span className="name">[str](https://docs.python.org/3/library/stdtypes.html#str "（在 Python v3.11）")</span></Outline.Parameter>, <Outline.Parameter><span>\*\*</span><span className="name">kwargs</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.load_base_model"} module={"secretflow.ml.nn.sl.backend.torch.sl_base"} fullname={"SLBaseTorchModel.load_base_model"} parameters={["base_model_path", "kwargs"]} description={"\u57fa\u7c7b\uff1aSLBaseModel"}>
      <Outline.Signature fullname="SLBaseTorchModel.load_base_model" id="secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.load_base_model">
        <Outline.Name>load\_base\_model</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">base\_model\_path</span><span>:</span><span>{" "}</span><span className="name">[str](https://docs.python.org/3/library/stdtypes.html#str "（在 Python v3.11）")</span></Outline.Parameter>, <Outline.Parameter><span>\*\*</span><span className="name">kwargs</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.load_fuse_model"} module={"secretflow.ml.nn.sl.backend.torch.sl_base"} fullname={"SLBaseTorchModel.load_fuse_model"} parameters={["fuse_model_path", "kwargs"]} description={"\u57fa\u7c7b\uff1aSLBaseModel"}>
      <Outline.Signature fullname="SLBaseTorchModel.load_fuse_model" id="secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.load_fuse_model">
        <Outline.Name>load\_fuse\_model</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">fuse\_model\_path</span><span>:</span><span>{" "}</span><span className="name">[str](https://docs.python.org/3/library/stdtypes.html#str "（在 Python v3.11）")</span></Outline.Parameter>, <Outline.Parameter><span>\*\*</span><span className="name">kwargs</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.export_base_model"} module={"secretflow.ml.nn.sl.backend.torch.sl_base"} fullname={"SLBaseTorchModel.export_base_model"} parameters={["model_path", "save_format", "kwargs"]} description={"\u57fa\u7c7b\uff1aSLBaseModel"}>
      <Outline.Signature fullname="SLBaseTorchModel.export_base_model" id="secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.export_base_model">
        <Outline.Name>export\_base\_model</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">model\_path</span><span>:</span><span>{" "}</span><span className="name">[str](https://docs.python.org/3/library/stdtypes.html#str "（在 Python v3.11）")</span></Outline.Parameter>, <Outline.Parameter><span className="name">save\_format</span><span>:</span><span>{" "}</span><span className="name">[str](https://docs.python.org/3/library/stdtypes.html#str "（在 Python v3.11）")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>'onnx'</span></Outline.Parameter>, <Outline.Parameter><span>\*\*</span><span className="name">kwargs</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.export_fuse_model"} module={"secretflow.ml.nn.sl.backend.torch.sl_base"} fullname={"SLBaseTorchModel.export_fuse_model"} parameters={["model_path", "save_format", "kwargs"]} description={"\u57fa\u7c7b\uff1aSLBaseModel"}>
      <Outline.Signature fullname="SLBaseTorchModel.export_fuse_model" id="secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.export_fuse_model">
        <Outline.Name>export\_fuse\_model</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">model\_path</span><span>:</span><span>{" "}</span><span className="name">[str](https://docs.python.org/3/library/stdtypes.html#str "（在 Python v3.11）")</span></Outline.Parameter>, <Outline.Parameter><span className="name">save\_format</span><span>:</span><span>{" "}</span><span className="name">[str](https://docs.python.org/3/library/stdtypes.html#str "（在 Python v3.11）")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>'onnx'</span></Outline.Parameter>, <Outline.Parameter><span>\*\*</span><span className="name">kwargs</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.get_privacy_spent"} module={"secretflow.ml.nn.sl.backend.torch.sl_base"} fullname={"SLBaseTorchModel.get_privacy_spent"} parameters={["step", "orders"]} description={"Get accountant of dp mechanism."}>
      <Outline.Signature fullname="SLBaseTorchModel.get_privacy_spent" id="secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel.get_privacy_spent">
        <Outline.Name>get\_privacy\_spent</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">step</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "（在 Python v3.11）")</span></Outline.Parameter>, <Outline.Parameter><span className="name">orders</span><span>=</span><span>None</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content>
        Get accountant of dp mechanism.

        <FieldList>
          <dl>
            <dt className="field-name">
              参数
            </dt>

            <dd className="field-body">
              - <strong>step</strong> – The current step of model training or prediction.
              - <strong>orders</strong> – An array (or a scalar) of RDP orders.
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>
  </Outline.Content>
</Outline>

:target{id="module-secretflow.ml.nn.sl.backend.torch"}

## Module contents
