:target{#secretflow-ml-nn-sl-backend-torch-strategy-package}

# secretflow\.ml.nn.sl.backend.torch.strategy package

:target{#submodules}

## Submodules

:target{id="module-secretflow.ml.nn.sl.backend.torch.strategy.split_nn"}

## secretflow\.ml.nn.sl.backend.torch.strategy.split\_nn module

Async split learning strategy

<strong>Classes:</strong>

<table>
  <tbody>
    <tr>
      <td>
        [`SLTorchModel`](#secretflow.ml.nn.sl.backend.torch.strategy.split_nn.SLTorchModel "secretflow.ml.nn.sl.backend.torch.strategy.split_nn.SLTorchModel")(builder\_base, builder\_fuse, ...)
      </td>

      <td>

      </td>
    </tr>

    <tr>
      <td>
        [`PYUSLTorchModel`](#secretflow.ml.nn.sl.backend.torch.strategy.split_nn.PYUSLTorchModel "secretflow.ml.nn.sl.backend.torch.strategy.split_nn.PYUSLTorchModel")
      </td>

      <td>
        `ActorProxy(PYUSLTorchModel)` 的别名
      </td>
    </tr>
  </tbody>
</table>

<Outline domain="py" objectType="class" target={"secretflow.ml.nn.sl.backend.torch.strategy.split_nn.SLTorchModel"} module={"secretflow.ml.nn.sl.backend.torch.strategy.split_nn"} fullname={"SLTorchModel"} parameters={["builder_base", "builder_fuse", "dp_strategy", "random_seed", "args", "kwargs"]} description={"\u57fa\u7c7b\uff1aSLBaseTorchModel"}>
  <Outline.Signature fullname="SLTorchModel" id="secretflow.ml.nn.sl.backend.torch.strategy.split_nn.SLTorchModel">
    <Outline.Keyword>class<span>{" "}</span></Outline.Keyword><Outline.Prefix>secretflow\.ml.nn.sl.backend.torch.strategy.split\_nn.</Outline.Prefix><Outline.Name>SLTorchModel</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">builder\_base</span><span>:</span><span>{" "}</span><span className="name">[Callable](https://docs.python.org/3/library/typing.html#typing.Callable "（在 Python v3.12）")<span>\[</span><span>\[</span><span>]</span><span>,</span><span>{" "}</span>[TorchModel](secretflow.ml.ml.nn.mdx#secretflow.ml.nn.utils.TorchModel "secretflow.ml.nn.utils.TorchModel")<span>]</span></span></Outline.Parameter>, <Outline.Parameter><span className="name">builder\_fuse</span><span>:</span><span>{" "}</span><span className="name">[Callable](https://docs.python.org/3/library/typing.html#typing.Callable "（在 Python v3.12）")<span>\[</span><span>\[</span><span>]</span><span>,</span><span>{" "}</span>[TorchModel](secretflow.ml.ml.nn.mdx#secretflow.ml.nn.utils.TorchModel "secretflow.ml.nn.utils.TorchModel")<span>]</span></span></Outline.Parameter>, <Outline.Parameter><span className="name">dp\_strategy</span><span>:</span><span>{" "}</span><span className="name">[DPStrategy](secretflow.security.security.privacy.mdx#secretflow.security.privacy.strategy.DPStrategy "secretflow.security.privacy.strategy.DPStrategy")</span></Outline.Parameter>, <Outline.Parameter><span className="name">random\_seed</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "（在 Python v3.12）")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "（在 Python v3.12）")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter>, <Outline.Parameter><span>\*</span><span className="name">args</span></Outline.Parameter>, <Outline.Parameter><span>\*\*</span><span className="name">kwargs</span></Outline.Parameter><span>)</span></Outline.ParameterList>
  </Outline.Signature>

  <Outline.Content>
    基类：[`SLBaseTorchModel`](secretflow.ml.nn.sl.backend.ml.nn.sl.backend.torch.mdx#secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel "secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel")

    <strong>Methods:</strong>

    <table>
      <tbody>
        <tr>
          <td>
            [`base_forward`](#secretflow.ml.nn.sl.backend.torch.strategy.split_nn.SLTorchModel.base_forward "secretflow.ml.nn.sl.backend.torch.strategy.split_nn.SLTorchModel.base_forward")(\[stage])
          </td>

          <td>
            compute hidden embedding \:param stage: Which stage of the base forward
          </td>
        </tr>

        <tr>
          <td>
            [`base_backward`](#secretflow.ml.nn.sl.backend.torch.strategy.split_nn.SLTorchModel.base_backward "secretflow.ml.nn.sl.backend.torch.strategy.split_nn.SLTorchModel.base_backward")(gradient)
          </td>

          <td>
            backward on fusenet
          </td>
        </tr>

        <tr>
          <td>
            [`fuse_net`](#secretflow.ml.nn.sl.backend.torch.strategy.split_nn.SLTorchModel.fuse_net "secretflow.ml.nn.sl.backend.torch.strategy.split_nn.SLTorchModel.fuse_net")(hidden\_features\[, \_num\_returns])
          </td>

          <td>
            Fuses the hidden layer and calculates the reverse gradient only on the side with the label
          </td>
        </tr>
      </tbody>
    </table>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.strategy.split_nn.SLTorchModel.base_forward"} module={"secretflow.ml.nn.sl.backend.torch.strategy.split_nn"} fullname={"SLTorchModel.base_forward"} parameters={["stage"]} description={"compute hidden embedding\n:param stage: Which stage of the base forward"}>
      <Outline.Signature fullname="SLTorchModel.base_forward" id="secretflow.ml.nn.sl.backend.torch.strategy.split_nn.SLTorchModel.base_forward">
        <Outline.Name>base\_forward</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">stage</span><span>=</span><span>'train'</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content>
        compute hidden embedding
        \:param stage: Which stage of the base forward

        Returns: hidden embedding
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.strategy.split_nn.SLTorchModel.base_backward"} module={"secretflow.ml.nn.sl.backend.torch.strategy.split_nn"} fullname={"SLTorchModel.base_backward"} parameters={["gradient"]} description={"backward on fusenet"}>
      <Outline.Signature fullname="SLTorchModel.base_backward" id="secretflow.ml.nn.sl.backend.torch.strategy.split_nn.SLTorchModel.base_backward">
        <Outline.Name>base\_backward</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">gradient</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content>
        backward on fusenet

        <FieldList>
          <dl>
            <dt className="field-name">
              参数
            </dt>

            <dd className="field-body">
              <strong>gradient</strong> – gradient of fusenet hidden layer
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.strategy.split_nn.SLTorchModel.fuse_net"} module={"secretflow.ml.nn.sl.backend.torch.strategy.split_nn"} fullname={"SLTorchModel.fuse_net"} parameters={["hidden_features", "_num_returns"]} description={"Fuses the hidden layer and calculates the reverse gradient\nonly on the side with the label"}>
      <Outline.Signature fullname="SLTorchModel.fuse_net" id="secretflow.ml.nn.sl.backend.torch.strategy.split_nn.SLTorchModel.fuse_net">
        <Outline.Name>fuse\_net</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">hidden\_features</span></Outline.Parameter>, <Outline.Parameter><span className="name">\_num\_returns</span><span>=</span><span>2</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content>
        Fuses the hidden layer and calculates the reverse gradient
        only on the side with the label

        <FieldList>
          <dl>
            <dt className="field-name">
              参数
            </dt>

            <dd className="field-body">
              <strong>hidden\_features</strong> – A list of hidden layers for each party to compute
            </dd>

            <dt className="field-name">
              返回
            </dt>

            <dd className="field-body">
              gradient Of hiddens
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>
  </Outline.Content>
</Outline>

<Outline domain="py" objectType="attribute" target={"secretflow.ml.nn.sl.backend.torch.strategy.split_nn.PYUSLTorchModel"} module={"secretflow.ml.nn.sl.backend.torch.strategy.split_nn"} fullname={"PYUSLTorchModel"} description={"ActorProxy(PYUSLTorchModel) \u7684\u522b\u540d\nMethods:"}>
  <Outline.Signature fullname="PYUSLTorchModel" id="secretflow.ml.nn.sl.backend.torch.strategy.split_nn.PYUSLTorchModel">
    <Outline.Prefix>secretflow\.ml.nn.sl.backend.torch.strategy.split\_nn.</Outline.Prefix><Outline.Name>PYUSLTorchModel</Outline.Name>
  </Outline.Signature>

  <Outline.Content>
    `ActorProxy(PYUSLTorchModel)` 的别名
    <strong>Methods:</strong>

    <table>
      <tbody>
        <tr>
          <td>
            `__init__`(\*args, \*\*kwargs)
          </td>

          <td>
            Abstraction device object base class.
          </td>
        </tr>

        <tr>
          <td>
            `base_backward`(gradient)
          </td>

          <td>
            backward on fusenet
          </td>
        </tr>

        <tr>
          <td>
            `base_forward`(\[stage])
          </td>

          <td>
            compute hidden embedding \:param stage: Which stage of the base forward
          </td>
        </tr>

        <tr>
          <td>
            `base_forward_internal`(data\_x)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `build_dataset_from_builder`(\*x\[, y, s\_w, ...])
          </td>

          <td>
            build torch.data.Dataset
          </td>
        </tr>

        <tr>
          <td>
            `build_dataset_from_numeric`(\*x\[, y, s\_w, ...])
          </td>

          <td>
            build torch.data.Dataset
          </td>
        </tr>

        <tr>
          <td>
            `evaluate`(\*hidden\_features)
          </td>

          <td>
            Returns the loss value & metrics values for the model in test mode.
          </td>
        </tr>

        <tr>
          <td>
            `export_base_model`(model\_path\[, save\_format])
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `export_fuse_model`(model\_path\[, save\_format])
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `fuse_net`(hidden\_features\[, \_num\_returns])
          </td>

          <td>
            Fuses the hidden layer and calculates the reverse gradient only on the side with the label
          </td>
        </tr>

        <tr>
          <td>
            `fuse_net_internal`(hiddens, train\_y, ...)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `get_base_weights`()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `get_basenet_output_num`()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `get_batch_data`(\[stage])
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `get_fuse_weights`()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `get_privacy_spent`(step\[, orders])
          </td>

          <td>
            Get accountant of dp mechanism.
          </td>
        </tr>

        <tr>
          <td>
            `get_stop_training`()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `init_data`()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `init_predict`(callbacks\[, steps, verbose])
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `init_training`(callbacks\[, epochs, steps, ...])
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `load_base_model`(base\_model\_path, \*\*kwargs)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `load_fuse_model`(fuse\_model\_path, \*\*kwargs)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `metrics`()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `on_epoch_begin`(epoch)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `on_epoch_end`(epoch)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `on_predict_batch_begin`(batch)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `on_predict_batch_end`(batch)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `on_predict_begin`()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `on_predict_end`()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `on_train_batch_begin`(\[step])
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `on_train_batch_end`(\[step])
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `on_train_begin`()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `on_train_end`()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `on_validation`(val\_logs)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `predict`(\*hidden\_features)
          </td>

          <td>
            Generates output predictions for the input hidden layer features.
          </td>
        </tr>

        <tr>
          <td>
            `reset_metrics`()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `save_base_model`(base\_model\_path, \*\*kwargs)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `save_fuse_model`(fuse\_model\_path, \*\*kwargs)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `set_dataset_stage`(data\_set\[, stage, has\_x, ...])
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `set_sample_weight`(sample\_weight\[, stage])
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `set_steps_per_epoch`(steps\_per\_epoch)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `unpack_dataset`(data, has\_x, has\_y, has\_s\_w)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `wrap_local_metrics`()
          </td>

          <td>

          </td>
        </tr>
      </tbody>
    </table>

    <strong>Attributes:</strong>

    <table>
      <tbody>
        <tr>
          <td>
            `device`
          </td>

          <td>

          </td>
        </tr>
      </tbody>
    </table>
  </Outline.Content>
</Outline>

:target{id="module-secretflow.ml.nn.sl.backend.torch.strategy"}

## Module contents
