<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1461px" preserveAspectRatio="none" style="width:1114px;height:1461px;background:#FFFFFF;" version="1.1" viewBox="0 0 1114 1461" width="1114px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="191" y="713.8828"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="245" y="1030.0078"/><rect fill="#FFFFFF" height="204.7969" style="stroke:#181818;stroke-width:1.0;" width="10" x="356" y="1163.5391"/><rect fill="none" height="75.3984" style="stroke:#000000;stroke-width:1.5;" width="664" x="163" y="302.2266"/><rect fill="none" height="116.5313" style="stroke:#000000;stroke-width:1.5;" width="420.5" x="325.5" y="1117.2734"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="196" x2="196" y1="36.2969" y2="1426.4688"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="250" x2="250" y1="36.2969" y2="1426.4688"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="360.5" x2="360.5" y1="36.2969" y2="1426.4688"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="788" x2="788" y1="36.2969" y2="1426.4688"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="46" x="173" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32" x="180" y="24.9951">Alice</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="46" x="173" y="1425.4688"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32" x="180" y="1445.4639">Alice</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="42" x="229" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28" x="236" y="24.9951">Bob</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="42" x="229" y="1425.4688"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28" x="236" y="1445.4639">Bob</text><rect fill="#FFA500" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="51" x="335.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37" x="342.5" y="24.9951">TEEU</text><rect fill="#FFA500" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="51" x="335.5" y="1425.4688"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37" x="342.5" y="1445.4639">TEEU</text><rect fill="#FFA500" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="58" x="759" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44" x="766" y="24.9951">AuthM</text><rect fill="#FFA500" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="58" x="759" y="1425.4688"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44" x="766" y="1445.4639">AuthM</text><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="191" y="713.8828"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="245" y="1030.0078"/><rect fill="#FFFFFF" height="204.7969" style="stroke:#181818;stroke-width:1.0;" width="10" x="356" y="1163.5391"/><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1107" x="0" y="66.8633"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1107" y1="66.8633" y2="66.8633"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1107" y1="69.8633" y2="69.8633"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="42" x="532.5" y="56.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="538.5" y="72.3638">Init</text><path d="M101,94.4297 L101,119.4297 L290,119.4297 L290,104.4297 L280,94.4297 L101,94.4297 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M280,94.4297 L280,104.4297 L290,104.4297 L280,94.4297 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168" x="107" y="111.4966">持有一对公私钥(pk_a, sk_a)</text><path d="M155,129.5625 L155,154.5625 L344,154.5625 L344,139.5625 L334,129.5625 L155,129.5625 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M334,129.5625 L334,139.5625 L344,139.5625 L334,129.5625 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168" x="161" y="146.6294">持有一对公私钥(pk_b, sk_b)</text><path d="M172,164.6953 L172,189.6953 L811,189.6953 L811,174.6953 L801,164.6953 L172,164.6953 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M801,164.6953 L801,174.6953 L811,174.6953 L801,164.6953 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="549" x="212.5" y="181.7622">TEEU 的安全度量值为 mr_enclave_teeu,  AuthManager 的安全度量值为 mr_enclave_auth</text><line style="stroke:#181818;stroke-width:1.0;" x1="746" x2="788" y1="215.9609" y2="215.9609"/><line style="stroke:#181818;stroke-width:1.0;" x1="746" x2="746" y1="215.9609" y2="228.9609"/><line style="stroke:#181818;stroke-width:1.0;" x1="746" x2="787" y1="228.9609" y2="228.9609"/><polygon fill="#181818" points="779,224.9609,789,228.9609,779,232.9609,783,228.9609" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="538" y="210.895">0.1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="223" x="565" y="210.895">启动时生成公私钥(pk_auth, sk_auth)</text><polygon fill="#181818" points="776,254.0938,786,258.0938,776,262.0938,780,258.0938" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="196" x2="782" y1="258.0938" y2="258.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="203" y="253.0278">0.2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="60" x="230" y="253.0278">发送 pk_a</text><polygon fill="#181818" points="776,283.2266,786,287.2266,776,291.2266,780,287.2266" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="250" x2="782" y1="287.2266" y2="287.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="257" y="282.1606">0.3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="60" x="284" y="282.1606">发送 pk_b</text><path d="M163,302.2266 L347,302.2266 L347,309.3594 L337,319.3594 L163,319.3594 L163,302.2266 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="75.3984" style="stroke:#000000;stroke-width:1.5;" width="664" x="163" y="302.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="139" x="178" y="315.2935">RemoteAttestation</text><polygon fill="#181818" points="776,336.4922,786,340.4922,776,344.4922,780,340.4922" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="196" x2="782" y1="340.4922" y2="340.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="203" y="335.4263">0.4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176" x="230" y="335.4263">RA 并获取 AuthM 公钥（pk）</text><polygon fill="#181818" points="776,365.625,786,369.625,776,373.625,780,369.625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="250" x2="782" y1="369.625" y2="369.625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="257" y="364.5591">0.5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176" x="284" y="364.5591">RA 并获取 AuthM 公钥（pk）</text><path d="M25,389.625 L25,414.625 L421,414.625 L421,399.625 L411,389.625 L25,389.625 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M411,389.625 L411,399.625 L421,399.625 L411,389.625 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="375" x="31" y="406.6919">Alice 提供数据 x，Bob 提供数据 y，需要安全执行函数 foo(x, y)</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1107" x="0" y="440.3242"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1107" y1="440.3242" y2="440.3242"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1107" y1="443.3242" y2="443.3242"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="92" x="507.5" y="429.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="73" x="513.5" y="445.8247">x.to(teeu)</text><rect fill="#F8E7C0" height="219" style="stroke:#181818;stroke-width:0.5;" width="382" x="5" y="467.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="9" y="483.9575">1.1 数据准备：</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="9" y="499.0903"> </text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="300" x="9" y="514.2231">(1) 随机生成加密数据密钥 dk_x 以及数据标识 id_x;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="9" y="529.356"> </text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="365" x="9" y="544.4888">(2) 使用 dk_x 加密数据 x 得到加密数据 e_x = Enc(dk_x, x)；</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="9" y="559.6216"> </text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="374" x="9" y="574.7544">(3) 使用 pk_auth 对 dk_x 进行加密 k_x = Enc(pk_auth, dk_x)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="9" y="589.8872"> </text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="266" x="9" y="605.02">(4) 计算签名 sig_x = Sig(sk_a, id_x || dk_x)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="9" y="620.1528"> </text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="353" x="9" y="635.2856">(5) 生成数据授权 auth_x = {id_x, foo, mr_enclave_teeu}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="9" y="650.4185"> </text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="314" x="9" y="665.5513">(6) 对授权信息签名 auth_x_sig = Sig(sk_a, auth_x)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="9" y="680.6841"> </text><polygon fill="#181818" points="776,709.8828,786,713.8828,776,717.8828,780,713.8828" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="201" x2="782" y1="713.8828" y2="713.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="208" y="708.8169">1.2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="221" x="235" y="708.8169">id_x, k_x, sig_x, auth_x, auth_x_sig</text><polygon fill="#181818" points="349,739.0156,359,743.0156,349,747.0156,353,743.0156" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="196" x2="355" y1="743.0156" y2="743.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="203" y="737.9497">1.3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="55" x="230" y="737.9497">id_x, e_x</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1107" x="0" y="771.582"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1107" y1="771.582" y2="771.582"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1107" y1="774.582" y2="774.582"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="92" x="507.5" y="761.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="73" x="513.5" y="777.0825">y.to(teeu)</text><rect fill="#F8E7C0" height="204" style="stroke:#181818;stroke-width:0.5;" width="382" x="59" y="799.1484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="63" y="815.2153">2.1 数据准备：</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="63" y="830.3481"> </text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="300" x="63" y="845.481">(1) 随机生成加密数据密钥 dk_y 以及数据标识 id_y;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="63" y="860.6138"> </text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="365" x="63" y="875.7466">(2) 使用 dk_y 加密数据 y 得到加密数据 e_y = Enc(dk_y, y)；</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="63" y="890.8794"> </text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="374" x="63" y="906.0122">(3) 使用 pk_auth 对 dk_y 进行加密 k_y = Enc(pk_auth, dk_y)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="63" y="921.145"> </text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="266" x="63" y="936.2778">(4) 计算签名 sig_y = Sig(sk_b, id_y || dk_y)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="63" y="951.4106"> </text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="353" x="63" y="966.5435">(4) 生成数据授权 auth_y = {id_y, foo, mr_enclave_teeu}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="63" y="981.6763"> </text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="314" x="63" y="996.8091">(5) 对授权信息签名 auth_y_sig = Sig(sk_b, auth_y)</text><polygon fill="#181818" points="776,1026.0078,786,1030.0078,776,1034.0078,780,1030.0078" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="255" x2="782" y1="1030.0078" y2="1030.0078"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="262" y="1024.9419">2.2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="221" x="289" y="1024.9419">id_y, k_y, sig_y, auth_y, auth_y_sig</text><polygon fill="#181818" points="349,1055.1406,359,1059.1406,349,1063.1406,353,1059.1406" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="250" x2="355" y1="1059.1406" y2="1059.1406"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="257" y="1054.0747">2.3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="55" x="284" y="1054.0747">id_y, e_y</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1107" x="0" y="1087.707"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1107" y1="1087.707" y2="1087.707"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1107" y1="1090.707" y2="1090.707"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="126" x="490.5" y="1077.1406"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="107" x="496.5" y="1093.2075">teeu(foo)(x, y)</text><path d="M325.5,1117.2734 L509.5,1117.2734 L509.5,1124.4063 L499.5,1134.4063 L325.5,1134.4063 L325.5,1117.2734 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="116.5313" style="stroke:#000000;stroke-width:1.5;" width="420.5" x="325.5" y="1117.2734"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="139" x="340.5" y="1130.3403">RemoteAttestation</text><line style="stroke:#181818;stroke-width:1.0;" x1="361" x2="408" y1="1150.5391" y2="1150.5391"/><line style="stroke:#181818;stroke-width:1.0;" x1="408" x2="408" y1="1150.5391" y2="1163.5391"/><line style="stroke:#181818;stroke-width:1.0;" x1="367" x2="408" y1="1163.5391" y2="1163.5391"/><polygon fill="#181818" points="377,1159.5391,367,1163.5391,377,1167.5391,373,1163.5391" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="373" y="1145.4731">3.1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="246" x="400" y="1145.4731">随机生成临时公私钥（pk_tmp, sk_tmp）</text><line style="stroke:#181818;stroke-width:1.0;" x1="366" x2="408" y1="1212.8047" y2="1212.8047"/><line style="stroke:#181818;stroke-width:1.0;" x1="408" x2="408" y1="1212.8047" y2="1225.8047"/><line style="stroke:#181818;stroke-width:1.0;" x1="367" x2="408" y1="1225.8047" y2="1225.8047"/><polygon fill="#181818" points="377,1221.8047,367,1225.8047,377,1229.8047,373,1225.8047" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="373" y="1200.1724">3.2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="222" x="400" y="1192.606">TEEU 生成远程认证报告 report, 其中:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="330" x="404" y="1207.7388">report.user_data = SHA256(pk_tmp||foo||id_x||id_y)</text><polygon fill="#181818" points="776,1257.9375,786,1261.9375,776,1265.9375,780,1261.9375" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="366" x2="782" y1="1261.9375" y2="1261.9375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="373" y="1256.8716">3.3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="371" x="400" y="1256.8716">发送 report, foo, id_x, id_y，pk_tmp用于请求 x, y 的解密密钥</text><line style="stroke:#181818;stroke-width:1.0;" x1="746" x2="788" y1="1291.0703" y2="1291.0703"/><line style="stroke:#181818;stroke-width:1.0;" x1="746" x2="746" y1="1291.0703" y2="1304.0703"/><line style="stroke:#181818;stroke-width:1.0;" x1="746" x2="787" y1="1304.0703" y2="1304.0703"/><polygon fill="#181818" points="779,1300.0703,789,1304.0703,779,1308.0703,783,1304.0703" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="483" y="1286.0044">3.4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="278" x="510" y="1286.0044">验证权限，auth_verify(report, foo, id_x, id_y)</text><polygon fill="#181818" points="377,1329.2031,367,1333.2031,377,1337.2031,373,1333.2031" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="371" x2="787" y1="1333.2031" y2="1333.2031"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="383" y="1328.1372">3.5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="250" x="410" y="1328.1372">将 dk_x, dk_y 用pk_tmp加密传输给 TEEU</text><line style="stroke:#181818;stroke-width:1.0;" x1="366" x2="408" y1="1367.3359" y2="1367.3359"/><line style="stroke:#181818;stroke-width:1.0;" x1="408" x2="408" y1="1367.3359" y2="1380.3359"/><line style="stroke:#181818;stroke-width:1.0;" x1="361" x2="408" y1="1380.3359" y2="1380.3359"/><polygon fill="#181818" points="371,1376.3359,361,1380.3359,371,1384.3359,367,1380.3359" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="373" y="1362.27">3.6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177" x="400" y="1362.27">解密 x &amp; y, 执行 r = foo(x, y)</text><rect fill="#FFAAAA" height="23" style="stroke:#181818;stroke-width:0.5;" width="208" x="174" y="1388.3359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167" x="194.75" y="1404.4028">Alice, Bob 都可以获取结果 r</text></g></svg>