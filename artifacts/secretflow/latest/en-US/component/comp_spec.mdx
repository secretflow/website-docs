---
git_download_url: https://github.com/secretflow/secretflow/raw/215ee402b76decfeb01e97c0861cab9f5ec3f823/docs/component/comp_spec.md
git_last_modified_commit: 215ee402b76decfeb01e97c0861cab9f5ec3f823
git_last_modified_time: '2023-12-06T20:08:22+08:00'
git_origin_url: https://github.com/secretflow/secretflow/blob/215ee402b76decfeb01e97c0861cab9f5ec3f823/docs/component/comp_spec.md
git_owner: secretflow
git_repo: secretflow
git_revision_commit: 215ee402b76decfeb01e97c0861cab9f5ec3f823
git_revision_time: '2023-12-06T20:08:22+08:00'
---

:target{#extended-specification}

# Extended Specification

:target{#table-of-contents}

## Table of Contents

:target{#cluster-proto}

### cluster.proto

- Messages
  - [SFClusterConfig](#sfclusterconfig)
  - [SFClusterConfig.PrivateConfig](#sfclusterconfig-privateconfig)
  - [SFClusterConfig.PublicConfig](#sfclusterconfig-publicconfig)
  - [SFClusterConfig.RayFedConfig](#sfclusterconfig-rayfedconfig)
  - [SFClusterConfig.SPUConfig](#sfclusterconfig-spuconfig)
  - [SFClusterDesc](#sfclusterdesc)
  - [SFClusterDesc.DeviceDesc](#sfclusterdesc-devicedesc)
  - [SFClusterDesc.RayFedConfig](#sfclusterdesc-rayfedconfig)

:target{#data-proto}

### data.proto

- Messages
  - [DeviceObjectCollection](#deviceobjectcollection)
  - [DeviceObjectCollection.DeviceObject](#deviceobjectcollection-deviceobject)

:target{#id1}

## cluster.proto

Proto file: [secretflow/protos/secretflow/spec/extend/cluster.proto](https://github.com/secretflow/secretflow/tree/main/secretflow/protos/secretflow/spec/extend/cluster.proto)

:target{#messages}

### Messages

:target{#sfclusterconfig}

#### SFClusterConfig

Runtime Config for a SecretFlow cluster.
Besides intrinsic SFClusterDesc, dynamic network configs are provided.

<table>
  <thead>
    <tr>
      <td>
        Field
      </td>

      <td>
        Type
      </td>

      <td>
        Description
      </td>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        desc
      </td>

      <td>
        [ SFClusterDesc](#sfclusterdesc)
      </td>

      <td>
        Intrinsic properties.
      </td>
    </tr>

    <tr>
      <td>
        public\_config
      </td>

      <td>
        [ SFClusterConfig.PublicConfig](#sfclusterconfig-publicconfig)
      </td>

      <td>
        Dynamic runtime public configs.
      </td>
    </tr>

    <tr>
      <td>
        private\_config
      </td>

      <td>
        [ SFClusterConfig.PrivateConfig](#sfclusterconfig-privateconfig)
      </td>

      <td>
        Dynamic runtime private configs.
      </td>
    </tr>
  </tbody>
</table>

:target{#sfclusterconfig-privateconfig}

#### SFClusterConfig.PrivateConfig

Different for each party.
Private and unique to each party.

<table>
  <thead>
    <tr>
      <td>
        Field
      </td>

      <td>
        Type
      </td>

      <td>
        Description
      </td>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        self\_party
      </td>

      <td>
        [<span> string</span>](https://docs.python.org/3/library/string.html#module-string "Python 3.12")
      </td>

      <td>
        none
      </td>
    </tr>

    <tr>
      <td>
        ray\_head\_addr
      </td>

      <td>
        [<span> string</span>](https://docs.python.org/3/library/string.html#module-string "Python 3.12")
      </td>

      <td>
        none
      </td>
    </tr>
  </tbody>
</table>

:target{#sfclusterconfig-publicconfig}

#### SFClusterConfig.PublicConfig

Public and shared to all parties.

<table>
  <thead>
    <tr>
      <td>
        Field
      </td>

      <td>
        Type
      </td>

      <td>
        Description
      </td>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        ray\_fed\_config
      </td>

      <td>
        [ SFClusterConfig.RayFedConfig](#sfclusterconfig-rayfedconfig)
      </td>

      <td>
        none
      </td>
    </tr>

    <tr>
      <td>
        spu\_configs
      </td>

      <td>
        [repeated SFClusterConfig.SPUConfig](#sfclusterconfig-spuconfig)
      </td>

      <td>
        none
      </td>
    </tr>
  </tbody>
</table>

:target{#sfclusterconfig-rayfedconfig}

#### SFClusterConfig.RayFedConfig

Addresses for the RayFed cluster of each party.

<table>
  <thead>
    <tr>
      <td>
        Field
      </td>

      <td>
        Type
      </td>

      <td>
        Description
      </td>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        parties
      </td>

      <td>
        [<span>repeated string</span>](https://docs.python.org/3/library/string.html#module-string "Python 3.12")
      </td>

      <td>
        none
      </td>
    </tr>

    <tr>
      <td>
        addresses
      </td>

      <td>
        [<span>repeated string</span>](https://docs.python.org/3/library/string.html#module-string "Python 3.12")
      </td>

      <td>
        none
      </td>
    </tr>

    <tr>
      <td>
        listen\_addresses
      </td>

      <td>
        [<span>repeated string</span>](https://docs.python.org/3/library/string.html#module-string "Python 3.12")
      </td>

      <td>
        none
      </td>
    </tr>
  </tbody>
</table>

:target{#sfclusterconfig-spuconfig}

#### SFClusterConfig.SPUConfig

Contains addresses for one SPU device.

<table>
  <thead>
    <tr>
      <td>
        Field
      </td>

      <td>
        Type
      </td>

      <td>
        Description
      </td>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        name
      </td>

      <td>
        [<span> string</span>](https://docs.python.org/3/library/string.html#module-string "Python 3.12")
      </td>

      <td>
        Should match SPU name in SFClusterDesc.devices.
      </td>
    </tr>

    <tr>
      <td>
        parties
      </td>

      <td>
        [<span>repeated string</span>](https://docs.python.org/3/library/string.html#module-string "Python 3.12")
      </td>

      <td>
        none
      </td>
    </tr>

    <tr>
      <td>
        addresses
      </td>

      <td>
        [<span>repeated string</span>](https://docs.python.org/3/library/string.html#module-string "Python 3.12")
      </td>

      <td>
        none
      </td>
    </tr>

    <tr>
      <td>
        listen\_addresses
      </td>

      <td>
        [<span>repeated string</span>](https://docs.python.org/3/library/string.html#module-string "Python 3.12")
      </td>

      <td>
        none
      </td>
    </tr>
  </tbody>
</table>

:target{#sfclusterdesc}

#### SFClusterDesc

Intrinsic properties of a SecretFlow cluster, including:

- Version info.
- Parties: who participate in the computation.
- Secret devices including  and their configs.

<table>
  <thead>
    <tr>
      <td>
        Field
      </td>

      <td>
        Type
      </td>

      <td>
        Description
      </td>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        sf\_version
      </td>

      <td>
        [<span> string</span>](https://docs.python.org/3/library/string.html#module-string "Python 3.12")
      </td>

      <td>
        SecretFlow version.
      </td>
    </tr>

    <tr>
      <td>
        py\_version
      </td>

      <td>
        [<span> string</span>](https://docs.python.org/3/library/string.html#module-string "Python 3.12")
      </td>

      <td>
        Python version.
      </td>
    </tr>

    <tr>
      <td>
        parties
      </td>

      <td>
        [<span>repeated string</span>](https://docs.python.org/3/library/string.html#module-string "Python 3.12")
      </td>

      <td>
        Joined entities. e.g. \[“alice”, “bob”,…].
      </td>
    </tr>

    <tr>
      <td>
        devices
      </td>

      <td>
        [repeated SFClusterDesc.DeviceDesc](#sfclusterdesc-devicedesc)
      </td>

      <td>
        Description of secret devices
      </td>
    </tr>

    <tr>
      <td>
        ray\_fed\_config
      </td>

      <td>
        [ SFClusterDesc.RayFedConfig](#sfclusterdesc-rayfedconfig)
      </td>

      <td>
        none
      </td>
    </tr>
  </tbody>
</table>

:target{#sfclusterdesc-devicedesc}

#### SFClusterDesc.DeviceDesc

Description for a secret device.

- PYUs do not need to claim since they are plaintext devices.
- Notes for config:
  At this moment, you have to provide a JSON string for different devices.
  We are going to formalize this part in future.
  - Example SPU config:

```json
{
    "runtime_config": {
        "protocol": "REF2K",
        "field": "FM64"
    },
    "link_desc": {
        "connect_retry_times": 60,
        "connect_retry_interval_ms": 1000,
        "brpc_channel_protocol": "http",
        "brpc_channel_connection_type": "pooled",
        "recv_timeout_ms": 1200000,
        "http_timeout_ms": 1200000
    }
}
```

Referrences:
SPU:
[https://www.secretflow.org.cn/docs/spu/latest/en-US/reference/runtime\_config#runtimeconfig](https://www.secretflow.org.cn/docs/spu/latest/en-US/reference/runtime_config#runtimeconfig)
HEU:
[https://www.secretflow.org.cn/docs/secretflow/latest/en-US/source/secretflow.device.device.device#secretflow.device.device.heu.HEU.\_\_init\_\_](https://www.secretflow.org.cn/docs/secretflow/latest/en-US/source/secretflow.device.device.device#secretflow.device.device.heu.HEU.__init__)

<table>
  <thead>
    <tr>
      <td>
        Field
      </td>

      <td>
        Type
      </td>

      <td>
        Description
      </td>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        name
      </td>

      <td>
        [<span> string</span>](https://docs.python.org/3/library/string.html#module-string "Python 3.12")
      </td>

      <td>
        Name of the device.
      </td>
    </tr>

    <tr>
      <td>
        type
      </td>

      <td>
        [<span> string</span>](https://docs.python.org/3/library/string.html#module-string "Python 3.12")
      </td>

      <td>
        Supported: SPU, HEU, TEEU.
      </td>
    </tr>

    <tr>
      <td>
        parties
      </td>

      <td>
        [<span>repeated string</span>](https://docs.python.org/3/library/string.html#module-string "Python 3.12")
      </td>

      <td>
        Parties of device.
      </td>
    </tr>

    <tr>
      <td>
        config
      </td>

      <td>
        [<span> string</span>](https://docs.python.org/3/library/string.html#module-string "Python 3.12")
      </td>

      <td>
        Specific config for the secret device.
      </td>
    </tr>
  </tbody>
</table>

:target{#sfclusterdesc-rayfedconfig}

#### SFClusterDesc.RayFedConfig

<table>
  <thead>
    <tr>
      <td>
        Field
      </td>

      <td>
        Type
      </td>

      <td>
        Description
      </td>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        cross\_silo\_comm\_backend
      </td>

      <td>
        [<span> string</span>](https://docs.python.org/3/library/string.html#module-string "Python 3.12")
      </td>

      <td>
        Indicates communication backend of RayFed. Accepted: ‘grpc’, ‘brpc\_link’ Dafault is ‘grpc’
      </td>
    </tr>
  </tbody>
</table>

:target{#enums}

### Enums

:target{#id2}

## data.proto

Proto file: [secretflow/protos/secretflow/spec/extend/data.proto](https://github.com/secretflow/secretflow/tree/main/secretflow/protos/secretflow/spec/extend/data.proto)

:target{#id3}

### Messages

:target{#deviceobjectcollection}

#### DeviceObjectCollection

Descibes public storage info for a collection of Device Objects.

<table>
  <thead>
    <tr>
      <td>
        Field
      </td>

      <td>
        Type
      </td>

      <td>
        Description
      </td>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        objs
      </td>

      <td>
        [repeated DeviceObjectCollection.DeviceObject](#deviceobjectcollection-deviceobject)
      </td>

      <td>
        none
      </td>
    </tr>

    <tr>
      <td>
        public\_info
      </td>

      <td>
        [<span> string</span>](https://docs.python.org/3/library/string.html#module-string "Python 3.12")
      </td>

      <td>
        Any public information.
      </td>
    </tr>
  </tbody>
</table>

:target{#deviceobjectcollection-deviceobject}

#### DeviceObjectCollection.DeviceObject

<table>
  <thead>
    <tr>
      <td>
        Field
      </td>

      <td>
        Type
      </td>

      <td>
        Description
      </td>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        type
      </td>

      <td>
        [<span> string</span>](https://docs.python.org/3/library/string.html#module-string "Python 3.12")
      </td>

      <td>
        Supported: `spu | pyu`
      </td>
    </tr>

    <tr>
      <td>
        data\_ref\_idxs
      </td>

      <td>
        [<span>repeated int32</span>](#int32)
      </td>

      <td>
        Index of data\_ref in the parent DistData message.
      </td>
    </tr>
  </tbody>
</table>

:target{#id4}

### Enums
