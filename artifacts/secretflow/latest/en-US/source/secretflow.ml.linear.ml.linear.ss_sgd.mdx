---
git_download_url: https://github.com/secretflow/secretflow/raw/8cf652dadee6c02cb09a0225efa6d7c6bae31246/docs/source/secretflow.ml.linear.ss_sgd.rst
git_last_modified_commit: c59f45b86fd3a02c15396643ebfaab772747004d
git_last_modified_time: '2022-11-17T10:54:06+08:00'
git_origin_url: https://github.com/secretflow/secretflow/blob/8cf652dadee6c02cb09a0225efa6d7c6bae31246/docs/source/secretflow.ml.linear.ss_sgd.rst
git_owner: secretflow
git_repo: secretflow
git_revision_commit: 8cf652dadee6c02cb09a0225efa6d7c6bae31246
git_revision_time: '2024-01-04T11:45:08+08:00'
---

:target{#secretflow-ml-linear-ss-sgd-package}

# secretflow\.ml.linear.ss\_sgd package

:target{#submodules}

## Submodules

:target{id="module-secretflow.ml.linear.ss_sgd.model"}

## <Target id="secretflow-ml-linear-ss-sgd-model-module" />secretflow\.ml.linear.ss\_sgd.model module

<strong>Classes:</strong>

<table>
  <tbody>
    <tr>
      <td>
        [`Penalty`](#secretflow.ml.linear.ss_sgd.model.Penalty "secretflow.ml.linear.ss_sgd.model.Penalty")(value)
      </td>

      <td>
        An enumeration.
      </td>
    </tr>

    <tr>
      <td>
        [`Strategy`](#secretflow.ml.linear.ss_sgd.model.Strategy "secretflow.ml.linear.ss_sgd.model.Strategy")(value)
      </td>

      <td>
        An enumeration.
      </td>
    </tr>

    <tr>
      <td>
        [`SSRegression`](#secretflow.ml.linear.ss_sgd.model.SSRegression "secretflow.ml.linear.ss_sgd.model.SSRegression")(spu)
      </td>

      <td>
        This method provides both linear and logistic regression linear models for vertical split dataset setting by using secret sharing with mini batch SGD training solver.
      </td>
    </tr>
  </tbody>
</table>

<Outline domain="py" objectType="class" target={"secretflow.ml.linear.ss_sgd.model.Penalty"} module={"secretflow.ml.linear.ss_sgd.model"} fullname={"Penalty"} parameters={["value"]} description={"Bases: Enum"}>
  <Outline.Signature fullname="Penalty" id="secretflow.ml.linear.ss_sgd.model.Penalty">
    <Outline.Keyword>class<span>{" "}</span></Outline.Keyword><Outline.Prefix>secretflow\.ml.linear.ss\_sgd.model.</Outline.Prefix><Outline.Name>Penalty</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">value</span></Outline.Parameter><span>)</span></Outline.ParameterList>
  </Outline.Signature>

  <Outline.Content>
    Bases: [`Enum`](https://docs.python.org/3/library/enum.html#enum.Enum "(in Python v3.12)")

    An enumeration.

    <strong>Attributes:</strong>

    <table>
      <tbody>
        <tr>
          <td>
            [`NONE`](#secretflow.ml.linear.ss_sgd.model.Penalty.NONE "secretflow.ml.linear.ss_sgd.model.Penalty.NONE")
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [`L1`](#secretflow.ml.linear.ss_sgd.model.Penalty.L1 "secretflow.ml.linear.ss_sgd.model.Penalty.L1")
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [`L2`](#secretflow.ml.linear.ss_sgd.model.Penalty.L2 "secretflow.ml.linear.ss_sgd.model.Penalty.L2")
          </td>

          <td>

          </td>
        </tr>
      </tbody>
    </table>

    <Outline domain="py" objectType="attribute" target={"secretflow.ml.linear.ss_sgd.model.Penalty.NONE"} module={"secretflow.ml.linear.ss_sgd.model"} fullname={"Penalty.NONE"} parameters={["value"]} description={"Bases: Enum"}>
      <Outline.Signature fullname="Penalty.NONE" id="secretflow.ml.linear.ss_sgd.model.Penalty.NONE">
        <Outline.Name>NONE</Outline.Name><Outline.Keyword><span>{" "}</span><span>=</span><span>{" "}</span>'None'</Outline.Keyword>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="attribute" target={"secretflow.ml.linear.ss_sgd.model.Penalty.L1"} module={"secretflow.ml.linear.ss_sgd.model"} fullname={"Penalty.L1"} parameters={["value"]} description={"Bases: Enum"}>
      <Outline.Signature fullname="Penalty.L1" id="secretflow.ml.linear.ss_sgd.model.Penalty.L1">
        <Outline.Name>L1</Outline.Name><Outline.Keyword><span>{" "}</span><span>=</span><span>{" "}</span>'l1'</Outline.Keyword>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="attribute" target={"secretflow.ml.linear.ss_sgd.model.Penalty.L2"} module={"secretflow.ml.linear.ss_sgd.model"} fullname={"Penalty.L2"} parameters={["value"]} description={"Bases: Enum"}>
      <Outline.Signature fullname="Penalty.L2" id="secretflow.ml.linear.ss_sgd.model.Penalty.L2">
        <Outline.Name>L2</Outline.Name><Outline.Keyword><span>{" "}</span><span>=</span><span>{" "}</span>'l2'</Outline.Keyword>
      </Outline.Signature>

      <Outline.Content />
    </Outline>
  </Outline.Content>
</Outline>

<Outline domain="py" objectType="class" target={"secretflow.ml.linear.ss_sgd.model.Strategy"} module={"secretflow.ml.linear.ss_sgd.model"} fullname={"Strategy"} parameters={["value"]} description={"Bases: Enum"}>
  <Outline.Signature fullname="Strategy" id="secretflow.ml.linear.ss_sgd.model.Strategy">
    <Outline.Keyword>class<span>{" "}</span></Outline.Keyword><Outline.Prefix>secretflow\.ml.linear.ss\_sgd.model.</Outline.Prefix><Outline.Name>Strategy</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">value</span></Outline.Parameter><span>)</span></Outline.ParameterList>
  </Outline.Signature>

  <Outline.Content>
    Bases: [`Enum`](https://docs.python.org/3/library/enum.html#enum.Enum "(in Python v3.12)")

    An enumeration.

    <strong>Attributes:</strong>

    <table>
      <tbody>
        <tr>
          <td>
            [`NAIVE_SGD`](#secretflow.ml.linear.ss_sgd.model.Strategy.NAIVE_SGD "secretflow.ml.linear.ss_sgd.model.Strategy.NAIVE_SGD")
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [`POLICY_SGD`](#secretflow.ml.linear.ss_sgd.model.Strategy.POLICY_SGD "secretflow.ml.linear.ss_sgd.model.Strategy.POLICY_SGD")
          </td>

          <td>

          </td>
        </tr>
      </tbody>
    </table>

    <Outline domain="py" objectType="attribute" target={"secretflow.ml.linear.ss_sgd.model.Strategy.NAIVE_SGD"} module={"secretflow.ml.linear.ss_sgd.model"} fullname={"Strategy.NAIVE_SGD"} parameters={["value"]} description={"Bases: Enum"}>
      <Outline.Signature fullname="Strategy.NAIVE_SGD" id="secretflow.ml.linear.ss_sgd.model.Strategy.NAIVE_SGD">
        <Outline.Name>NAIVE\_SGD</Outline.Name><Outline.Keyword><span>{" "}</span><span>=</span><span>{" "}</span>'naive\_sgd'</Outline.Keyword>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="attribute" target={"secretflow.ml.linear.ss_sgd.model.Strategy.POLICY_SGD"} module={"secretflow.ml.linear.ss_sgd.model"} fullname={"Strategy.POLICY_SGD"} parameters={["value"]} description={"Bases: Enum"}>
      <Outline.Signature fullname="Strategy.POLICY_SGD" id="secretflow.ml.linear.ss_sgd.model.Strategy.POLICY_SGD">
        <Outline.Name>POLICY\_SGD</Outline.Name><Outline.Keyword><span>{" "}</span><span>=</span><span>{" "}</span>'policy\_sgd'</Outline.Keyword>
      </Outline.Signature>

      <Outline.Content />
    </Outline>
  </Outline.Content>
</Outline>

<Outline domain="py" objectType="class" target={"secretflow.ml.linear.ss_sgd.model.SSRegression"} module={"secretflow.ml.linear.ss_sgd.model"} fullname={"SSRegression"} parameters={["spu"]} description={"Bases: object"}>
  <Outline.Signature fullname="SSRegression" id="secretflow.ml.linear.ss_sgd.model.SSRegression">
    <Outline.Keyword>class<span>{" "}</span></Outline.Keyword><Outline.Prefix>secretflow\.ml.linear.ss\_sgd.model.</Outline.Prefix><Outline.Name>SSRegression</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">spu</span><span>:</span><span>{" "}</span><span className="name">[SPU](secretflow.device.device.device.mdx#secretflow.device.device.spu.SPU "secretflow.device.device.spu.SPU")</span></Outline.Parameter><span>)</span></Outline.ParameterList>
  </Outline.Signature>

  <Outline.Content>
    Bases: [`object`](https://docs.python.org/3/library/functions.html#object "(in Python v3.12)")

    This method provides both linear and logistic regression linear models
    for vertical split dataset setting by using secret sharing with mini
    batch SGD training solver. SS-SGD is short for secret sharing SGD training.

    more detail for SGD:
    [https://stats.stackexchange.com/questions/488017/understanding-mini-batch-gradient-descent](https://stats.stackexchange.com/questions/488017/understanding-mini-batch-gradient-descent)

    Linear regression fits a linear model with coefficients w = (w1, â€¦, wp)
    to minimize the residual sum of squares between the observed targets in
    the dataset, and the targets predicted by the linear approximation.

    more detail for linear regression:
    [https://en.wikipedia.org/wiki/Linear\_regression](https://en.wikipedia.org/wiki/Linear_regression)

    Logistic regression, despite its name, is a linear model for classification
    rather than regression. logistic regression is also known in the literature
    as logit regression, maximum-entropy classification (MaxEnt) or the log-linear
    classifier. the probabilities describing the possible outcomes of a single trial
    are modeled using a logistic function. This method can fit binary regularization
    with optional L2 regularization.

    more detail for logistic regression:
    [https://en.wikipedia.org/wiki/Logistic\_regression](https://en.wikipedia.org/wiki/Logistic_regression)

    SPU is a verifiable and measurable secure computing device that running
    under various MPC protocols to provide provable security.

    More detail for SPU:
    [https://www.secretflow.org.cn/docs/spu/en/](https://www.secretflow.org.cn/docs/spu/en/)

    This method protects the original dataset and the final model by secret sharing
    the dataset to SPU device and running model fit under SPU.

    <FieldList>
      <dl>
        <dt className="field-name">
          Parameters
        </dt>

        <dd className="field-body">
          <Outline.ParameterTarget>spu</Outline.ParameterTarget> â€“ secure device.
        </dd>
      </dl>
    </FieldList>

    <p className="sidebar-rubric">
      Notes
    </p>

    training dataset should be normalized or standardized,
    otherwise the SGD solver will not converge.

    <strong>Methods:</strong>

    <table>
      <tbody>
        <tr>
          <td>
            [`__init__`](#secretflow.ml.linear.ss_sgd.model.SSRegression.__init__ "secretflow.ml.linear.ss_sgd.model.SSRegression.__init__")(spu)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [`fit`](#secretflow.ml.linear.ss_sgd.model.SSRegression.fit "secretflow.ml.linear.ss_sgd.model.SSRegression.fit")(x, y, epochs\[, learning\_rate, ...])
          </td>

          <td>
            Fit the model according to the given training data.
          </td>
        </tr>

        <tr>
          <td>
            [`save_model`](#secretflow.ml.linear.ss_sgd.model.SSRegression.save_model "secretflow.ml.linear.ss_sgd.model.SSRegression.save_model")()
          </td>

          <td>
            Save fit model in LinearModel format.
          </td>
        </tr>

        <tr>
          <td>
            [`load_model`](#secretflow.ml.linear.ss_sgd.model.SSRegression.load_model "secretflow.ml.linear.ss_sgd.model.SSRegression.load_model")(m)
          </td>

          <td>
            Load LinearModel format model.
          </td>
        </tr>

        <tr>
          <td>
            [`predict`](#secretflow.ml.linear.ss_sgd.model.SSRegression.predict "secretflow.ml.linear.ss_sgd.model.SSRegression.predict")(x\[, batch\_size, to\_pyu])
          </td>

          <td>
            Predict using the model.
          </td>
        </tr>
      </tbody>
    </table>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.ss_sgd.model.SSRegression.__init__"} module={"secretflow.ml.linear.ss_sgd.model"} fullname={"SSRegression.__init__"} parameters={["spu"]} description={"Bases: object"}>
      <Outline.Signature fullname="SSRegression.__init__" id="secretflow.ml.linear.ss_sgd.model.SSRegression.__init__">
        <Outline.Name>\_\_init\_\_</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">spu</span><span>:</span><span>{" "}</span><span className="name">[SPU](secretflow.device.device.device.mdx#secretflow.device.device.spu.SPU "secretflow.device.device.spu.SPU")</span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.12)")</Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.ss_sgd.model.SSRegression.fit"} module={"secretflow.ml.linear.ss_sgd.model"} fullname={"SSRegression.fit"} parameters={["x", "y", "epochs", "learning_rate", "batch_size", "sig_type", "reg_type", "penalty", "l2_norm", "eps", "decay_epoch", "decay_rate", "strategy"]} description={"Fit the model according to the given training data."}>
      <Outline.Signature fullname="SSRegression.fit" id="secretflow.ml.linear.ss_sgd.model.SSRegression.fit">
        <Outline.Name>fit</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">x</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.data.ndarray.mdx#secretflow.data.ndarray.ndarray.FedNdarray "secretflow.data.ndarray.ndarray.FedNdarray")<span>{" "}</span><span>|</span><span>{" "}</span>[VDataFrame](secretflow.data.data.vertical.mdx#secretflow.data.vertical.dataframe.VDataFrame "secretflow.data.vertical.dataframe.VDataFrame")</span></Outline.Parameter>, <Outline.Parameter><span className="name">y</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.data.ndarray.mdx#secretflow.data.ndarray.ndarray.FedNdarray "secretflow.data.ndarray.ndarray.FedNdarray")<span>{" "}</span><span>|</span><span>{" "}</span>[VDataFrame](secretflow.data.data.vertical.mdx#secretflow.data.vertical.dataframe.VDataFrame "secretflow.data.vertical.dataframe.VDataFrame")</span></Outline.Parameter>, <Outline.Parameter><span className="name">epochs</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.12)")</span></Outline.Parameter>, <Outline.Parameter><span className="name">learning\_rate</span><span>:</span><span>{" "}</span><span className="name">[float](https://docs.python.org/3/library/functions.html#float "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>0.1</span></Outline.Parameter>, <Outline.Parameter><span className="name">batch\_size</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>1024</span></Outline.Parameter>, <Outline.Parameter><span className="name">sig\_type</span><span>:</span><span>{" "}</span><span className="name">[str](https://docs.python.org/3/library/stdtypes.html#str "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>'t1'</span></Outline.Parameter>, <Outline.Parameter><span className="name">reg\_type</span><span>:</span><span>{" "}</span><span className="name">[str](https://docs.python.org/3/library/stdtypes.html#str "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>'logistic'</span></Outline.Parameter>, <Outline.Parameter><span className="name">penalty</span><span>:</span><span>{" "}</span><span className="name">[str](https://docs.python.org/3/library/stdtypes.html#str "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>'None'</span></Outline.Parameter>, <Outline.Parameter><span className="name">l2\_norm</span><span>:</span><span>{" "}</span><span className="name">[float](https://docs.python.org/3/library/functions.html#float "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>0.5</span></Outline.Parameter>, <Outline.Parameter><span className="name">eps</span><span>:</span><span>{" "}</span><span className="name">[float](https://docs.python.org/3/library/functions.html#float "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>0.001</span></Outline.Parameter>, <Outline.Parameter><span className="name">decay\_epoch</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.12)")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter>, <Outline.Parameter><span className="name">decay\_rate</span><span>:</span><span>{" "}</span><span className="name">[float](https://docs.python.org/3/library/functions.html#float "(in Python v3.12)")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter>, <Outline.Parameter><span className="name">strategy</span><span>:</span><span>{" "}</span><span className="name">[str](https://docs.python.org/3/library/stdtypes.html#str "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>'naive\_sgd'</span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.12)")</Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content>
        Fit the model according to the given training data.

        <FieldList>
          <dl>
            <dt className="field-name">
              Parameters
            </dt>

            <dd className="field-body">
              - <Outline.ParameterTarget>x</Outline.ParameterTarget> â€“ \{FedNdarray, VDataFrame} of shape (n\_samples, n\_features)
                Training vector, where <cite>n\_samples</cite> is the number of samples and
                <cite>n\_features</cite> is the number of features.
              - <Outline.ParameterTarget>y</Outline.ParameterTarget> â€“ \{FedNdarray, VDataFrame} of shape (n\_samples,)
                Target vector relative to X.
              - <Outline.ParameterTarget>epochs</Outline.ParameterTarget> â€“ int
                iteration rounds.
              - <Outline.ParameterTarget>learning\_rate</Outline.ParameterTarget> â€“ float, default=0.1
                controls how much to change the model in one epoch.
              - <Outline.ParameterTarget>batch\_size</Outline.ParameterTarget> â€“ int, default=1024
                how many samples use in one calculation.
              - <Outline.ParameterTarget>sig\_type</Outline.ParameterTarget> â€“ str, default=t1
                sigmoid approximation type.
              - <Outline.ParameterTarget>reg\_type</Outline.ParameterTarget> â€“ str, default=logistic
                Linear or Logistic regression.
              - <Outline.ParameterTarget>penalty</Outline.ParameterTarget> â€“ str, default=None
                The penalty (aka regularization term) to be used.
              - <Outline.ParameterTarget>l2\_norm</Outline.ParameterTarget> â€“ float, default=0.5
                L2 regularization term.
              - <Outline.ParameterTarget>eps</Outline.ParameterTarget> â€“ float, default=1e-3
                If the Wâ€™s change rate is less than this threshold, the model is considered to be converged, and the training stops early. 0 disable.
              - <Outline.ParameterTarget>decay\_rate</Outline.ParameterTarget> (<em>decay\_epoch /</em>) â€“ int, default=None
                decay learning rate, learning\_rate \* (decay\_rate \*\* floor(epoch / decay\_epoch)). None disable
                If strategy=policy\_sgd, then decay\_rate and decay\_epoch have default value 0.5, 5.
              - <Outline.ParameterTarget>strategy</Outline.ParameterTarget> â€“&#x20;

                str, default=naive\_sgd
                optimization strategy used in training
                > naive\_sgd means origin sgd
                > policy\_sgd(LR only) will scale the learning\_rate in each update like adam but with unify factor,
                so the batch\_size can be larger and the early stop strategy can be more aggressive, which accelerates
                training in most scenery(But not recommend for training with large regularization).
            </dd>

            <dt className="field-name">
              Returns
            </dt>

            <dd className="field-body">
              Final weights in SPUObject.
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.ss_sgd.model.SSRegression.save_model"} module={"secretflow.ml.linear.ss_sgd.model"} fullname={"SSRegression.save_model"} parameters={[]} description={"Save fit model in LinearModel format."}>
      <Outline.Signature fullname="SSRegression.save_model" id="secretflow.ml.linear.ss_sgd.model.SSRegression.save_model">
        <Outline.Name>save\_model</Outline.Name><Outline.ParameterList><span>(</span><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[LinearModel](secretflow.ml.ml.linear.mdx#secretflow.ml.linear.linear_model.LinearModel "secretflow.ml.linear.linear_model.LinearModel")</Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content>
        Save fit model in LinearModel format.
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.ss_sgd.model.SSRegression.load_model"} module={"secretflow.ml.linear.ss_sgd.model"} fullname={"SSRegression.load_model"} parameters={["m"]} description={"Load LinearModel format model."}>
      <Outline.Signature fullname="SSRegression.load_model" id="secretflow.ml.linear.ss_sgd.model.SSRegression.load_model">
        <Outline.Name>load\_model</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">m</span><span>:</span><span>{" "}</span><span className="name">[LinearModel](secretflow.ml.ml.linear.mdx#secretflow.ml.linear.linear_model.LinearModel "secretflow.ml.linear.linear_model.LinearModel")</span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.12)")</Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content>
        Load LinearModel format model.
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.ss_sgd.model.SSRegression.predict"} module={"secretflow.ml.linear.ss_sgd.model"} fullname={"SSRegression.predict"} parameters={["x", "batch_size", "to_pyu"]} description={"Predict using the model."}>
      <Outline.Signature fullname="SSRegression.predict" id="secretflow.ml.linear.ss_sgd.model.SSRegression.predict">
        <Outline.Name>predict</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">x</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.data.ndarray.mdx#secretflow.data.ndarray.ndarray.FedNdarray "secretflow.data.ndarray.ndarray.FedNdarray")<span>{" "}</span><span>|</span><span>{" "}</span>[VDataFrame](secretflow.data.data.vertical.mdx#secretflow.data.vertical.dataframe.VDataFrame "secretflow.data.vertical.dataframe.VDataFrame")</span></Outline.Parameter>, <Outline.Parameter><span className="name">batch\_size</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>1024</span></Outline.Parameter>, <Outline.Parameter><span className="name">to\_pyu</span><span>:</span><span>{" "}</span><span className="name">[PYU](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYU "secretflow.device.device.pyu.PYU")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[SPUObject](secretflow.device.device.device.mdx#secretflow.device.device.spu.SPUObject "secretflow.device.device.spu.SPUObject")<span>{" "}</span><span>|</span><span>{" "}</span>[FedNdarray](secretflow.data.data.ndarray.mdx#secretflow.data.ndarray.ndarray.FedNdarray "secretflow.data.ndarray.ndarray.FedNdarray")</Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content>
        Predict using the model.

        <FieldList>
          <dl>
            <dt className="field-name">
              Parameters
            </dt>

            <dd className="field-body">
              - <Outline.ParameterTarget>x</Outline.ParameterTarget> â€“ \{FedNdarray, VDataFrame} of shape (n\_samples, n\_features)
                Predict samples.
              - <Outline.ParameterTarget>batch\_size</Outline.ParameterTarget> â€“ int, default=1024
                how many samples use in one calculation.
              - <Outline.ParameterTarget>to\_pyu</Outline.ParameterTarget> â€“ the prediction initiator
                if not None predict result is reveal to to\_pyu device and save as FedNdarray
                otherwise, keep predict result in secret and save as SPUObject.
            </dd>

            <dt className="field-name">
              Returns
            </dt>

            <dd className="field-body">
              pred scores in SPUObject or FedNdarray, shape (n\_samples,)
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>
  </Outline.Content>
</Outline>

:target{id="module-secretflow.ml.linear.ss_sgd"}

## <Target id="module-contents" />Module contents

<strong>Classes:</strong>

<table>
  <tbody>
    <tr>
      <td>
        [`SSRegression`](#secretflow.ml.linear.ss_sgd.SSRegression "secretflow.ml.linear.ss_sgd.SSRegression")(spu)
      </td>

      <td>
        This method provides both linear and logistic regression linear models for vertical split dataset setting by using secret sharing with mini batch SGD training solver.
      </td>
    </tr>
  </tbody>
</table>

<Outline domain="py" objectType="class" target={"secretflow.ml.linear.ss_sgd.SSRegression"} module={"secretflow.ml.linear.ss_sgd"} fullname={"SSRegression"} parameters={["spu"]} description={"Bases: object"}>
  <Outline.Signature fullname="SSRegression" id="secretflow.ml.linear.ss_sgd.SSRegression">
    <Outline.Keyword>class<span>{" "}</span></Outline.Keyword><Outline.Prefix>secretflow\.ml.linear.ss\_sgd.</Outline.Prefix><Outline.Name>SSRegression</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">spu</span><span>:</span><span>{" "}</span><span className="name">[SPU](secretflow.device.device.device.mdx#secretflow.device.device.spu.SPU "secretflow.device.device.spu.SPU")</span></Outline.Parameter><span>)</span></Outline.ParameterList>
  </Outline.Signature>

  <Outline.Content>
    Bases: [`object`](https://docs.python.org/3/library/functions.html#object "(in Python v3.12)")

    This method provides both linear and logistic regression linear models
    for vertical split dataset setting by using secret sharing with mini
    batch SGD training solver. SS-SGD is short for secret sharing SGD training.

    more detail for SGD:
    [https://stats.stackexchange.com/questions/488017/understanding-mini-batch-gradient-descent](https://stats.stackexchange.com/questions/488017/understanding-mini-batch-gradient-descent)

    Linear regression fits a linear model with coefficients w = (w1, â€¦, wp)
    to minimize the residual sum of squares between the observed targets in
    the dataset, and the targets predicted by the linear approximation.

    more detail for linear regression:
    [https://en.wikipedia.org/wiki/Linear\_regression](https://en.wikipedia.org/wiki/Linear_regression)

    Logistic regression, despite its name, is a linear model for classification
    rather than regression. logistic regression is also known in the literature
    as logit regression, maximum-entropy classification (MaxEnt) or the log-linear
    classifier. the probabilities describing the possible outcomes of a single trial
    are modeled using a logistic function. This method can fit binary regularization
    with optional L2 regularization.

    more detail for logistic regression:
    [https://en.wikipedia.org/wiki/Logistic\_regression](https://en.wikipedia.org/wiki/Logistic_regression)

    SPU is a verifiable and measurable secure computing device that running
    under various MPC protocols to provide provable security.

    More detail for SPU:
    [https://www.secretflow.org.cn/docs/spu/en/](https://www.secretflow.org.cn/docs/spu/en/)

    This method protects the original dataset and the final model by secret sharing
    the dataset to SPU device and running model fit under SPU.

    <FieldList>
      <dl>
        <dt className="field-name">
          Parameters
        </dt>

        <dd className="field-body">
          <Outline.ParameterTarget>spu</Outline.ParameterTarget> â€“ secure device.
        </dd>
      </dl>
    </FieldList>

    <p className="sidebar-rubric">
      Notes
    </p>

    training dataset should be normalized or standardized,
    otherwise the SGD solver will not converge.

    <strong>Methods:</strong>

    <table>
      <tbody>
        <tr>
          <td>
            [`__init__`](#secretflow.ml.linear.ss_sgd.SSRegression.__init__ "secretflow.ml.linear.ss_sgd.SSRegression.__init__")(spu)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [`fit`](#secretflow.ml.linear.ss_sgd.SSRegression.fit "secretflow.ml.linear.ss_sgd.SSRegression.fit")(x, y, epochs\[, learning\_rate, ...])
          </td>

          <td>
            Fit the model according to the given training data.
          </td>
        </tr>

        <tr>
          <td>
            [`save_model`](#secretflow.ml.linear.ss_sgd.SSRegression.save_model "secretflow.ml.linear.ss_sgd.SSRegression.save_model")()
          </td>

          <td>
            Save fit model in LinearModel format.
          </td>
        </tr>

        <tr>
          <td>
            [`load_model`](#secretflow.ml.linear.ss_sgd.SSRegression.load_model "secretflow.ml.linear.ss_sgd.SSRegression.load_model")(m)
          </td>

          <td>
            Load LinearModel format model.
          </td>
        </tr>

        <tr>
          <td>
            [`predict`](#secretflow.ml.linear.ss_sgd.SSRegression.predict "secretflow.ml.linear.ss_sgd.SSRegression.predict")(x\[, batch\_size, to\_pyu])
          </td>

          <td>
            Predict using the model.
          </td>
        </tr>
      </tbody>
    </table>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.ss_sgd.SSRegression.__init__"} module={"secretflow.ml.linear.ss_sgd"} fullname={"SSRegression.__init__"} parameters={["spu"]} description={"Bases: object"}>
      <Outline.Signature fullname="SSRegression.__init__" id="secretflow.ml.linear.ss_sgd.SSRegression.__init__">
        <Outline.Name>\_\_init\_\_</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">spu</span><span>:</span><span>{" "}</span><span className="name">[SPU](secretflow.device.device.device.mdx#secretflow.device.device.spu.SPU "secretflow.device.device.spu.SPU")</span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.12)")</Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.ss_sgd.SSRegression.fit"} module={"secretflow.ml.linear.ss_sgd"} fullname={"SSRegression.fit"} parameters={["x", "y", "epochs", "learning_rate", "batch_size", "sig_type", "reg_type", "penalty", "l2_norm", "eps", "decay_epoch", "decay_rate", "strategy"]} description={"Fit the model according to the given training data."}>
      <Outline.Signature fullname="SSRegression.fit" id="secretflow.ml.linear.ss_sgd.SSRegression.fit">
        <Outline.Name>fit</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">x</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.data.ndarray.mdx#secretflow.data.ndarray.ndarray.FedNdarray "secretflow.data.ndarray.ndarray.FedNdarray")<span>{" "}</span><span>|</span><span>{" "}</span>[VDataFrame](secretflow.data.data.vertical.mdx#secretflow.data.vertical.dataframe.VDataFrame "secretflow.data.vertical.dataframe.VDataFrame")</span></Outline.Parameter>, <Outline.Parameter><span className="name">y</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.data.ndarray.mdx#secretflow.data.ndarray.ndarray.FedNdarray "secretflow.data.ndarray.ndarray.FedNdarray")<span>{" "}</span><span>|</span><span>{" "}</span>[VDataFrame](secretflow.data.data.vertical.mdx#secretflow.data.vertical.dataframe.VDataFrame "secretflow.data.vertical.dataframe.VDataFrame")</span></Outline.Parameter>, <Outline.Parameter><span className="name">epochs</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.12)")</span></Outline.Parameter>, <Outline.Parameter><span className="name">learning\_rate</span><span>:</span><span>{" "}</span><span className="name">[float](https://docs.python.org/3/library/functions.html#float "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>0.1</span></Outline.Parameter>, <Outline.Parameter><span className="name">batch\_size</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>1024</span></Outline.Parameter>, <Outline.Parameter><span className="name">sig\_type</span><span>:</span><span>{" "}</span><span className="name">[str](https://docs.python.org/3/library/stdtypes.html#str "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>'t1'</span></Outline.Parameter>, <Outline.Parameter><span className="name">reg\_type</span><span>:</span><span>{" "}</span><span className="name">[str](https://docs.python.org/3/library/stdtypes.html#str "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>'logistic'</span></Outline.Parameter>, <Outline.Parameter><span className="name">penalty</span><span>:</span><span>{" "}</span><span className="name">[str](https://docs.python.org/3/library/stdtypes.html#str "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>'None'</span></Outline.Parameter>, <Outline.Parameter><span className="name">l2\_norm</span><span>:</span><span>{" "}</span><span className="name">[float](https://docs.python.org/3/library/functions.html#float "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>0.5</span></Outline.Parameter>, <Outline.Parameter><span className="name">eps</span><span>:</span><span>{" "}</span><span className="name">[float](https://docs.python.org/3/library/functions.html#float "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>0.001</span></Outline.Parameter>, <Outline.Parameter><span className="name">decay\_epoch</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.12)")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter>, <Outline.Parameter><span className="name">decay\_rate</span><span>:</span><span>{" "}</span><span className="name">[float](https://docs.python.org/3/library/functions.html#float "(in Python v3.12)")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter>, <Outline.Parameter><span className="name">strategy</span><span>:</span><span>{" "}</span><span className="name">[str](https://docs.python.org/3/library/stdtypes.html#str "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>'naive\_sgd'</span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.12)")</Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content>
        Fit the model according to the given training data.

        <FieldList>
          <dl>
            <dt className="field-name">
              Parameters
            </dt>

            <dd className="field-body">
              - <Outline.ParameterTarget>x</Outline.ParameterTarget> â€“ \{FedNdarray, VDataFrame} of shape (n\_samples, n\_features)
                Training vector, where <cite>n\_samples</cite> is the number of samples and
                <cite>n\_features</cite> is the number of features.
              - <Outline.ParameterTarget>y</Outline.ParameterTarget> â€“ \{FedNdarray, VDataFrame} of shape (n\_samples,)
                Target vector relative to X.
              - <Outline.ParameterTarget>epochs</Outline.ParameterTarget> â€“ int
                iteration rounds.
              - <Outline.ParameterTarget>learning\_rate</Outline.ParameterTarget> â€“ float, default=0.1
                controls how much to change the model in one epoch.
              - <Outline.ParameterTarget>batch\_size</Outline.ParameterTarget> â€“ int, default=1024
                how many samples use in one calculation.
              - <Outline.ParameterTarget>sig\_type</Outline.ParameterTarget> â€“ str, default=t1
                sigmoid approximation type.
              - <Outline.ParameterTarget>reg\_type</Outline.ParameterTarget> â€“ str, default=logistic
                Linear or Logistic regression.
              - <Outline.ParameterTarget>penalty</Outline.ParameterTarget> â€“ str, default=None
                The penalty (aka regularization term) to be used.
              - <Outline.ParameterTarget>l2\_norm</Outline.ParameterTarget> â€“ float, default=0.5
                L2 regularization term.
              - <Outline.ParameterTarget>eps</Outline.ParameterTarget> â€“ float, default=1e-3
                If the Wâ€™s change rate is less than this threshold, the model is considered to be converged, and the training stops early. 0 disable.
              - <Outline.ParameterTarget>decay\_rate</Outline.ParameterTarget> (<em>decay\_epoch /</em>) â€“ int, default=None
                decay learning rate, learning\_rate \* (decay\_rate \*\* floor(epoch / decay\_epoch)). None disable
                If strategy=policy\_sgd, then decay\_rate and decay\_epoch have default value 0.5, 5.
              - <Outline.ParameterTarget>strategy</Outline.ParameterTarget> â€“&#x20;

                str, default=naive\_sgd
                optimization strategy used in training
                > naive\_sgd means origin sgd
                > policy\_sgd(LR only) will scale the learning\_rate in each update like adam but with unify factor,
                so the batch\_size can be larger and the early stop strategy can be more aggressive, which accelerates
                training in most scenery(But not recommend for training with large regularization).
            </dd>

            <dt className="field-name">
              Returns
            </dt>

            <dd className="field-body">
              Final weights in SPUObject.
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.ss_sgd.SSRegression.save_model"} module={"secretflow.ml.linear.ss_sgd"} fullname={"SSRegression.save_model"} parameters={[]} description={"Save fit model in LinearModel format."}>
      <Outline.Signature fullname="SSRegression.save_model" id="secretflow.ml.linear.ss_sgd.SSRegression.save_model">
        <Outline.Name>save\_model</Outline.Name><Outline.ParameterList><span>(</span><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[LinearModel](secretflow.ml.ml.linear.mdx#secretflow.ml.linear.linear_model.LinearModel "secretflow.ml.linear.linear_model.LinearModel")</Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content>
        Save fit model in LinearModel format.
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.ss_sgd.SSRegression.load_model"} module={"secretflow.ml.linear.ss_sgd"} fullname={"SSRegression.load_model"} parameters={["m"]} description={"Load LinearModel format model."}>
      <Outline.Signature fullname="SSRegression.load_model" id="secretflow.ml.linear.ss_sgd.SSRegression.load_model">
        <Outline.Name>load\_model</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">m</span><span>:</span><span>{" "}</span><span className="name">[LinearModel](secretflow.ml.ml.linear.mdx#secretflow.ml.linear.linear_model.LinearModel "secretflow.ml.linear.linear_model.LinearModel")</span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.12)")</Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content>
        Load LinearModel format model.
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.ss_sgd.SSRegression.predict"} module={"secretflow.ml.linear.ss_sgd"} fullname={"SSRegression.predict"} parameters={["x", "batch_size", "to_pyu"]} description={"Predict using the model."}>
      <Outline.Signature fullname="SSRegression.predict" id="secretflow.ml.linear.ss_sgd.SSRegression.predict">
        <Outline.Name>predict</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">x</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.data.ndarray.mdx#secretflow.data.ndarray.ndarray.FedNdarray "secretflow.data.ndarray.ndarray.FedNdarray")<span>{" "}</span><span>|</span><span>{" "}</span>[VDataFrame](secretflow.data.data.vertical.mdx#secretflow.data.vertical.dataframe.VDataFrame "secretflow.data.vertical.dataframe.VDataFrame")</span></Outline.Parameter>, <Outline.Parameter><span className="name">batch\_size</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>1024</span></Outline.Parameter>, <Outline.Parameter><span className="name">to\_pyu</span><span>:</span><span>{" "}</span><span className="name">[PYU](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYU "secretflow.device.device.pyu.PYU")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[SPUObject](secretflow.device.device.device.mdx#secretflow.device.device.spu.SPUObject "secretflow.device.device.spu.SPUObject")<span>{" "}</span><span>|</span><span>{" "}</span>[FedNdarray](secretflow.data.data.ndarray.mdx#secretflow.data.ndarray.ndarray.FedNdarray "secretflow.data.ndarray.ndarray.FedNdarray")</Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content>
        Predict using the model.

        <FieldList>
          <dl>
            <dt className="field-name">
              Parameters
            </dt>

            <dd className="field-body">
              - <Outline.ParameterTarget>x</Outline.ParameterTarget> â€“ \{FedNdarray, VDataFrame} of shape (n\_samples, n\_features)
                Predict samples.
              - <Outline.ParameterTarget>batch\_size</Outline.ParameterTarget> â€“ int, default=1024
                how many samples use in one calculation.
              - <Outline.ParameterTarget>to\_pyu</Outline.ParameterTarget> â€“ the prediction initiator
                if not None predict result is reveal to to\_pyu device and save as FedNdarray
                otherwise, keep predict result in secret and save as SPUObject.
            </dd>

            <dt className="field-name">
              Returns
            </dt>

            <dd className="field-body">
              pred scores in SPUObject or FedNdarray, shape (n\_samples,)
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>
  </Outline.Content>
</Outline>
