:target{#secretflow-ml-nn-sl-backend-torch-strategy-package}

# secretflow\.ml.nn.sl.backend.torch.strategy package

:target{#submodules}

## Submodules

:target{id="module-secretflow.ml.nn.sl.backend.torch.strategy.split_nn"}

## secretflow\.ml.nn.sl.backend.torch.strategy.split\_nn module

Async split learning strategy

<strong>Classes:</strong>

<table>
  <tbody>
    <tr>
      <td>
        [<code>SLTorchModel</code>](#secretflow.ml.nn.sl.backend.torch.strategy.split_nn.SLTorchModel "secretflow.ml.nn.sl.backend.torch.strategy.split_nn.SLTorchModel")(builder\_base, builder\_fuse, ...)
      </td>

      <td>

      </td>
    </tr>

    <tr>
      <td>
        [<code>PYUSLTorchModel</code>](#secretflow.ml.nn.sl.backend.torch.strategy.split_nn.PYUSLTorchModel "secretflow.ml.nn.sl.backend.torch.strategy.split_nn.PYUSLTorchModel")
      </td>

      <td>
        alias of <code>ActorProxy(PYUSLTorchModel)</code>
      </td>
    </tr>
  </tbody>
</table>

<Outline domain="py" objectType="class" target={"secretflow.ml.nn.sl.backend.torch.strategy.split_nn.SLTorchModel"} module={"secretflow.ml.nn.sl.backend.torch.strategy.split_nn"} fullname={"SLTorchModel"} parameters={["builder_base", "builder_fuse", "dp_strategy", "random_seed", "args", "kwargs"]} description={"Bases: SLBaseTorchModel"}>
  <Outline.Signature fullname="SLTorchModel" id="secretflow.ml.nn.sl.backend.torch.strategy.split_nn.SLTorchModel">
    <Outline.Keyword>class<span>{" "}</span></Outline.Keyword><Outline.Prefix>secretflow\.ml.nn.sl.backend.torch.strategy.split\_nn.</Outline.Prefix><Outline.Name>SLTorchModel</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">builder\_base</span><span>:</span><span>{" "}</span><span className="name">[Callable](https://docs.python.org/3/library/typing.html#typing.Callable "(in Python v3.11)")<span>\[</span><span>\[</span><span>]</span><span>,</span><span>{" "}</span>[TorchModel](secretflow.ml.ml.nn.mdx#secretflow.ml.nn.utils.TorchModel "secretflow.ml.nn.utils.TorchModel")<span>]</span></span></Outline.Parameter>, <Outline.Parameter><span className="name">builder\_fuse</span><span>:</span><span>{" "}</span><span className="name">[Callable](https://docs.python.org/3/library/typing.html#typing.Callable "(in Python v3.11)")<span>\[</span><span>\[</span><span>]</span><span>,</span><span>{" "}</span>[TorchModel](secretflow.ml.ml.nn.mdx#secretflow.ml.nn.utils.TorchModel "secretflow.ml.nn.utils.TorchModel")<span>]</span></span></Outline.Parameter>, <Outline.Parameter><span className="name">dp\_strategy</span><span>:</span><span>{" "}</span><span className="name">[DPStrategy](secretflow.security.security.privacy.mdx#secretflow.security.privacy.strategy.DPStrategy "secretflow.security.privacy.strategy.DPStrategy")</span></Outline.Parameter>, <Outline.Parameter><span className="name">random\_seed</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.11)")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter>, <Outline.Parameter><span>\*</span><span className="name">args</span></Outline.Parameter>, <Outline.Parameter><span>\*\*</span><span className="name">kwargs</span></Outline.Parameter><span>)</span></Outline.ParameterList>
  </Outline.Signature>

  <Outline.Content>
    Bases: [<code>SLBaseTorchModel</code>](secretflow.ml.nn.sl.backend.ml.nn.sl.backend.torch.mdx#secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel "secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel")

    <strong>Methods:</strong>

    <table>
      <tbody>
        <tr>
          <td>
            [<code>base\_forward</code>](#secretflow.ml.nn.sl.backend.torch.strategy.split_nn.SLTorchModel.base_forward "secretflow.ml.nn.sl.backend.torch.strategy.split_nn.SLTorchModel.base_forward")(\[stage])
          </td>

          <td>
            compute hidden embedding \:param stage: Which stage of the base forward
          </td>
        </tr>

        <tr>
          <td>
            [<code>base\_backward</code>](#secretflow.ml.nn.sl.backend.torch.strategy.split_nn.SLTorchModel.base_backward "secretflow.ml.nn.sl.backend.torch.strategy.split_nn.SLTorchModel.base_backward")(gradient)
          </td>

          <td>
            backward on fusenet
          </td>
        </tr>

        <tr>
          <td>
            [<code>fuse\_net</code>](#secretflow.ml.nn.sl.backend.torch.strategy.split_nn.SLTorchModel.fuse_net "secretflow.ml.nn.sl.backend.torch.strategy.split_nn.SLTorchModel.fuse_net")(\*hidden\_features\[, \_num\_returns])
          </td>

          <td>
            Fuses the hidden layer and calculates the reverse gradient only on the side with the label
          </td>
        </tr>
      </tbody>
    </table>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.strategy.split_nn.SLTorchModel.base_forward"} module={"secretflow.ml.nn.sl.backend.torch.strategy.split_nn"} fullname={"SLTorchModel.base_forward"} parameters={["stage"]} description={"compute hidden embedding\n:param stage: Which stage of the base forward"}>
      <Outline.Signature fullname="SLTorchModel.base_forward" id="secretflow.ml.nn.sl.backend.torch.strategy.split_nn.SLTorchModel.base_forward">
        <Outline.Name>base\_forward</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">stage</span><span>=</span><span>'train'</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content>
        compute hidden embedding
        \:param stage: Which stage of the base forward

        Returns: hidden embedding
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.strategy.split_nn.SLTorchModel.base_backward"} module={"secretflow.ml.nn.sl.backend.torch.strategy.split_nn"} fullname={"SLTorchModel.base_backward"} parameters={["gradient"]} description={"backward on fusenet"}>
      <Outline.Signature fullname="SLTorchModel.base_backward" id="secretflow.ml.nn.sl.backend.torch.strategy.split_nn.SLTorchModel.base_backward">
        <Outline.Name>base\_backward</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">gradient</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content>
        backward on fusenet

        <FieldList>
          <dl>
            <dt className="field-name">
              Parameters
            </dt>

            <dd className="field-body">
              <Outline.ParameterTarget>gradient</Outline.ParameterTarget> – gradient of fusenet hidden layer
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.strategy.split_nn.SLTorchModel.fuse_net"} module={"secretflow.ml.nn.sl.backend.torch.strategy.split_nn"} fullname={"SLTorchModel.fuse_net"} parameters={["hidden_features", "_num_returns"]} description={"Fuses the hidden layer and calculates the reverse gradient\nonly on the side with the label"}>
      <Outline.Signature fullname="SLTorchModel.fuse_net" id="secretflow.ml.nn.sl.backend.torch.strategy.split_nn.SLTorchModel.fuse_net">
        <Outline.Name>fuse\_net</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span>\*</span><span className="name">hidden\_features</span></Outline.Parameter>, <Outline.Parameter><span className="name">\_num\_returns</span><span>=</span><span>2</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content>
        Fuses the hidden layer and calculates the reverse gradient
        only on the side with the label

        <FieldList>
          <dl>
            <dt className="field-name">
              Parameters
            </dt>

            <dd className="field-body">
              <Outline.ParameterTarget>hidden\_features</Outline.ParameterTarget> – A list of hidden layers for each party to compute
            </dd>

            <dt className="field-name">
              Returns
            </dt>

            <dd className="field-body">
              gradient Of hiddens
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>
  </Outline.Content>
</Outline>

<Outline domain="py" objectType="attribute" target={"secretflow.ml.nn.sl.backend.torch.strategy.split_nn.PYUSLTorchModel"} module={"secretflow.ml.nn.sl.backend.torch.strategy.split_nn"} fullname={"PYUSLTorchModel"} description={"alias of ActorProxy(PYUSLTorchModel)\nMethods:"}>
  <Outline.Signature fullname="PYUSLTorchModel" id="secretflow.ml.nn.sl.backend.torch.strategy.split_nn.PYUSLTorchModel">
    <Outline.Prefix>secretflow\.ml.nn.sl.backend.torch.strategy.split\_nn.</Outline.Prefix><Outline.Name>PYUSLTorchModel</Outline.Name>
  </Outline.Signature>

  <Outline.Content>
    alias of <code>ActorProxy(PYUSLTorchModel)</code>
    <strong>Methods:</strong>

    <table>
      <tbody>
        <tr>
          <td>
            <code>\_\_init\_\_</code>(\*args, \*\*kwargs)
          </td>

          <td>
            Abstraction device object base class.
          </td>
        </tr>

        <tr>
          <td>
            <code>base\_backward</code>(gradient)
          </td>

          <td>
            backward on fusenet
          </td>
        </tr>

        <tr>
          <td>
            <code>base\_forward</code>(\[stage])
          </td>

          <td>
            compute hidden embedding \:param stage: Which stage of the base forward
          </td>
        </tr>

        <tr>
          <td>
            <code>base\_forward\_internal</code>(data\_x)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            <code>build\_dataset\_from\_builder</code>(\*x\[, y, s\_w, ...])
          </td>

          <td>
            build torch.data.Dataset
          </td>
        </tr>

        <tr>
          <td>
            <code>build\_dataset\_from\_numeric</code>(\*x\[, y, s\_w, ...])
          </td>

          <td>
            build torch.data.Dataset
          </td>
        </tr>

        <tr>
          <td>
            <code>evaluate</code>(\*hidden\_features)
          </td>

          <td>
            Returns the loss value & metrics values for the model in test mode.
          </td>
        </tr>

        <tr>
          <td>
            <code>export\_base\_model</code>(model\_path\[, save\_format])
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            <code>export\_fuse\_model</code>(model\_path\[, save\_format])
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            <code>fuse\_net</code>(\*hidden\_features\[, \_num\_returns])
          </td>

          <td>
            Fuses the hidden layer and calculates the reverse gradient only on the side with the label
          </td>
        </tr>

        <tr>
          <td>
            <code>fuse\_net\_internal</code>(hiddens, train\_y, ...)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            <code>get\_base\_weights</code>()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            <code>get\_basenet\_output\_num</code>()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            <code>get\_batch\_data</code>(\[stage])
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            <code>get\_fuse\_weights</code>()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            <code>get\_privacy\_spent</code>(step\[, orders])
          </td>

          <td>
            Get accountant of dp mechanism.
          </td>
        </tr>

        <tr>
          <td>
            <code>get\_stop\_training</code>()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            <code>init\_data</code>()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            <code>init\_predict</code>(callbacks\[, steps, verbose])
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            <code>init\_training</code>(callbacks\[, epochs, steps, ...])
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            <code>load\_base\_model</code>(base\_model\_path, \*\*kwargs)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            <code>load\_fuse\_model</code>(fuse\_model\_path, \*\*kwargs)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            <code>metrics</code>()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            <code>on\_epoch\_begin</code>(epoch)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            <code>on\_epoch\_end</code>(epoch)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            <code>on\_predict\_batch\_begin</code>(batch)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            <code>on\_predict\_batch\_end</code>(batch)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            <code>on\_predict\_begin</code>()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            <code>on\_predict\_end</code>()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            <code>on\_train\_batch\_begin</code>(\[step])
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            <code>on\_train\_batch\_end</code>(\[step])
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            <code>on\_train\_begin</code>()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            <code>on\_train\_end</code>()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            <code>on\_validation</code>(val\_logs)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            <code>predict</code>(\*hidden\_features)
          </td>

          <td>
            Generates output predictions for the input hidden layer features.
          </td>
        </tr>

        <tr>
          <td>
            <code>reset\_metrics</code>()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            <code>save\_base\_model</code>(base\_model\_path, \*\*kwargs)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            <code>save\_fuse\_model</code>(fuse\_model\_path, \*\*kwargs)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            <code>set\_dataset\_stage</code>(data\_set\[, stage, has\_y, ...])
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            <code>set\_sample\_weight</code>(sample\_weight\[, stage])
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            <code>set\_steps\_per\_epoch</code>(steps\_per\_epoch)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            <code>wrap\_local\_metrics</code>()
          </td>

          <td>

          </td>
        </tr>
      </tbody>
    </table>
  </Outline.Content>
</Outline>

:target{id="module-secretflow.ml.nn.sl.backend.torch.strategy"}

## Module contents
