---
git_download_url: https://github.com/secretflow/secretflow/raw/8cf652dadee6c02cb09a0225efa6d7c6bae31246/docs/source/secretflow.ml.nn.sl.backend.torch.strategy.rst
git_last_modified_commit: null
git_last_modified_time: null
git_origin_url: https://github.com/secretflow/secretflow/blob/8cf652dadee6c02cb09a0225efa6d7c6bae31246/docs/source/secretflow.ml.nn.sl.backend.torch.strategy.rst
git_owner: secretflow
git_repo: secretflow
git_revision_commit: 8cf652dadee6c02cb09a0225efa6d7c6bae31246
git_revision_time: '2024-01-04T11:45:08+08:00'
---

:target{#secretflow-ml-nn-sl-backend-torch-strategy-package}

# secretflow\.ml.nn.sl.backend.torch.strategy package

:target{#submodules}

## Submodules

:target{id="module-secretflow.ml.nn.sl.backend.torch.strategy.split_nn"}

## <Target id="secretflow-ml-nn-sl-backend-torch-strategy-split-nn-module" />secretflow\.ml.nn.sl.backend.torch.strategy.split\_nn module

Async split learning strategy

<strong>Classes:</strong>

<table>
  <tbody>
    <tr>
      <td>
        [`SLTorchModel`](#secretflow.ml.nn.sl.backend.torch.strategy.split_nn.SLTorchModel "secretflow.ml.nn.sl.backend.torch.strategy.split_nn.SLTorchModel")(builder\_base, builder\_fuse, ...)
      </td>

      <td>

      </td>
    </tr>

    <tr>
      <td>
        [`PYUSLTorchModel`](#secretflow.ml.nn.sl.backend.torch.strategy.split_nn.PYUSLTorchModel "secretflow.ml.nn.sl.backend.torch.strategy.split_nn.PYUSLTorchModel")
      </td>

      <td>
        alias of `ActorProxy(PYUSLTorchModel)`
      </td>
    </tr>
  </tbody>
</table>

<Outline domain="py" objectType="class" target={"secretflow.ml.nn.sl.backend.torch.strategy.split_nn.SLTorchModel"} module={"secretflow.ml.nn.sl.backend.torch.strategy.split_nn"} fullname={"SLTorchModel"} parameters={["builder_base", "builder_fuse", "dp_strategy", "random_seed", "args", "kwargs"]} description={"Bases: SLBaseTorchModel"}>
  <Outline.Signature fullname="SLTorchModel" id="secretflow.ml.nn.sl.backend.torch.strategy.split_nn.SLTorchModel">
    <Outline.Keyword>class<span>{" "}</span></Outline.Keyword><Outline.Prefix>secretflow\.ml.nn.sl.backend.torch.strategy.split\_nn.</Outline.Prefix><Outline.Name>SLTorchModel</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">builder\_base</span><span>:</span><span>{" "}</span><span className="name">[Callable](https://docs.python.org/3/library/typing.html#typing.Callable "(in Python v3.12)")<span>\[</span><span>\[</span><span>]</span><span>,</span><span>{" "}</span>[TorchModel](secretflow.ml.ml.nn.mdx#secretflow.ml.nn.utils.TorchModel "secretflow.ml.nn.utils.TorchModel")<span>]</span></span></Outline.Parameter>, <Outline.Parameter><span className="name">builder\_fuse</span><span>:</span><span>{" "}</span><span className="name">[Callable](https://docs.python.org/3/library/typing.html#typing.Callable "(in Python v3.12)")<span>\[</span><span>\[</span><span>]</span><span>,</span><span>{" "}</span>[TorchModel](secretflow.ml.ml.nn.mdx#secretflow.ml.nn.utils.TorchModel "secretflow.ml.nn.utils.TorchModel")<span>]</span></span></Outline.Parameter>, <Outline.Parameter><span className="name">dp\_strategy</span><span>:</span><span>{" "}</span><span className="name">[DPStrategy](secretflow.security.security.privacy.mdx#secretflow.security.privacy.strategy.DPStrategy "secretflow.security.privacy.strategy.DPStrategy")</span></Outline.Parameter>, <Outline.Parameter><span className="name">random\_seed</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.12)")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter>, <Outline.Parameter><span>\*</span><span className="name">args</span></Outline.Parameter>, <Outline.Parameter><span>\*\*</span><span className="name">kwargs</span></Outline.Parameter><span>)</span></Outline.ParameterList>
  </Outline.Signature>

  <Outline.Content>
    Bases: [`SLBaseTorchModel`](secretflow.ml.nn.sl.backend.ml.nn.sl.backend.torch.mdx#secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel "secretflow.ml.nn.sl.backend.torch.sl_base.SLBaseTorchModel")

    <strong>Methods:</strong>

    <table>
      <tbody>
        <tr>
          <td>
            [`base_forward`](#secretflow.ml.nn.sl.backend.torch.strategy.split_nn.SLTorchModel.base_forward "secretflow.ml.nn.sl.backend.torch.strategy.split_nn.SLTorchModel.base_forward")()
          </td>

          <td>
            compute hidden embedding \:param stage: Which stage of the base forward
          </td>
        </tr>

        <tr>
          <td>
            [`base_backward`](#secretflow.ml.nn.sl.backend.torch.strategy.split_nn.SLTorchModel.base_backward "secretflow.ml.nn.sl.backend.torch.strategy.split_nn.SLTorchModel.base_backward")()
          </td>

          <td>
            backward on fusenet
          </td>
        </tr>

        <tr>
          <td>
            [`fuse_net`](#secretflow.ml.nn.sl.backend.torch.strategy.split_nn.SLTorchModel.fuse_net "secretflow.ml.nn.sl.backend.torch.strategy.split_nn.SLTorchModel.fuse_net")(forward\_data\[, \_num\_returns])
          </td>

          <td>
            Fuses the hidden layer and calculates the reverse gradient only on the side with the label
          </td>
        </tr>
      </tbody>
    </table>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.strategy.split_nn.SLTorchModel.base_forward"} module={"secretflow.ml.nn.sl.backend.torch.strategy.split_nn"} fullname={"SLTorchModel.base_forward"} parameters={[]} description={"compute hidden embedding\n:param stage: Which stage of the base forward"}>
      <Outline.Signature fullname="SLTorchModel.base_forward" id="secretflow.ml.nn.sl.backend.torch.strategy.split_nn.SLTorchModel.base_forward">
        <Outline.Name>base\_forward</Outline.Name><Outline.ParameterList><span>(</span><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[ForwardData](secretflow.utils.mdx#secretflow.utils.communicate.ForwardData "secretflow.utils.communicate.ForwardData")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.12)")</Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content>
        compute hidden embedding
        \:param stage: Which stage of the base forward

        Returns: hidden embedding
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.strategy.split_nn.SLTorchModel.base_backward"} module={"secretflow.ml.nn.sl.backend.torch.strategy.split_nn"} fullname={"SLTorchModel.base_backward"} parameters={[]} description={"backward on fusenet"}>
      <Outline.Signature fullname="SLTorchModel.base_backward" id="secretflow.ml.nn.sl.backend.torch.strategy.split_nn.SLTorchModel.base_backward">
        <Outline.Name>base\_backward</Outline.Name><Outline.ParameterList><span>(</span><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content>
        backward on fusenet

        <FieldList>
          <dl>
            <dt className="field-name">
              Parameters
            </dt>

            <dd className="field-body">
              <Outline.ParameterTarget>gradient</Outline.ParameterTarget> – gradient of fusenet hidden layer
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.nn.sl.backend.torch.strategy.split_nn.SLTorchModel.fuse_net"} module={"secretflow.ml.nn.sl.backend.torch.strategy.split_nn"} fullname={"SLTorchModel.fuse_net"} parameters={["forward_data", "_num_returns"]} description={"Fuses the hidden layer and calculates the reverse gradient\nonly on the side with the label"}>
      <Outline.Signature fullname="SLTorchModel.fuse_net" id="secretflow.ml.nn.sl.backend.torch.strategy.split_nn.SLTorchModel.fuse_net">
        <Outline.Name>fuse\_net</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">forward\_data</span><span>:</span><span>{" "}</span><span className="name">[List](https://docs.python.org/3/library/typing.html#typing.List "(in Python v3.12)")<span>\[</span>[ForwardData](secretflow.utils.mdx#secretflow.utils.communicate.ForwardData "secretflow.utils.communicate.ForwardData")<span>]</span><span>{" "}</span><span>|</span><span>{" "}</span>[ForwardData](secretflow.utils.mdx#secretflow.utils.communicate.ForwardData "secretflow.utils.communicate.ForwardData")</span></Outline.Parameter>, <Outline.Parameter><span className="name">\_num\_returns</span><span>=</span><span>2</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content>
        Fuses the hidden layer and calculates the reverse gradient
        only on the side with the label

        <FieldList>
          <dl>
            <dt className="field-name">
              Parameters
            </dt>

            <dd className="field-body">
              <Outline.ParameterTarget>hidden\_features</Outline.ParameterTarget> – A list of hidden layers for each party to compute
            </dd>

            <dt className="field-name">
              Returns
            </dt>

            <dd className="field-body">
              gradient Of hiddens
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>
  </Outline.Content>
</Outline>

<Outline domain="py" objectType="attribute" target={"secretflow.ml.nn.sl.backend.torch.strategy.split_nn.PYUSLTorchModel"} module={"secretflow.ml.nn.sl.backend.torch.strategy.split_nn"} fullname={"PYUSLTorchModel"} description={"alias of ActorProxy(PYUSLTorchModel)\nMethods:"}>
  <Outline.Signature fullname="PYUSLTorchModel" id="secretflow.ml.nn.sl.backend.torch.strategy.split_nn.PYUSLTorchModel">
    <Outline.Prefix>secretflow\.ml.nn.sl.backend.torch.strategy.split\_nn.</Outline.Prefix><Outline.Name>PYUSLTorchModel</Outline.Name>
  </Outline.Signature>

  <Outline.Content>
    alias of `ActorProxy(PYUSLTorchModel)`
    <strong>Methods:</strong>

    <table>
      <tbody>
        <tr>
          <td>
            `__init__`(\*args, \*\*kwargs)
          </td>

          <td>
            Abstraction device object base class.
          </td>
        </tr>

        <tr>
          <td>
            `apply`(func, \*args, \*\*kwargs)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `base_backward`()
          </td>

          <td>
            backward on fusenet
          </td>
        </tr>

        <tr>
          <td>
            `base_forward`()
          </td>

          <td>
            compute hidden embedding \:param stage: Which stage of the base forward
          </td>
        </tr>

        <tr>
          <td>
            `base_forward_internal`(data\_x)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `build_dataset_from_builder`(\*x\[, y, s\_w, ...])
          </td>

          <td>
            build torch.data.Dataset
          </td>
        </tr>

        <tr>
          <td>
            `build_dataset_from_csv`(file\_path\[, label, ...])
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `build_dataset_from_numeric`(\*x\[, y, s\_w, ...])
          </td>

          <td>
            build torch.data.Dataset
          </td>
        </tr>

        <tr>
          <td>
            `evaluate`(forward\_data)
          </td>

          <td>
            Returns the loss value & metrics values for the model in test mode.
          </td>
        </tr>

        <tr>
          <td>
            `export_base_model`(model\_path\[, save\_format])
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `export_fuse_model`(model\_path\[, save\_format])
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `fuse_net`(forward\_data\[, \_num\_returns])
          </td>

          <td>
            Fuses the hidden layer and calculates the reverse gradient only on the side with the label
          </td>
        </tr>

        <tr>
          <td>
            `fuse_net_internal`(hiddens, train\_y, ...)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `get_base_weights`()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `get_basenet_output_num`()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `get_batch_data`(\[stage])
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `get_fuse_weights`()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `get_logs`()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `get_privacy_spent`(step\[, orders])
          </td>

          <td>
            Get accountant of dp mechanism.
          </td>
        </tr>

        <tr>
          <td>
            `get_skip_gradient`()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `get_stop_training`()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `init_data`()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `load_base_model`(base\_model\_path, \*\*kwargs)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `load_fuse_model`(fuse\_model\_path, \*\*kwargs)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `metrics`()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `pack_forward_data`()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `predict`(forward\_data)
          </td>

          <td>
            Generates output predictions for the input hidden layer features.
          </td>
        </tr>

        <tr>
          <td>
            `recover_metric_states`()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `recv_gradient`(gradient)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `reset_data_iter`(stage)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `reset_metrics`()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `save_base_model`(base\_model\_path, \*\*kwargs)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `save_fuse_model`(fuse\_model\_path, \*\*kwargs)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `set_dataset_stage`(data\_set\[, stage, has\_x, ...])
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `set_sample_weight`(sample\_weight\[, stage])
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `set_steps_per_epoch`(steps\_per\_epoch)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `staging_metric_states`()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `unpack_dataset`(data, has\_x, has\_y, has\_s\_w)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `wrap_local_metrics`()
          </td>

          <td>

          </td>
        </tr>
      </tbody>
    </table>

    <strong>Attributes:</strong>

    <table>
      <tbody>
        <tr>
          <td>
            `device`
          </td>

          <td>

          </td>
        </tr>
      </tbody>
    </table>
  </Outline.Content>
</Outline>

:target{id="module-secretflow.ml.nn.sl.backend.torch.strategy"}

## <Target id="module-contents" />Module contents
