:target{#secretflow-ml-linear-ss-glm-package}

# secretflow\.ml.linear.ss\_glm package

:target{#subpackages}

## Subpackages

<TableOfContents>


  - [secretflow.ml.linear.ss\_glm.core package](secretflow.ml.linear.ss_glm.ml.linear.ss_glm.core.mdx)
    - [Submodules](secretflow.ml.linear.ss_glm.ml.linear.ss_glm.core.mdx#submodules)
    - [secretflow.ml.linear.ss\_glm.core.distribution module](secretflow.ml.linear.ss_glm.ml.linear.ss_glm.core.mdx#module-secretflow.ml.linear.ss_glm.core.distribution)
    - [secretflow.ml.linear.ss\_glm.core.link module](secretflow.ml.linear.ss_glm.ml.linear.ss_glm.core.mdx#module-secretflow.ml.linear.ss_glm.core.link)
    - [Module contents](secretflow.ml.linear.ss_glm.ml.linear.ss_glm.core.mdx#module-secretflow.ml.linear.ss_glm.core)
</TableOfContents>

:target{#submodules}

## Submodules

:target{id="module-secretflow.ml.linear.ss_glm.model"}

## secretflow\.ml.linear.ss\_glm.model module

<strong>Classes:</strong>

<table>
  <tbody>
    <tr>
      <td>
        [`SSGLM`](#secretflow.ml.linear.ss_glm.model.SSGLM "secretflow.ml.linear.ss_glm.model.SSGLM")(spu)
      </td>

      <td>

      </td>
    </tr>
  </tbody>
</table>

<strong>Functions:</strong>

<table>
  <tbody>
    <tr>
      <td>
        [`predict_based_on_dot_products`](#secretflow.ml.linear.ss_glm.model.predict_based_on_dot_products "secretflow.ml.linear.ss_glm.model.predict_based_on_dot_products")(dot\_products, ...)
      </td>

      <td>

      </td>
    </tr>

    <tr>
      <td>
        [`slice_x`](#secretflow.ml.linear.ss_glm.model.slice_x "secretflow.ml.linear.ss_glm.model.slice_x")(x, beg, end)
      </td>

      <td>

      </td>
    </tr>
  </tbody>
</table>

<Outline domain="py" objectType="class" target={"secretflow.ml.linear.ss_glm.model.SSGLM"} module={"secretflow.ml.linear.ss_glm.model"} fullname={"SSGLM"} parameters={["spu"]} description={"Bases: object"}>
  <Outline.Signature fullname="SSGLM" id="secretflow.ml.linear.ss_glm.model.SSGLM">
    <Outline.Keyword>class<span>{" "}</span></Outline.Keyword><Outline.Prefix>secretflow\.ml.linear.ss\_glm.model.</Outline.Prefix><Outline.Name>SSGLM</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">spu</span><span>:</span><span>{" "}</span><span className="name">[SPU](secretflow.device.device.device.mdx#secretflow.device.device.spu.SPU "secretflow.device.device.spu.SPU")</span></Outline.Parameter><span>)</span></Outline.ParameterList>
  </Outline.Signature>

  <Outline.Content>
    Bases: [`object`](https://docs.python.org/3/library/functions.html#object "(in Python v3.12)")

    <strong>Methods:</strong>

    <table>
      <tbody>
        <tr>
          <td>
            [`__init__`](#secretflow.ml.linear.ss_glm.model.SSGLM.__init__ "secretflow.ml.linear.ss_glm.model.SSGLM.__init__")(spu)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [`fit_irls`](#secretflow.ml.linear.ss_glm.model.SSGLM.fit_irls "secretflow.ml.linear.ss_glm.model.SSGLM.fit_irls")(x, y, offset, weight, epochs, link, ...)
          </td>

          <td>
            Fit the model by IRLS(Iteratively reweighted least squares).
          </td>
        </tr>

        <tr>
          <td>
            [`fit_sgd`](#secretflow.ml.linear.ss_glm.model.SSGLM.fit_sgd "secretflow.ml.linear.ss_glm.model.SSGLM.fit_sgd")(x, y, offset, weight, epochs, link, dist)
          </td>

          <td>
            Fit the model by SGD(stochastic gradient descent).
          </td>
        </tr>

        <tr>
          <td>
            [`predict`](#secretflow.ml.linear.ss_glm.model.SSGLM.predict "secretflow.ml.linear.ss_glm.model.SSGLM.predict")(x\[, o, to\_pyu])
          </td>

          <td>
            Predict using the model.
          </td>
        </tr>

        <tr>
          <td>
            [`spu_w_to_federated`](#secretflow.ml.linear.ss_glm.model.SSGLM.spu_w_to_federated "secretflow.ml.linear.ss_glm.model.SSGLM.spu_w_to_federated")(federated\_template, ...)
          </td>

          <td>
            spu\_w is our trained model of shape (num\_feature + 1, 1) we are going to split it into federated form.
          </td>
        </tr>

        <tr>
          <td>
            [`predict_fed_w`](#secretflow.ml.linear.ss_glm.model.SSGLM.predict_fed_w "secretflow.ml.linear.ss_glm.model.SSGLM.predict_fed_w")(x, fed\_w, bias\[, o, to\_pyu])
          </td>

          <td>
            Predict using the model in a federated form, suppose all slices collected by to\_pyu device.
          </td>
        </tr>
      </tbody>
    </table>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.ss_glm.model.SSGLM.__init__"} module={"secretflow.ml.linear.ss_glm.model"} fullname={"SSGLM.__init__"} parameters={["spu"]} description={"Bases: object"}>
      <Outline.Signature fullname="SSGLM.__init__" id="secretflow.ml.linear.ss_glm.model.SSGLM.__init__">
        <Outline.Name>\_\_init\_\_</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">spu</span><span>:</span><span>{" "}</span><span className="name">[SPU](secretflow.device.device.device.mdx#secretflow.device.device.spu.SPU "secretflow.device.device.spu.SPU")</span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.12)")</Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.ss_glm.model.SSGLM.fit_irls"} module={"secretflow.ml.linear.ss_glm.model"} fullname={"SSGLM.fit_irls"} parameters={["x", "y", "offset", "weight", "epochs", "link", "dist", "tweedie_power", "scale", "eps"]} description={"Fit the model by IRLS(Iteratively reweighted least squares)."}>
      <Outline.Signature fullname="SSGLM.fit_irls" id="secretflow.ml.linear.ss_glm.model.SSGLM.fit_irls">
        <Outline.Name>fit\_irls</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">x</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.data.ndarray.mdx#secretflow.data.ndarray.ndarray.FedNdarray "secretflow.data.ndarray.ndarray.FedNdarray")<span>{" "}</span><span>|</span><span>{" "}</span>[VDataFrame](secretflow.data.data.vertical.mdx#secretflow.data.vertical.dataframe.VDataFrame "secretflow.data.vertical.dataframe.VDataFrame")</span></Outline.Parameter>, <Outline.Parameter><span className="name">y</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.data.ndarray.mdx#secretflow.data.ndarray.ndarray.FedNdarray "secretflow.data.ndarray.ndarray.FedNdarray")<span>{" "}</span><span>|</span><span>{" "}</span>[VDataFrame](secretflow.data.data.vertical.mdx#secretflow.data.vertical.dataframe.VDataFrame "secretflow.data.vertical.dataframe.VDataFrame")</span></Outline.Parameter>, <Outline.Parameter><span className="name">offset</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.data.ndarray.mdx#secretflow.data.ndarray.ndarray.FedNdarray "secretflow.data.ndarray.ndarray.FedNdarray")<span>{" "}</span><span>|</span><span>{" "}</span>[VDataFrame](secretflow.data.data.vertical.mdx#secretflow.data.vertical.dataframe.VDataFrame "secretflow.data.vertical.dataframe.VDataFrame")</span></Outline.Parameter>, <Outline.Parameter><span className="name">weight</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.data.ndarray.mdx#secretflow.data.ndarray.ndarray.FedNdarray "secretflow.data.ndarray.ndarray.FedNdarray")<span>{" "}</span><span>|</span><span>{" "}</span>[VDataFrame](secretflow.data.data.vertical.mdx#secretflow.data.vertical.dataframe.VDataFrame "secretflow.data.vertical.dataframe.VDataFrame")</span></Outline.Parameter>, <Outline.Parameter><span className="name">epochs</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.12)")</span></Outline.Parameter>, <Outline.Parameter><span className="name">link</span><span>:</span><span>{" "}</span><span className="name">[str](https://docs.python.org/3/library/stdtypes.html#str "(in Python v3.12)")</span></Outline.Parameter>, <Outline.Parameter><span className="name">dist</span><span>:</span><span>{" "}</span><span className="name">[str](https://docs.python.org/3/library/stdtypes.html#str "(in Python v3.12)")</span></Outline.Parameter>, <Outline.Parameter><span className="name">tweedie\_power</span><span>:</span><span>{" "}</span><span className="name">[float](https://docs.python.org/3/library/functions.html#float "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>1</span></Outline.Parameter>, <Outline.Parameter><span className="name">scale</span><span>:</span><span>{" "}</span><span className="name">[float](https://docs.python.org/3/library/functions.html#float "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>1</span></Outline.Parameter>, <Outline.Parameter><span className="name">eps</span><span>:</span><span>{" "}</span><span className="name">[float](https://docs.python.org/3/library/functions.html#float "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>0.0001</span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.12)")</Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content>
        Fit the model by IRLS(Iteratively reweighted least squares).

        <FieldList>
          <dl>
            <dt className="field-name">
              Parameters
            </dt>

            <dd className="field-body">
              - <Outline.ParameterTarget>x</Outline.ParameterTarget> – \{FedNdarray, VDataFrame} of shape (n\_samples, n\_features)
                Training vector, where <cite>n\_samples</cite> is the number of samples and
                <cite>n\_features</cite> is the number of features.
              - <Outline.ParameterTarget>y</Outline.ParameterTarget> – \{FedNdarray, VDataFrame} of shape (n\_samples,)
                Target vector relative to X.
              - <Outline.ParameterTarget>offset</Outline.ParameterTarget> – \{FedNdarray, VDataFrame} of shape (n\_samples,)
                Specify a column to use as the offset, Offsets are per-row “bias values” that are used during model training.
              - <Outline.ParameterTarget>weight</Outline.ParameterTarget> – \{FedNdarray, VDataFrame} of shape (n\_samples,)
                Specify a column to use for the observation weights, which are used for bias correction.
              - <Outline.ParameterTarget>epochs</Outline.ParameterTarget> – int
                iteration rounds.
              - <Outline.ParameterTarget>link</Outline.ParameterTarget> – str
                Specify a link function (Logit, Log, Reciprocal, Indentity)
              - <Outline.ParameterTarget>dist</Outline.ParameterTarget> – str
                Specify a probability distribution (Bernoulli, Poisson, Gamma, Tweedie)
              - <Outline.ParameterTarget>tweedie\_power</Outline.ParameterTarget> –&#x20;

                float
                Tweedie distributions are a family of distributions that include normal, gamma, poisson and their combinations.
                > 0: Specialized as normal
                > 1: Specialized as poisson
                > 2: Specialized as gamma
                > (1,2): combinations of gamma and poisson
              - <Outline.ParameterTarget>scale</Outline.ParameterTarget> – float
                A guess value for distribution’s scale.
              - <Outline.ParameterTarget>learning\_rate</Outline.ParameterTarget> – float, default=0.1
                controls how much to change the model in one epoch.
              - <Outline.ParameterTarget>batch\_size</Outline.ParameterTarget> – int, default=1024
                how many samples use in one calculation.
              - <Outline.ParameterTarget>iter\_start\_irls</Outline.ParameterTarget> – int, default=0
                run a few rounds of irls training as the initialization of w, 0 disable.
              - <Outline.ParameterTarget>eps</Outline.ParameterTarget> – float, default=1e-4
                If the W’s change rate is less than this threshold, the model is considered to be converged, and the training stops early. 0 disable.
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.ss_glm.model.SSGLM.fit_sgd"} module={"secretflow.ml.linear.ss_glm.model"} fullname={"SSGLM.fit_sgd"} parameters={["x", "y", "offset", "weight", "epochs", "link", "dist", "tweedie_power", "scale", "learning_rate", "batch_size", "iter_start_irls", "eps", "decay_epoch", "decay_rate"]} description={"Fit the model by SGD(stochastic gradient descent)."}>
      <Outline.Signature fullname="SSGLM.fit_sgd" id="secretflow.ml.linear.ss_glm.model.SSGLM.fit_sgd">
        <Outline.Name>fit\_sgd</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">x</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.data.ndarray.mdx#secretflow.data.ndarray.ndarray.FedNdarray "secretflow.data.ndarray.ndarray.FedNdarray")<span>{" "}</span><span>|</span><span>{" "}</span>[VDataFrame](secretflow.data.data.vertical.mdx#secretflow.data.vertical.dataframe.VDataFrame "secretflow.data.vertical.dataframe.VDataFrame")</span></Outline.Parameter>, <Outline.Parameter><span className="name">y</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.data.ndarray.mdx#secretflow.data.ndarray.ndarray.FedNdarray "secretflow.data.ndarray.ndarray.FedNdarray")<span>{" "}</span><span>|</span><span>{" "}</span>[VDataFrame](secretflow.data.data.vertical.mdx#secretflow.data.vertical.dataframe.VDataFrame "secretflow.data.vertical.dataframe.VDataFrame")</span></Outline.Parameter>, <Outline.Parameter><span className="name">offset</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.data.ndarray.mdx#secretflow.data.ndarray.ndarray.FedNdarray "secretflow.data.ndarray.ndarray.FedNdarray")<span>{" "}</span><span>|</span><span>{" "}</span>[VDataFrame](secretflow.data.data.vertical.mdx#secretflow.data.vertical.dataframe.VDataFrame "secretflow.data.vertical.dataframe.VDataFrame")</span></Outline.Parameter>, <Outline.Parameter><span className="name">weight</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.data.ndarray.mdx#secretflow.data.ndarray.ndarray.FedNdarray "secretflow.data.ndarray.ndarray.FedNdarray")<span>{" "}</span><span>|</span><span>{" "}</span>[VDataFrame](secretflow.data.data.vertical.mdx#secretflow.data.vertical.dataframe.VDataFrame "secretflow.data.vertical.dataframe.VDataFrame")</span></Outline.Parameter>, <Outline.Parameter><span className="name">epochs</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.12)")</span></Outline.Parameter>, <Outline.Parameter><span className="name">link</span><span>:</span><span>{" "}</span><span className="name">[str](https://docs.python.org/3/library/stdtypes.html#str "(in Python v3.12)")</span></Outline.Parameter>, <Outline.Parameter><span className="name">dist</span><span>:</span><span>{" "}</span><span className="name">[str](https://docs.python.org/3/library/stdtypes.html#str "(in Python v3.12)")</span></Outline.Parameter>, <Outline.Parameter><span className="name">tweedie\_power</span><span>:</span><span>{" "}</span><span className="name">[float](https://docs.python.org/3/library/functions.html#float "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>1</span></Outline.Parameter>, <Outline.Parameter><span className="name">scale</span><span>:</span><span>{" "}</span><span className="name">[float](https://docs.python.org/3/library/functions.html#float "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>1</span></Outline.Parameter>, <Outline.Parameter><span className="name">learning\_rate</span><span>:</span><span>{" "}</span><span className="name">[float](https://docs.python.org/3/library/functions.html#float "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>0.1</span></Outline.Parameter>, <Outline.Parameter><span className="name">batch\_size</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>1024</span></Outline.Parameter>, <Outline.Parameter><span className="name">iter\_start\_irls</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>0</span></Outline.Parameter>, <Outline.Parameter><span className="name">eps</span><span>:</span><span>{" "}</span><span className="name">[float](https://docs.python.org/3/library/functions.html#float "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>0.0001</span></Outline.Parameter>, <Outline.Parameter><span className="name">decay\_epoch</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.12)")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter>, <Outline.Parameter><span className="name">decay\_rate</span><span>:</span><span>{" "}</span><span className="name">[float](https://docs.python.org/3/library/functions.html#float "(in Python v3.12)")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.12)")</Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content>
        Fit the model by SGD(stochastic gradient descent).

        <FieldList>
          <dl>
            <dt className="field-name">
              Parameters
            </dt>

            <dd className="field-body">
              - <Outline.ParameterTarget>x</Outline.ParameterTarget> – \{FedNdarray, VDataFrame} of shape (n\_samples, n\_features)
                Training vector, where <cite>n\_samples</cite> is the number of samples and
                <cite>n\_features</cite> is the number of features.
              - <Outline.ParameterTarget>y</Outline.ParameterTarget> – \{FedNdarray, VDataFrame} of shape (n\_samples,)
                Target vector relative to X.
              - <Outline.ParameterTarget>offset</Outline.ParameterTarget> – \{FedNdarray, VDataFrame} of shape (n\_samples,)
                Specify a column to use as the offset, Offsets are per-row “bias values” that are used during model training.
              - <Outline.ParameterTarget>weight</Outline.ParameterTarget> – \{FedNdarray, VDataFrame} of shape (n\_samples,)
                Specify a column to use for the observation weights, which are used for bias correction.
              - <Outline.ParameterTarget>epochs</Outline.ParameterTarget> – int
                iteration rounds.
              - <Outline.ParameterTarget>link</Outline.ParameterTarget> – str
                Specify a link function (Logit, Log, Reciprocal, Indentity)
              - <Outline.ParameterTarget>dist</Outline.ParameterTarget> – str
                Specify a probability distribution (Bernoulli, Poisson, Gamma, Tweedie)
              - <Outline.ParameterTarget>tweedie\_power</Outline.ParameterTarget> –&#x20;

                float
                Tweedie distributions are a family of distributions that include normal, gamma, poisson and their combinations.
                > 0: Specialized as normal
                > 1: Specialized as poisson
                > 2: Specialized as gamma
                > (1,2): combinations of gamma and poisson
              - <Outline.ParameterTarget>scale</Outline.ParameterTarget> – float
                A guess value for distribution’s scale.
              - <Outline.ParameterTarget>learning\_rate</Outline.ParameterTarget> – float, default=0.1
                controls how much to change the model in one epoch.
              - <Outline.ParameterTarget>batch\_size</Outline.ParameterTarget> – int, default=1024
                how many samples use in one calculation.
              - <Outline.ParameterTarget>iter\_start\_irls</Outline.ParameterTarget> – int, default=0
                run a few rounds of irls training as the initialization of w, 0 disable.
              - <Outline.ParameterTarget>eps</Outline.ParameterTarget> – float, default=1e-4
                If the W’s change rate is less than this threshold, the model is considered to be converged, and the training stops early. 0 disable.
              - <Outline.ParameterTarget>decay\_rate</Outline.ParameterTarget> (<em>decay\_epoch /</em>) – int, default=None
                decay learning rate, learning\_rate \* (decay\_rate \*\* floor(epoch / decay\_epoch)). None disable
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.ss_glm.model.SSGLM.predict"} module={"secretflow.ml.linear.ss_glm.model"} fullname={"SSGLM.predict"} parameters={["x", "o", "to_pyu"]} description={"Predict using the model."}>
      <Outline.Signature fullname="SSGLM.predict" id="secretflow.ml.linear.ss_glm.model.SSGLM.predict">
        <Outline.Name>predict</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">x</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.data.ndarray.mdx#secretflow.data.ndarray.ndarray.FedNdarray "secretflow.data.ndarray.ndarray.FedNdarray")<span>{" "}</span><span>|</span><span>{" "}</span>[VDataFrame](secretflow.data.data.vertical.mdx#secretflow.data.vertical.dataframe.VDataFrame "secretflow.data.vertical.dataframe.VDataFrame")</span></Outline.Parameter>, <Outline.Parameter><span className="name">o</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.data.ndarray.mdx#secretflow.data.ndarray.ndarray.FedNdarray "secretflow.data.ndarray.ndarray.FedNdarray")<span>{" "}</span><span>|</span><span>{" "}</span>[VDataFrame](secretflow.data.data.vertical.mdx#secretflow.data.vertical.dataframe.VDataFrame "secretflow.data.vertical.dataframe.VDataFrame")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter>, <Outline.Parameter><span className="name">to\_pyu</span><span>:</span><span>{" "}</span><span className="name">[PYU](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYU "secretflow.device.device.pyu.PYU")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[SPUObject](secretflow.device.device.device.mdx#secretflow.device.device.spu.SPUObject "secretflow.device.device.spu.SPUObject")<span>{" "}</span><span>|</span><span>{" "}</span>[PYUObject](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYUObject "secretflow.device.device.pyu.PYUObject")</Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content>
        Predict using the model.

        <FieldList>
          <dl>
            <dt className="field-name">
              Parameters
            </dt>

            <dd className="field-body">
              - <Outline.ParameterTarget>x</Outline.ParameterTarget> – \{FedNdarray, VDataFrame} of shape (n\_samples, n\_features)
                Predict samples.
              - <Outline.ParameterTarget>o</Outline.ParameterTarget> – \{FedNdarray, VDataFrame} of shape (n\_samples,)
                Specify a column to use as the offset as per-row “bias values” use in predict
              - <Outline.ParameterTarget>to\_pyu</Outline.ParameterTarget> – the prediction initiator
                if not None predict result is reveal to to\_pyu device and save as FedNdarray
                otherwise, keep predict result in secret and save as SPUObject.
            </dd>

            <dt className="field-name">
              Returns
            </dt>

            <dd className="field-body">
              pred scores in SPUObject, shape (n\_samples,)
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.ss_glm.model.SSGLM.spu_w_to_federated"} module={"secretflow.ml.linear.ss_glm.model"} fullname={"SSGLM.spu_w_to_federated"} parameters={["federated_template", "bias_receiver"]} description={"spu_w is our trained model of shape (num_feature + 1, 1)\nwe are going to split it into federated form."}>
      <Outline.Signature fullname="SSGLM.spu_w_to_federated" id="secretflow.ml.linear.ss_glm.model.SSGLM.spu_w_to_federated">
        <Outline.Name>spu\_w\_to\_federated</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">federated\_template</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.data.ndarray.mdx#secretflow.data.ndarray.ndarray.FedNdarray "secretflow.data.ndarray.ndarray.FedNdarray")<span>{" "}</span><span>|</span><span>{" "}</span>[VDataFrame](secretflow.data.data.vertical.mdx#secretflow.data.vertical.dataframe.VDataFrame "secretflow.data.vertical.dataframe.VDataFrame")</span></Outline.Parameter>, <Outline.Parameter><span className="name">bias\_receiver</span><span>:</span><span>{" "}</span><span className="name">[PYU](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYU "secretflow.device.device.pyu.PYU")</span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[Tuple](https://docs.python.org/3/library/typing.html#typing.Tuple "(in Python v3.12)")<span>\[</span>[FedNdarray](secretflow.data.data.ndarray.mdx#secretflow.data.ndarray.ndarray.FedNdarray "secretflow.data.ndarray.ndarray.FedNdarray")<span>,</span><span>{" "}</span>[PYUObject](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYUObject "secretflow.device.device.pyu.PYUObject")<span>]</span></Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content>
        spu\_w is our trained model of shape (num\_feature + 1, 1)
        we are going to split it into federated form.

        <FieldList>
          <dl>
            <dt className="field-name">
              Parameters
            </dt>

            <dd className="field-body">
              - <Outline.ParameterTarget>federated\_template</Outline.ParameterTarget> – FedNdarray or VDataFrame. Training data or test data X will do. Used as template to split W.
              - <Outline.ParameterTarget>bias\_receiver</Outline.ParameterTarget> – PYU. Specify which party receive the bias term.
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.ss_glm.model.SSGLM.predict_fed_w"} module={"secretflow.ml.linear.ss_glm.model"} fullname={"SSGLM.predict_fed_w"} parameters={["x", "fed_w", "bias", "o", "to_pyu"]} description={"Predict using the model in a federated form, suppose all slices collected by to_pyu device.\nNot MPC prediction."}>
      <Outline.Signature fullname="SSGLM.predict_fed_w" id="secretflow.ml.linear.ss_glm.model.SSGLM.predict_fed_w">
        <Outline.Name>predict\_fed\_w</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">x</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.data.ndarray.mdx#secretflow.data.ndarray.ndarray.FedNdarray "secretflow.data.ndarray.ndarray.FedNdarray")<span>{" "}</span><span>|</span><span>{" "}</span>[VDataFrame](secretflow.data.data.vertical.mdx#secretflow.data.vertical.dataframe.VDataFrame "secretflow.data.vertical.dataframe.VDataFrame")</span></Outline.Parameter>, <Outline.Parameter><span className="name">fed\_w</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.data.ndarray.mdx#secretflow.data.ndarray.ndarray.FedNdarray "secretflow.data.ndarray.ndarray.FedNdarray")</span></Outline.Parameter>, <Outline.Parameter><span className="name">bias</span><span>:</span><span>{" "}</span><span className="name">[PYUObject](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYUObject "secretflow.device.device.pyu.PYUObject")</span></Outline.Parameter>, <Outline.Parameter><span className="name">o</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.data.ndarray.mdx#secretflow.data.ndarray.ndarray.FedNdarray "secretflow.data.ndarray.ndarray.FedNdarray")<span>{" "}</span><span>|</span><span>{" "}</span>[VDataFrame](secretflow.data.data.vertical.mdx#secretflow.data.vertical.dataframe.VDataFrame "secretflow.data.vertical.dataframe.VDataFrame")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter>, <Outline.Parameter><span className="name">to\_pyu</span><span>:</span><span>{" "}</span><span className="name">[PYU](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYU "secretflow.device.device.pyu.PYU")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[PYUObject](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYUObject "secretflow.device.device.pyu.PYUObject")</Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content>
        Predict using the model in a federated form, suppose all slices collected by to\_pyu device.
        Not MPC prediction.

        <FieldList>
          <dl>
            <dt className="field-name">
              Parameters
            </dt>

            <dd className="field-body">
              - <Outline.ParameterTarget>x</Outline.ParameterTarget> – \{FedNdarray, VDataFrame} of shape (n\_samples, n\_features)
                Predict samples.
              - <Outline.ParameterTarget>fed\_w</Outline.ParameterTarget> – FedNdarray. w in a federated form.
              - <Outline.ParameterTarget>bias</Outline.ParameterTarget> – PYUObject. bias term.
              - <Outline.ParameterTarget>o</Outline.ParameterTarget> – \{FedNdarray, VDataFrame} of shape (n\_samples,).
                Specify a column to use as the offset as per-row “bias values” use in predict
              - <Outline.ParameterTarget>to\_pyu</Outline.ParameterTarget> – the prediction initiator.
                if not None predict result is reveal to to\_pyu device and save as FedNdarray
                Default to be bias holder device.
            </dd>

            <dt className="field-name">
              Returns
            </dt>

            <dd className="field-body">
              pred scores in PYUObject, shape (n\_samples,)
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>
  </Outline.Content>
</Outline>

<Outline domain="py" objectType="function" target={"secretflow.ml.linear.ss_glm.model.predict_based_on_dot_products"} module={"secretflow.ml.linear.ss_glm.model"} fullname={"predict_based_on_dot_products"} parameters={["dot_products", "bias", "y_scale", "link"]}>
  <Outline.Signature fullname="predict_based_on_dot_products" id="secretflow.ml.linear.ss_glm.model.predict_based_on_dot_products">
    <Outline.Prefix>secretflow\.ml.linear.ss\_glm.model.</Outline.Prefix><Outline.Name>predict\_based\_on\_dot\_products</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">dot\_products</span><span>:</span><span>{" "}</span><span className="name">[List](https://docs.python.org/3/library/typing.html#typing.List "(in Python v3.12)")<span>\[</span>[ndarray](https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray "(in NumPy v1.26)")<span>]</span></span></Outline.Parameter>, <Outline.Parameter><span className="name">bias</span><span>:</span><span>{" "}</span><span className="name">[float](https://docs.python.org/3/library/functions.html#float "(in Python v3.12)")</span></Outline.Parameter>, <Outline.Parameter><span className="name">y\_scale</span><span>:</span><span>{" "}</span><span className="name">[float](https://docs.python.org/3/library/functions.html#float "(in Python v3.12)")</span></Outline.Parameter>, <Outline.Parameter><span className="name">link</span><span>:</span><span>{" "}</span><span className="name">[Linker](secretflow.ml.linear.ss_glm.ml.linear.ss_glm.core.mdx#secretflow.ml.linear.ss_glm.core.link.Linker "secretflow.ml.linear.ss_glm.core.link.Linker")</span></Outline.Parameter><span>)</span></Outline.ParameterList>
  </Outline.Signature>

  <Outline.Content />
</Outline>

<Outline domain="py" objectType="function" target={"secretflow.ml.linear.ss_glm.model.slice_x"} module={"secretflow.ml.linear.ss_glm.model"} fullname={"slice_x"} parameters={["x", "beg", "end"]}>
  <Outline.Signature fullname="slice_x" id="secretflow.ml.linear.ss_glm.model.slice_x">
    <Outline.Prefix>secretflow\.ml.linear.ss\_glm.model.</Outline.Prefix><Outline.Name>slice\_x</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">x</span></Outline.Parameter>, <Outline.Parameter><span className="name">beg</span></Outline.Parameter>, <Outline.Parameter><span className="name">end</span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[ndarray](https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray "(in NumPy v1.26)")</Outline.ReturnType>
  </Outline.Signature>

  <Outline.Content />
</Outline>

:target{id="module-secretflow.ml.linear.ss_glm"}

## Module contents

<strong>Classes:</strong>

<table>
  <tbody>
    <tr>
      <td>
        [`SSGLM`](#secretflow.ml.linear.ss_glm.SSGLM "secretflow.ml.linear.ss_glm.SSGLM")(spu)
      </td>

      <td>

      </td>
    </tr>
  </tbody>
</table>

<Outline domain="py" objectType="class" target={"secretflow.ml.linear.ss_glm.SSGLM"} module={"secretflow.ml.linear.ss_glm"} fullname={"SSGLM"} parameters={["spu"]} description={"Bases: object"}>
  <Outline.Signature fullname="SSGLM" id="secretflow.ml.linear.ss_glm.SSGLM">
    <Outline.Keyword>class<span>{" "}</span></Outline.Keyword><Outline.Prefix>secretflow\.ml.linear.ss\_glm.</Outline.Prefix><Outline.Name>SSGLM</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">spu</span><span>:</span><span>{" "}</span><span className="name">[SPU](secretflow.device.device.device.mdx#secretflow.device.device.spu.SPU "secretflow.device.device.spu.SPU")</span></Outline.Parameter><span>)</span></Outline.ParameterList>
  </Outline.Signature>

  <Outline.Content>
    Bases: [`object`](https://docs.python.org/3/library/functions.html#object "(in Python v3.12)")

    <strong>Methods:</strong>

    <table>
      <tbody>
        <tr>
          <td>
            [`__init__`](#secretflow.ml.linear.ss_glm.SSGLM.__init__ "secretflow.ml.linear.ss_glm.SSGLM.__init__")(spu)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [`fit_irls`](#secretflow.ml.linear.ss_glm.SSGLM.fit_irls "secretflow.ml.linear.ss_glm.SSGLM.fit_irls")(x, y, offset, weight, epochs, link, ...)
          </td>

          <td>
            Fit the model by IRLS(Iteratively reweighted least squares).
          </td>
        </tr>

        <tr>
          <td>
            [`fit_sgd`](#secretflow.ml.linear.ss_glm.SSGLM.fit_sgd "secretflow.ml.linear.ss_glm.SSGLM.fit_sgd")(x, y, offset, weight, epochs, link, dist)
          </td>

          <td>
            Fit the model by SGD(stochastic gradient descent).
          </td>
        </tr>

        <tr>
          <td>
            [`predict`](#secretflow.ml.linear.ss_glm.SSGLM.predict "secretflow.ml.linear.ss_glm.SSGLM.predict")(x\[, o, to\_pyu])
          </td>

          <td>
            Predict using the model.
          </td>
        </tr>

        <tr>
          <td>
            [`spu_w_to_federated`](#secretflow.ml.linear.ss_glm.SSGLM.spu_w_to_federated "secretflow.ml.linear.ss_glm.SSGLM.spu_w_to_federated")(federated\_template, ...)
          </td>

          <td>
            spu\_w is our trained model of shape (num\_feature + 1, 1) we are going to split it into federated form.
          </td>
        </tr>

        <tr>
          <td>
            [`predict_fed_w`](#secretflow.ml.linear.ss_glm.SSGLM.predict_fed_w "secretflow.ml.linear.ss_glm.SSGLM.predict_fed_w")(x, fed\_w, bias\[, o, to\_pyu])
          </td>

          <td>
            Predict using the model in a federated form, suppose all slices collected by to\_pyu device.
          </td>
        </tr>
      </tbody>
    </table>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.ss_glm.SSGLM.__init__"} module={"secretflow.ml.linear.ss_glm"} fullname={"SSGLM.__init__"} parameters={["spu"]} description={"Bases: object"}>
      <Outline.Signature fullname="SSGLM.__init__" id="secretflow.ml.linear.ss_glm.SSGLM.__init__">
        <Outline.Name>\_\_init\_\_</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">spu</span><span>:</span><span>{" "}</span><span className="name">[SPU](secretflow.device.device.device.mdx#secretflow.device.device.spu.SPU "secretflow.device.device.spu.SPU")</span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.12)")</Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.ss_glm.SSGLM.fit_irls"} module={"secretflow.ml.linear.ss_glm"} fullname={"SSGLM.fit_irls"} parameters={["x", "y", "offset", "weight", "epochs", "link", "dist", "tweedie_power", "scale", "eps"]} description={"Fit the model by IRLS(Iteratively reweighted least squares)."}>
      <Outline.Signature fullname="SSGLM.fit_irls" id="secretflow.ml.linear.ss_glm.SSGLM.fit_irls">
        <Outline.Name>fit\_irls</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">x</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.data.ndarray.mdx#secretflow.data.ndarray.ndarray.FedNdarray "secretflow.data.ndarray.ndarray.FedNdarray")<span>{" "}</span><span>|</span><span>{" "}</span>[VDataFrame](secretflow.data.data.vertical.mdx#secretflow.data.vertical.dataframe.VDataFrame "secretflow.data.vertical.dataframe.VDataFrame")</span></Outline.Parameter>, <Outline.Parameter><span className="name">y</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.data.ndarray.mdx#secretflow.data.ndarray.ndarray.FedNdarray "secretflow.data.ndarray.ndarray.FedNdarray")<span>{" "}</span><span>|</span><span>{" "}</span>[VDataFrame](secretflow.data.data.vertical.mdx#secretflow.data.vertical.dataframe.VDataFrame "secretflow.data.vertical.dataframe.VDataFrame")</span></Outline.Parameter>, <Outline.Parameter><span className="name">offset</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.data.ndarray.mdx#secretflow.data.ndarray.ndarray.FedNdarray "secretflow.data.ndarray.ndarray.FedNdarray")<span>{" "}</span><span>|</span><span>{" "}</span>[VDataFrame](secretflow.data.data.vertical.mdx#secretflow.data.vertical.dataframe.VDataFrame "secretflow.data.vertical.dataframe.VDataFrame")</span></Outline.Parameter>, <Outline.Parameter><span className="name">weight</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.data.ndarray.mdx#secretflow.data.ndarray.ndarray.FedNdarray "secretflow.data.ndarray.ndarray.FedNdarray")<span>{" "}</span><span>|</span><span>{" "}</span>[VDataFrame](secretflow.data.data.vertical.mdx#secretflow.data.vertical.dataframe.VDataFrame "secretflow.data.vertical.dataframe.VDataFrame")</span></Outline.Parameter>, <Outline.Parameter><span className="name">epochs</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.12)")</span></Outline.Parameter>, <Outline.Parameter><span className="name">link</span><span>:</span><span>{" "}</span><span className="name">[str](https://docs.python.org/3/library/stdtypes.html#str "(in Python v3.12)")</span></Outline.Parameter>, <Outline.Parameter><span className="name">dist</span><span>:</span><span>{" "}</span><span className="name">[str](https://docs.python.org/3/library/stdtypes.html#str "(in Python v3.12)")</span></Outline.Parameter>, <Outline.Parameter><span className="name">tweedie\_power</span><span>:</span><span>{" "}</span><span className="name">[float](https://docs.python.org/3/library/functions.html#float "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>1</span></Outline.Parameter>, <Outline.Parameter><span className="name">scale</span><span>:</span><span>{" "}</span><span className="name">[float](https://docs.python.org/3/library/functions.html#float "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>1</span></Outline.Parameter>, <Outline.Parameter><span className="name">eps</span><span>:</span><span>{" "}</span><span className="name">[float](https://docs.python.org/3/library/functions.html#float "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>0.0001</span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.12)")</Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content>
        Fit the model by IRLS(Iteratively reweighted least squares).

        <FieldList>
          <dl>
            <dt className="field-name">
              Parameters
            </dt>

            <dd className="field-body">
              - <Outline.ParameterTarget>x</Outline.ParameterTarget> – \{FedNdarray, VDataFrame} of shape (n\_samples, n\_features)
                Training vector, where <cite>n\_samples</cite> is the number of samples and
                <cite>n\_features</cite> is the number of features.
              - <Outline.ParameterTarget>y</Outline.ParameterTarget> – \{FedNdarray, VDataFrame} of shape (n\_samples,)
                Target vector relative to X.
              - <Outline.ParameterTarget>offset</Outline.ParameterTarget> – \{FedNdarray, VDataFrame} of shape (n\_samples,)
                Specify a column to use as the offset, Offsets are per-row “bias values” that are used during model training.
              - <Outline.ParameterTarget>weight</Outline.ParameterTarget> – \{FedNdarray, VDataFrame} of shape (n\_samples,)
                Specify a column to use for the observation weights, which are used for bias correction.
              - <Outline.ParameterTarget>epochs</Outline.ParameterTarget> – int
                iteration rounds.
              - <Outline.ParameterTarget>link</Outline.ParameterTarget> – str
                Specify a link function (Logit, Log, Reciprocal, Indentity)
              - <Outline.ParameterTarget>dist</Outline.ParameterTarget> – str
                Specify a probability distribution (Bernoulli, Poisson, Gamma, Tweedie)
              - <Outline.ParameterTarget>tweedie\_power</Outline.ParameterTarget> –&#x20;

                float
                Tweedie distributions are a family of distributions that include normal, gamma, poisson and their combinations.
                > 0: Specialized as normal
                > 1: Specialized as poisson
                > 2: Specialized as gamma
                > (1,2): combinations of gamma and poisson
              - <Outline.ParameterTarget>scale</Outline.ParameterTarget> – float
                A guess value for distribution’s scale.
              - <Outline.ParameterTarget>learning\_rate</Outline.ParameterTarget> – float, default=0.1
                controls how much to change the model in one epoch.
              - <Outline.ParameterTarget>batch\_size</Outline.ParameterTarget> – int, default=1024
                how many samples use in one calculation.
              - <Outline.ParameterTarget>iter\_start\_irls</Outline.ParameterTarget> – int, default=0
                run a few rounds of irls training as the initialization of w, 0 disable.
              - <Outline.ParameterTarget>eps</Outline.ParameterTarget> – float, default=1e-4
                If the W’s change rate is less than this threshold, the model is considered to be converged, and the training stops early. 0 disable.
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.ss_glm.SSGLM.fit_sgd"} module={"secretflow.ml.linear.ss_glm"} fullname={"SSGLM.fit_sgd"} parameters={["x", "y", "offset", "weight", "epochs", "link", "dist", "tweedie_power", "scale", "learning_rate", "batch_size", "iter_start_irls", "eps", "decay_epoch", "decay_rate"]} description={"Fit the model by SGD(stochastic gradient descent)."}>
      <Outline.Signature fullname="SSGLM.fit_sgd" id="secretflow.ml.linear.ss_glm.SSGLM.fit_sgd">
        <Outline.Name>fit\_sgd</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">x</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.data.ndarray.mdx#secretflow.data.ndarray.ndarray.FedNdarray "secretflow.data.ndarray.ndarray.FedNdarray")<span>{" "}</span><span>|</span><span>{" "}</span>[VDataFrame](secretflow.data.data.vertical.mdx#secretflow.data.vertical.dataframe.VDataFrame "secretflow.data.vertical.dataframe.VDataFrame")</span></Outline.Parameter>, <Outline.Parameter><span className="name">y</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.data.ndarray.mdx#secretflow.data.ndarray.ndarray.FedNdarray "secretflow.data.ndarray.ndarray.FedNdarray")<span>{" "}</span><span>|</span><span>{" "}</span>[VDataFrame](secretflow.data.data.vertical.mdx#secretflow.data.vertical.dataframe.VDataFrame "secretflow.data.vertical.dataframe.VDataFrame")</span></Outline.Parameter>, <Outline.Parameter><span className="name">offset</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.data.ndarray.mdx#secretflow.data.ndarray.ndarray.FedNdarray "secretflow.data.ndarray.ndarray.FedNdarray")<span>{" "}</span><span>|</span><span>{" "}</span>[VDataFrame](secretflow.data.data.vertical.mdx#secretflow.data.vertical.dataframe.VDataFrame "secretflow.data.vertical.dataframe.VDataFrame")</span></Outline.Parameter>, <Outline.Parameter><span className="name">weight</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.data.ndarray.mdx#secretflow.data.ndarray.ndarray.FedNdarray "secretflow.data.ndarray.ndarray.FedNdarray")<span>{" "}</span><span>|</span><span>{" "}</span>[VDataFrame](secretflow.data.data.vertical.mdx#secretflow.data.vertical.dataframe.VDataFrame "secretflow.data.vertical.dataframe.VDataFrame")</span></Outline.Parameter>, <Outline.Parameter><span className="name">epochs</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.12)")</span></Outline.Parameter>, <Outline.Parameter><span className="name">link</span><span>:</span><span>{" "}</span><span className="name">[str](https://docs.python.org/3/library/stdtypes.html#str "(in Python v3.12)")</span></Outline.Parameter>, <Outline.Parameter><span className="name">dist</span><span>:</span><span>{" "}</span><span className="name">[str](https://docs.python.org/3/library/stdtypes.html#str "(in Python v3.12)")</span></Outline.Parameter>, <Outline.Parameter><span className="name">tweedie\_power</span><span>:</span><span>{" "}</span><span className="name">[float](https://docs.python.org/3/library/functions.html#float "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>1</span></Outline.Parameter>, <Outline.Parameter><span className="name">scale</span><span>:</span><span>{" "}</span><span className="name">[float](https://docs.python.org/3/library/functions.html#float "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>1</span></Outline.Parameter>, <Outline.Parameter><span className="name">learning\_rate</span><span>:</span><span>{" "}</span><span className="name">[float](https://docs.python.org/3/library/functions.html#float "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>0.1</span></Outline.Parameter>, <Outline.Parameter><span className="name">batch\_size</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>1024</span></Outline.Parameter>, <Outline.Parameter><span className="name">iter\_start\_irls</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>0</span></Outline.Parameter>, <Outline.Parameter><span className="name">eps</span><span>:</span><span>{" "}</span><span className="name">[float](https://docs.python.org/3/library/functions.html#float "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>0.0001</span></Outline.Parameter>, <Outline.Parameter><span className="name">decay\_epoch</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.12)")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter>, <Outline.Parameter><span className="name">decay\_rate</span><span>:</span><span>{" "}</span><span className="name">[float](https://docs.python.org/3/library/functions.html#float "(in Python v3.12)")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.12)")</Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content>
        Fit the model by SGD(stochastic gradient descent).

        <FieldList>
          <dl>
            <dt className="field-name">
              Parameters
            </dt>

            <dd className="field-body">
              - <Outline.ParameterTarget>x</Outline.ParameterTarget> – \{FedNdarray, VDataFrame} of shape (n\_samples, n\_features)
                Training vector, where <cite>n\_samples</cite> is the number of samples and
                <cite>n\_features</cite> is the number of features.
              - <Outline.ParameterTarget>y</Outline.ParameterTarget> – \{FedNdarray, VDataFrame} of shape (n\_samples,)
                Target vector relative to X.
              - <Outline.ParameterTarget>offset</Outline.ParameterTarget> – \{FedNdarray, VDataFrame} of shape (n\_samples,)
                Specify a column to use as the offset, Offsets are per-row “bias values” that are used during model training.
              - <Outline.ParameterTarget>weight</Outline.ParameterTarget> – \{FedNdarray, VDataFrame} of shape (n\_samples,)
                Specify a column to use for the observation weights, which are used for bias correction.
              - <Outline.ParameterTarget>epochs</Outline.ParameterTarget> – int
                iteration rounds.
              - <Outline.ParameterTarget>link</Outline.ParameterTarget> – str
                Specify a link function (Logit, Log, Reciprocal, Indentity)
              - <Outline.ParameterTarget>dist</Outline.ParameterTarget> – str
                Specify a probability distribution (Bernoulli, Poisson, Gamma, Tweedie)
              - <Outline.ParameterTarget>tweedie\_power</Outline.ParameterTarget> –&#x20;

                float
                Tweedie distributions are a family of distributions that include normal, gamma, poisson and their combinations.
                > 0: Specialized as normal
                > 1: Specialized as poisson
                > 2: Specialized as gamma
                > (1,2): combinations of gamma and poisson
              - <Outline.ParameterTarget>scale</Outline.ParameterTarget> – float
                A guess value for distribution’s scale.
              - <Outline.ParameterTarget>learning\_rate</Outline.ParameterTarget> – float, default=0.1
                controls how much to change the model in one epoch.
              - <Outline.ParameterTarget>batch\_size</Outline.ParameterTarget> – int, default=1024
                how many samples use in one calculation.
              - <Outline.ParameterTarget>iter\_start\_irls</Outline.ParameterTarget> – int, default=0
                run a few rounds of irls training as the initialization of w, 0 disable.
              - <Outline.ParameterTarget>eps</Outline.ParameterTarget> – float, default=1e-4
                If the W’s change rate is less than this threshold, the model is considered to be converged, and the training stops early. 0 disable.
              - <Outline.ParameterTarget>decay\_rate</Outline.ParameterTarget> (<em>decay\_epoch /</em>) – int, default=None
                decay learning rate, learning\_rate \* (decay\_rate \*\* floor(epoch / decay\_epoch)). None disable
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.ss_glm.SSGLM.predict"} module={"secretflow.ml.linear.ss_glm"} fullname={"SSGLM.predict"} parameters={["x", "o", "to_pyu"]} description={"Predict using the model."}>
      <Outline.Signature fullname="SSGLM.predict" id="secretflow.ml.linear.ss_glm.SSGLM.predict">
        <Outline.Name>predict</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">x</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.data.ndarray.mdx#secretflow.data.ndarray.ndarray.FedNdarray "secretflow.data.ndarray.ndarray.FedNdarray")<span>{" "}</span><span>|</span><span>{" "}</span>[VDataFrame](secretflow.data.data.vertical.mdx#secretflow.data.vertical.dataframe.VDataFrame "secretflow.data.vertical.dataframe.VDataFrame")</span></Outline.Parameter>, <Outline.Parameter><span className="name">o</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.data.ndarray.mdx#secretflow.data.ndarray.ndarray.FedNdarray "secretflow.data.ndarray.ndarray.FedNdarray")<span>{" "}</span><span>|</span><span>{" "}</span>[VDataFrame](secretflow.data.data.vertical.mdx#secretflow.data.vertical.dataframe.VDataFrame "secretflow.data.vertical.dataframe.VDataFrame")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter>, <Outline.Parameter><span className="name">to\_pyu</span><span>:</span><span>{" "}</span><span className="name">[PYU](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYU "secretflow.device.device.pyu.PYU")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[SPUObject](secretflow.device.device.device.mdx#secretflow.device.device.spu.SPUObject "secretflow.device.device.spu.SPUObject")<span>{" "}</span><span>|</span><span>{" "}</span>[PYUObject](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYUObject "secretflow.device.device.pyu.PYUObject")</Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content>
        Predict using the model.

        <FieldList>
          <dl>
            <dt className="field-name">
              Parameters
            </dt>

            <dd className="field-body">
              - <Outline.ParameterTarget>x</Outline.ParameterTarget> – \{FedNdarray, VDataFrame} of shape (n\_samples, n\_features)
                Predict samples.
              - <Outline.ParameterTarget>o</Outline.ParameterTarget> – \{FedNdarray, VDataFrame} of shape (n\_samples,)
                Specify a column to use as the offset as per-row “bias values” use in predict
              - <Outline.ParameterTarget>to\_pyu</Outline.ParameterTarget> – the prediction initiator
                if not None predict result is reveal to to\_pyu device and save as FedNdarray
                otherwise, keep predict result in secret and save as SPUObject.
            </dd>

            <dt className="field-name">
              Returns
            </dt>

            <dd className="field-body">
              pred scores in SPUObject, shape (n\_samples,)
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.ss_glm.SSGLM.spu_w_to_federated"} module={"secretflow.ml.linear.ss_glm"} fullname={"SSGLM.spu_w_to_federated"} parameters={["federated_template", "bias_receiver"]} description={"spu_w is our trained model of shape (num_feature + 1, 1)\nwe are going to split it into federated form."}>
      <Outline.Signature fullname="SSGLM.spu_w_to_federated" id="secretflow.ml.linear.ss_glm.SSGLM.spu_w_to_federated">
        <Outline.Name>spu\_w\_to\_federated</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">federated\_template</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.data.ndarray.mdx#secretflow.data.ndarray.ndarray.FedNdarray "secretflow.data.ndarray.ndarray.FedNdarray")<span>{" "}</span><span>|</span><span>{" "}</span>[VDataFrame](secretflow.data.data.vertical.mdx#secretflow.data.vertical.dataframe.VDataFrame "secretflow.data.vertical.dataframe.VDataFrame")</span></Outline.Parameter>, <Outline.Parameter><span className="name">bias\_receiver</span><span>:</span><span>{" "}</span><span className="name">[PYU](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYU "secretflow.device.device.pyu.PYU")</span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[Tuple](https://docs.python.org/3/library/typing.html#typing.Tuple "(in Python v3.12)")<span>\[</span>[FedNdarray](secretflow.data.data.ndarray.mdx#secretflow.data.ndarray.ndarray.FedNdarray "secretflow.data.ndarray.ndarray.FedNdarray")<span>,</span><span>{" "}</span>[PYUObject](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYUObject "secretflow.device.device.pyu.PYUObject")<span>]</span></Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content>
        spu\_w is our trained model of shape (num\_feature + 1, 1)
        we are going to split it into federated form.

        <FieldList>
          <dl>
            <dt className="field-name">
              Parameters
            </dt>

            <dd className="field-body">
              - <Outline.ParameterTarget>federated\_template</Outline.ParameterTarget> – FedNdarray or VDataFrame. Training data or test data X will do. Used as template to split W.
              - <Outline.ParameterTarget>bias\_receiver</Outline.ParameterTarget> – PYU. Specify which party receive the bias term.
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.ss_glm.SSGLM.predict_fed_w"} module={"secretflow.ml.linear.ss_glm"} fullname={"SSGLM.predict_fed_w"} parameters={["x", "fed_w", "bias", "o", "to_pyu"]} description={"Predict using the model in a federated form, suppose all slices collected by to_pyu device.\nNot MPC prediction."}>
      <Outline.Signature fullname="SSGLM.predict_fed_w" id="secretflow.ml.linear.ss_glm.SSGLM.predict_fed_w">
        <Outline.Name>predict\_fed\_w</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">x</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.data.ndarray.mdx#secretflow.data.ndarray.ndarray.FedNdarray "secretflow.data.ndarray.ndarray.FedNdarray")<span>{" "}</span><span>|</span><span>{" "}</span>[VDataFrame](secretflow.data.data.vertical.mdx#secretflow.data.vertical.dataframe.VDataFrame "secretflow.data.vertical.dataframe.VDataFrame")</span></Outline.Parameter>, <Outline.Parameter><span className="name">fed\_w</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.data.ndarray.mdx#secretflow.data.ndarray.ndarray.FedNdarray "secretflow.data.ndarray.ndarray.FedNdarray")</span></Outline.Parameter>, <Outline.Parameter><span className="name">bias</span><span>:</span><span>{" "}</span><span className="name">[PYUObject](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYUObject "secretflow.device.device.pyu.PYUObject")</span></Outline.Parameter>, <Outline.Parameter><span className="name">o</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.data.ndarray.mdx#secretflow.data.ndarray.ndarray.FedNdarray "secretflow.data.ndarray.ndarray.FedNdarray")<span>{" "}</span><span>|</span><span>{" "}</span>[VDataFrame](secretflow.data.data.vertical.mdx#secretflow.data.vertical.dataframe.VDataFrame "secretflow.data.vertical.dataframe.VDataFrame")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter>, <Outline.Parameter><span className="name">to\_pyu</span><span>:</span><span>{" "}</span><span className="name">[PYU](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYU "secretflow.device.device.pyu.PYU")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.12)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[PYUObject](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYUObject "secretflow.device.device.pyu.PYUObject")</Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content>
        Predict using the model in a federated form, suppose all slices collected by to\_pyu device.
        Not MPC prediction.

        <FieldList>
          <dl>
            <dt className="field-name">
              Parameters
            </dt>

            <dd className="field-body">
              - <Outline.ParameterTarget>x</Outline.ParameterTarget> – \{FedNdarray, VDataFrame} of shape (n\_samples, n\_features)
                Predict samples.
              - <Outline.ParameterTarget>fed\_w</Outline.ParameterTarget> – FedNdarray. w in a federated form.
              - <Outline.ParameterTarget>bias</Outline.ParameterTarget> – PYUObject. bias term.
              - <Outline.ParameterTarget>o</Outline.ParameterTarget> – \{FedNdarray, VDataFrame} of shape (n\_samples,).
                Specify a column to use as the offset as per-row “bias values” use in predict
              - <Outline.ParameterTarget>to\_pyu</Outline.ParameterTarget> – the prediction initiator.
                if not None predict result is reveal to to\_pyu device and save as FedNdarray
                Default to be bias holder device.
            </dd>

            <dt className="field-name">
              Returns
            </dt>

            <dd className="field-body">
              pred scores in PYUObject, shape (n\_samples,)
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>
  </Outline.Content>
</Outline>
