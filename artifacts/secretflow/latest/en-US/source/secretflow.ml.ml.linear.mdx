:target{#secretflow-ml-linear-package}

# secretflow\.ml.linear package

:target{#subpackages}

## Subpackages

<TableOfContents>


  - [secretflow.ml.linear.hess\_sgd package](secretflow.ml.linear.ml.linear.hess_sgd.mdx)
    - [Submodules](secretflow.ml.linear.ml.linear.hess_sgd.mdx#submodules)
    - [secretflow.ml.linear.hess\_sgd.model module](secretflow.ml.linear.ml.linear.hess_sgd.mdx#module-secretflow.ml.linear.hess_sgd.model)
    - [Module contents](secretflow.ml.linear.ml.linear.hess_sgd.mdx#module-secretflow.ml.linear.hess_sgd)
  - [secretflow.ml.linear.ss\_glm package](secretflow.ml.linear.ml.linear.ss_glm.mdx)
    - [Subpackages](secretflow.ml.linear.ml.linear.ss_glm.mdx#subpackages)
    - [Submodules](secretflow.ml.linear.ml.linear.ss_glm.mdx#submodules)
    - [secretflow.ml.linear.ss\_glm.model module](secretflow.ml.linear.ml.linear.ss_glm.mdx#module-secretflow.ml.linear.ss_glm.model)
    - [Module contents](secretflow.ml.linear.ml.linear.ss_glm.mdx#module-secretflow.ml.linear.ss_glm)
  - [secretflow.ml.linear.ss\_sgd package](secretflow.ml.linear.ml.linear.ss_sgd.mdx)
    - [Submodules](secretflow.ml.linear.ml.linear.ss_sgd.mdx#submodules)
    - [secretflow.ml.linear.ss\_sgd.model module](secretflow.ml.linear.ml.linear.ss_sgd.mdx#module-secretflow.ml.linear.ss_sgd.model)
    - [Module contents](secretflow.ml.linear.ml.linear.ss_sgd.mdx#module-secretflow.ml.linear.ss_sgd)
</TableOfContents>

:target{#submodules}

## Submodules

:target{id="module-secretflow.ml.linear.fl_lr_mix"}

## secretflow\.ml.linear.fl\_lr\_mix module

<strong>Classes:</strong>

<table>
  <tbody>
    <tr>
      <td>
        [`FlLogisticRegressionMix`](#secretflow.ml.linear.fl_lr_mix.FlLogisticRegressionMix "secretflow.ml.linear.fl_lr_mix.FlLogisticRegressionMix")()
      </td>

      <td>
        SGD based logistic regression for mix partitioned data.
      </td>
    </tr>
  </tbody>
</table>

<Outline domain="py" objectType="class" target={"secretflow.ml.linear.fl_lr_mix.FlLogisticRegressionMix"} module={"secretflow.ml.linear.fl_lr_mix"} fullname={"FlLogisticRegressionMix"} description={"Bases: object"}>
  <Outline.Signature fullname="FlLogisticRegressionMix" id="secretflow.ml.linear.fl_lr_mix.FlLogisticRegressionMix">
    <Outline.Keyword>class<span>{" "}</span></Outline.Keyword><Outline.Prefix>secretflow\.ml.linear.fl\_lr\_mix.</Outline.Prefix><Outline.Name>FlLogisticRegressionMix</Outline.Name>
  </Outline.Signature>

  <Outline.Content>
    Bases: [`object`](https://docs.python.org/3/library/functions.html#object "(in Python v3.11)")

    SGD based logistic regression for mix partitioned data.

    The following is an example to illustrate the algorithm.

    Suppose alice has features and label,  while bob/carol/dave have features
    only.

    The perspective of MixDataFrame X is as follows:

    <table>
      <tbody>
        <tr>
          <td colSpan={4}>
            X
          </td>
        </tr>

        <tr>
          <td>
            VDataFrame\_0
          </td>

          <td>
            alice\_x0
          </td>

          <td>
            bob\_x
          </td>

          <td>
            dave\_x0
          </td>
        </tr>

        <tr>
          <td>
            VDataFrame\_1
          </td>

          <td>
            alice\_x1
          </td>

          <td>
            carol\_x
          </td>

          <td>
            dave\_x1
          </td>
        </tr>
      </tbody>
    </table>

    The perspective of MixDataFrame Y is as follows:

    <table>
      <tbody>
        <tr>
          <td colSpan={2}>
            Y
          </td>
        </tr>

        <tr>
          <td>
            VDataFrame\_0
          </td>

          <td>
            alice\_y0
          </td>
        </tr>

        <tr>
          <td>
            VDataFrame\_1
          </td>

          <td>
            alice\_y1
          </td>
        </tr>
      </tbody>
    </table>

    When fitted with the X and Y, two
    [`FlLogisticRegressionVertical`](#secretflow.ml.linear.FlLogisticRegressionVertical "secretflow.ml.linear.FlLogisticRegressionVertical") instances
    are constructed. The first one will be fitted with VDataFrame\_0 of X and Y,
    while the second one will be fitted with  VDataFrame\_1 of X and Y,.

    The main steps of one epoch are:

    1. The <cite>FlLogisticRegressionVertical</cite> are fitted with the <cite>VDataFrame</cite> of X
       and Y respectly.
    2. Aggregate <InlineMath>${\theta}$</InlineMath> of the <cite>FlLogisticRegressionVertical</cite> with
       [`SecureAggregator`](secretflow.security.security.aggregation.mdx#secretflow.security.aggregation.SecureAggregator "secretflow.security.aggregation.SecureAggregator").
    3. Send aggregated <InlineMath>${\theta}$</InlineMath> to the <cite>FlLogisticRegressionVertical</cite>.

    <strong>Methods:</strong>

    <table>
      <tbody>
        <tr>
          <td>
            [`fit`](#secretflow.ml.linear.fl_lr_mix.FlLogisticRegressionMix.fit "secretflow.ml.linear.fl_lr_mix.FlLogisticRegressionMix.fit")(x, y, batch\_size, epochs, aggregators, heus)
          </td>

          <td>
            Fit the model.
          </td>
        </tr>

        <tr>
          <td>
            [`predict`](#secretflow.ml.linear.fl_lr_mix.FlLogisticRegressionMix.predict "secretflow.ml.linear.fl_lr_mix.FlLogisticRegressionMix.predict")(x)
          </td>

          <td>
            Predict the score.
          </td>
        </tr>
      </tbody>
    </table>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.fl_lr_mix.FlLogisticRegressionMix.fit"} module={"secretflow.ml.linear.fl_lr_mix"} fullname={"FlLogisticRegressionMix.fit"} description={"Fit the model."} parameters={["x", "y", "batch_size", "epochs", "aggregators", "heus", "fxp_bits", "tol", "learning_rate", "agg_epochs", "audit_log_dir", "aggr_hooks"]}>
      <Outline.Signature fullname="FlLogisticRegressionMix.fit" id="secretflow.ml.linear.fl_lr_mix.FlLogisticRegressionMix.fit">
        <Outline.Name>fit</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">x</span><span>:</span><span>{" "}</span><span className="name">[MixDataFrame](secretflow.data.data.mix.mdx#secretflow.data.mix.dataframe.MixDataFrame "secretflow.data.mix.dataframe.MixDataFrame")</span></Outline.Parameter>, <Outline.Parameter><span className="name">y</span><span>:</span><span>{" "}</span><span className="name">[MixDataFrame](secretflow.data.data.mix.mdx#secretflow.data.mix.dataframe.MixDataFrame "secretflow.data.mix.dataframe.MixDataFrame")</span></Outline.Parameter>, <Outline.Parameter><span className="name">batch\_size</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.11)")</span></Outline.Parameter>, <Outline.Parameter><span className="name">epochs</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.11)")</span></Outline.Parameter>, <Outline.Parameter><span className="name">aggregators</span><span>:</span><span>{" "}</span><span className="name">[List](https://docs.python.org/3/library/typing.html#typing.List "(in Python v3.11)")<span>\[</span>[Aggregator](secretflow.security.security.aggregation.mdx#secretflow.security.aggregation.aggregator.Aggregator "secretflow.security.aggregation.aggregator.Aggregator")<span>]</span></span></Outline.Parameter>, <Outline.Parameter><span className="name">heus</span><span>:</span><span>{" "}</span><span className="name">[List](https://docs.python.org/3/library/typing.html#typing.List "(in Python v3.11)")<span>\[</span>[HEU](secretflow.device.device.device.mdx#secretflow.device.device.heu.HEU "secretflow.device.device.heu.HEU")<span>]</span></span></Outline.Parameter>, <Outline.Parameter><span className="name">fxp\_bits</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.11)")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>18</span></Outline.Parameter>, <Outline.Parameter><span className="name">tol</span><span>:</span><span>{" "}</span><span className="name">[float](https://docs.python.org/3/library/functions.html#float "(in Python v3.11)")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>0.0001</span></Outline.Parameter>, <Outline.Parameter><span className="name">learning\_rate</span><span>:</span><span>{" "}</span><span className="name">[float](https://docs.python.org/3/library/functions.html#float "(in Python v3.11)")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>0.1</span></Outline.Parameter>, <Outline.Parameter><span className="name">agg\_epochs</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.11)")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>1</span></Outline.Parameter>, <Outline.Parameter><span className="name">audit\_log\_dir</span><span>:</span><span>{" "}</span><span className="name">[Dict](https://docs.python.org/3/library/typing.html#typing.Dict "(in Python v3.11)")<span>\[</span>[PYU](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYU "secretflow.device.device.pyu.PYU")<span>,</span><span>{" "}</span>[str](https://docs.python.org/3/library/stdtypes.html#str "(in Python v3.11)")<span>]</span><span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter>, <Outline.Parameter><span className="name">aggr\_hooks</span><span>:</span><span>{" "}</span><span className="name">[List](https://docs.python.org/3/library/typing.html#typing.List "(in Python v3.11)")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content>
        Fit the model.

        <FieldList>
          <dl>
            <dt className="field-name">
              Parameters
            </dt>

            <dd className="field-body">
              - <Outline.ParameterTarget>x</Outline.ParameterTarget> – training vector. X should be a horizontal partitioned
                [`MixDataFrame`](secretflow.data.data.mix.mdx#secretflow.data.mix.MixDataFrame "secretflow.data.mix.MixDataFrame"), which consists
                of \:py\:class:<del id="id2">\`</del>\~secretflow\.data.vertical.VDataFrame\`s.
              - <Outline.ParameterTarget>y</Outline.ParameterTarget> – target vector relative to x. Y should be a horizontal partitioned
                [`MixDataFrame`](secretflow.data.data.mix.mdx#secretflow.data.mix.MixDataFrame "secretflow.data.mix.MixDataFrame") alos. X and y
                should have the same amount of <del id="id4">\`</del>VDataFrame\`s.
              - <Outline.ParameterTarget>batch\_size</Outline.ParameterTarget> – number of samples per gradient update.
              - <Outline.ParameterTarget>epochs</Outline.ParameterTarget> – number of epochs to train the model.
              - <Outline.ParameterTarget>aggregators</Outline.ParameterTarget> – aggregator used to compute vertical lr. Amount of
                aggregators should be same as the <cite>VDataFrame</cite> of X.
              - <Outline.ParameterTarget>heus</Outline.ParameterTarget> – a list of heu used to compute vertical lr. Amount of
                heus should be same as the <cite>VDataFrame</cite> of X.
              - <Outline.ParameterTarget>fxp\_bits</Outline.ParameterTarget> – the fraction bit length for encoding before sending to
                heu device. Defaults to spu\_fxp\_precision(spu.spu\_pb2.FM64).
              - <Outline.ParameterTarget>tol</Outline.ParameterTarget> – optional, tolerance for stopping criteria. Defaults to 1e-4.
              - <Outline.ParameterTarget>learning\_rate</Outline.ParameterTarget> – optional, learning rate. Defaults to 0.1.
              - <Outline.ParameterTarget>agg\_epochs</Outline.ParameterTarget> – aggregate weights for every \{agg\_epochs} epochs.
                Defaults to 1.
              - <Outline.ParameterTarget>audit\_log\_dir</Outline.ParameterTarget> – a dict specifying the audit log directory for each
                device. No audit log if is None. Default to None.
                Please leave it None unless you are very sure what the audit
                does and accept the risk.
              - <Outline.ParameterTarget>aggr\_hooks</Outline.ParameterTarget> – The hooks called on each aggregation
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.fl_lr_mix.FlLogisticRegressionMix.predict"} module={"secretflow.ml.linear.fl_lr_mix"} fullname={"FlLogisticRegressionMix.predict"} description={"Predict the score."} parameters={["x"]}>
      <Outline.Signature fullname="FlLogisticRegressionMix.predict" id="secretflow.ml.linear.fl_lr_mix.FlLogisticRegressionMix.predict">
        <Outline.Name>predict</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">x</span><span>:</span><span>{" "}</span><span className="name">[MixDataFrame](secretflow.data.data.mix.mdx#secretflow.data.mix.dataframe.MixDataFrame "secretflow.data.mix.dataframe.MixDataFrame")</span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[List](https://docs.python.org/3/library/typing.html#typing.List "(in Python v3.11)")<span>\[</span>[PYUObject](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYUObject "secretflow.device.device.pyu.PYUObject")<span>]</span></Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content>
        Predict the score.

        <FieldList>
          <dl>
            <dt className="field-name">
              Parameters
            </dt>

            <dd className="field-body">
              <Outline.ParameterTarget>x</Outline.ParameterTarget> – the samples to predict.
            </dd>

            <dt className="field-name">
              Returns
            </dt>

            <dd className="field-body">
              a list of PYUObjects holding prediction results.
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>
  </Outline.Content>
</Outline>

:target{id="module-secretflow.ml.linear.fl_lr_v"}

## secretflow\.ml.linear.fl\_lr\_v module

<strong>Classes:</strong>

<table>
  <tbody>
    <tr>
      <td>
        [`FlLrVWorker`](#secretflow.ml.linear.fl_lr_v.FlLrVWorker "secretflow.ml.linear.fl_lr_v.FlLrVWorker")()
      </td>

      <td>

      </td>
    </tr>

    <tr>
      <td>
        [`PYUFlLrVWorker`](#secretflow.ml.linear.fl_lr_v.PYUFlLrVWorker "secretflow.ml.linear.fl_lr_v.PYUFlLrVWorker")
      </td>

      <td>
        alias of `ActorProxy(PYUFlLrVWorker)`
      </td>
    </tr>

    <tr>
      <td>
        [`FlLogisticRegressionVertical`](#secretflow.ml.linear.fl_lr_v.FlLogisticRegressionVertical "secretflow.ml.linear.fl_lr_v.FlLogisticRegressionVertical")(devices, ...\[, ...])
      </td>

      <td>
        Vertical logistic regression.
      </td>
    </tr>
  </tbody>
</table>

<Outline domain="py" objectType="class" target={"secretflow.ml.linear.fl_lr_v.FlLrVWorker"} module={"secretflow.ml.linear.fl_lr_v"} fullname={"FlLrVWorker"} description={"Bases: object"}>
  <Outline.Signature fullname="FlLrVWorker" id="secretflow.ml.linear.fl_lr_v.FlLrVWorker">
    <Outline.Keyword>class<span>{" "}</span></Outline.Keyword><Outline.Prefix>secretflow\.ml.linear.fl\_lr\_v.</Outline.Prefix><Outline.Name>FlLrVWorker</Outline.Name>
  </Outline.Signature>

  <Outline.Content>
    Bases: [`object`](https://docs.python.org/3/library/functions.html#object "(in Python v3.11)")

    <strong>Methods:</strong>

    <table>
      <tbody>
        <tr>
          <td>
            [`init_train_data`](#secretflow.ml.linear.fl_lr_v.FlLrVWorker.init_train_data "secretflow.ml.linear.fl_lr_v.FlLrVWorker.init_train_data")(x, batch\_size, epochs\[, y, ...])
          </td>

          <td>
            Initialize the training data.
          </td>
        </tr>

        <tr>
          <td>
            [`next_batch`](#secretflow.ml.linear.fl_lr_v.FlLrVWorker.next_batch "secretflow.ml.linear.fl_lr_v.FlLrVWorker.next_batch")()
          </td>

          <td>
            Get next batch of X and y.
          </td>
        </tr>

        <tr>
          <td>
            [`compute_mul`](#secretflow.ml.linear.fl_lr_v.FlLrVWorker.compute_mul "secretflow.ml.linear.fl_lr_v.FlLrVWorker.compute_mul")(x\_batch)
          </td>

          <td>
            Compute Xi\*Wi.
          </td>
        </tr>

        <tr>
          <td>
            [`predict`](#secretflow.ml.linear.fl_lr_v.FlLrVWorker.predict "secretflow.ml.linear.fl_lr_v.FlLrVWorker.predict")(mul)
          </td>

          <td>
            Do prediction.
          </td>
        </tr>

        <tr>
          <td>
            [`compute_loss`](#secretflow.ml.linear.fl_lr_v.FlLrVWorker.compute_loss "secretflow.ml.linear.fl_lr_v.FlLrVWorker.compute_loss")(y, h, avg\_flag)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [`compute_residual`](#secretflow.ml.linear.fl_lr_v.FlLrVWorker.compute_residual "secretflow.ml.linear.fl_lr_v.FlLrVWorker.compute_residual")(y, h)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [`encode`](#secretflow.ml.linear.fl_lr_v.FlLrVWorker.encode "secretflow.ml.linear.fl_lr_v.FlLrVWorker.encode")(data, frac\_bits)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [`decode`](#secretflow.ml.linear.fl_lr_v.FlLrVWorker.decode "secretflow.ml.linear.fl_lr_v.FlLrVWorker.decode")(data, frac\_bits)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [`generate_rand_mask`](#secretflow.ml.linear.fl_lr_v.FlLrVWorker.generate_rand_mask "secretflow.ml.linear.fl_lr_v.FlLrVWorker.generate_rand_mask")(decode\_frac)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [`get_weight`](#secretflow.ml.linear.fl_lr_v.FlLrVWorker.get_weight "secretflow.ml.linear.fl_lr_v.FlLrVWorker.get_weight")()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [`set_weight`](#secretflow.ml.linear.fl_lr_v.FlLrVWorker.set_weight "secretflow.ml.linear.fl_lr_v.FlLrVWorker.set_weight")(w)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [`update_weight`](#secretflow.ml.linear.fl_lr_v.FlLrVWorker.update_weight "secretflow.ml.linear.fl_lr_v.FlLrVWorker.update_weight")(masked\_gradient, learning\_rate)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [`update_weight_agg`](#secretflow.ml.linear.fl_lr_v.FlLrVWorker.update_weight_agg "secretflow.ml.linear.fl_lr_v.FlLrVWorker.update_weight_agg")(x\_batch, residual, ...)
          </td>

          <td>

          </td>
        </tr>
      </tbody>
    </table>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.fl_lr_v.FlLrVWorker.init_train_data"} module={"secretflow.ml.linear.fl_lr_v"} fullname={"FlLrVWorker.init_train_data"} description={"Initialize the training data."} parameters={["x", "batch_size", "epochs", "y", "shuffle_seed"]}>
      <Outline.Signature fullname="FlLrVWorker.init_train_data" id="secretflow.ml.linear.fl_lr_v.FlLrVWorker.init_train_data">
        <Outline.Name>init\_train\_data</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">x</span><span>:</span><span>{" "}</span><span className="name">[DataFrame](https://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.html#pandas.DataFrame "(in pandas v2.2.0dev0+187.g876d785872)")<span>{" "}</span><span>|</span><span>{" "}</span>[ndarray](https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray "(in NumPy v1.25)")</span></Outline.Parameter>, <Outline.Parameter><span className="name">batch\_size</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.11)")</span></Outline.Parameter>, <Outline.Parameter><span className="name">epochs</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.11)")</span></Outline.Parameter>, <Outline.Parameter><span className="name">y</span><span>:</span><span>{" "}</span><span className="name">[DataFrame](https://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.html#pandas.DataFrame "(in pandas v2.2.0dev0+187.g876d785872)")<span>{" "}</span><span>|</span><span>{" "}</span>[ndarray](https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray "(in NumPy v1.25)")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter>, <Outline.Parameter><span className="name">shuffle\_seed</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.11)")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content>
        Initialize the training data.

        <FieldList>
          <dl>
            <dt className="field-name">
              Parameters
            </dt>

            <dd className="field-body">
              - <Outline.ParameterTarget>x</Outline.ParameterTarget> – the training vector.
              - <Outline.ParameterTarget>batch\_size</Outline.ParameterTarget> – number of samples per gradient update.
              - <Outline.ParameterTarget>epochs</Outline.ParameterTarget> – number of epochs to train the model.
              - <Outline.ParameterTarget>y</Outline.ParameterTarget> – optional; the target vector relative to x.
              - <Outline.ParameterTarget>shuffle\_seed</Outline.ParameterTarget> – optional; the data will be shuffled if not none.
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.fl_lr_v.FlLrVWorker.next_batch"} module={"secretflow.ml.linear.fl_lr_v"} fullname={"FlLrVWorker.next_batch"} description={"Get next batch of X and y."} parameters={[]}>
      <Outline.Signature fullname="FlLrVWorker.next_batch" id="secretflow.ml.linear.fl_lr_v.FlLrVWorker.next_batch">
        <Outline.Name>next\_batch</Outline.Name><Outline.ParameterList><span>(</span><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[Tuple](https://docs.python.org/3/library/typing.html#typing.Tuple "(in Python v3.11)")<span>\[</span>[ndarray](https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray "(in NumPy v1.25)")<span>,</span><span>{" "}</span>[ndarray](https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray "(in NumPy v1.25)")<span>]</span></Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content>
        Get next batch of X and y.

        <FieldList>
          <dl>
            <dt className="field-name">
              Returns
            </dt>

            <dd className="field-body">
              A tuple of (x batch, y batch), while y batch is None if no y.
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.fl_lr_v.FlLrVWorker.compute_mul"} module={"secretflow.ml.linear.fl_lr_v"} fullname={"FlLrVWorker.compute_mul"} description={"Compute Xi*Wi."} parameters={["x_batch"]}>
      <Outline.Signature fullname="FlLrVWorker.compute_mul" id="secretflow.ml.linear.fl_lr_v.FlLrVWorker.compute_mul">
        <Outline.Name>compute\_mul</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">x\_batch</span><span>:</span><span>{" "}</span><span className="name">[ndarray](https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray "(in NumPy v1.25)")</span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[ndarray](https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray "(in NumPy v1.25)")</Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content>
        Compute Xi\*Wi.
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.fl_lr_v.FlLrVWorker.predict"} module={"secretflow.ml.linear.fl_lr_v"} fullname={"FlLrVWorker.predict"} description={"Do prediction."} parameters={["mul"]}>
      <Outline.Signature fullname="FlLrVWorker.predict" id="secretflow.ml.linear.fl_lr_v.FlLrVWorker.predict">
        <Outline.Name>predict</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">mul</span><span>:</span><span>{" "}</span><span className="name">[ndarray](https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray "(in NumPy v1.25)")</span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[ndarray](https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray "(in NumPy v1.25)")</Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content>
        Do prediction.

        <FieldList>
          <dl>
            <dt className="field-name">
              Parameters
            </dt>

            <dd className="field-body">
              <Outline.ParameterTarget>mul</Outline.ParameterTarget> – the sum of Xi\*Wi (i>0).
            </dd>

            <dt className="field-name">
              Returns
            </dt>

            <dd className="field-body">
              The prediction results.
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.fl_lr_v.FlLrVWorker.compute_loss"} module={"secretflow.ml.linear.fl_lr_v"} fullname={"FlLrVWorker.compute_loss"} description={"Bases: object"} parameters={["y", "h", "avg_flag"]}>
      <Outline.Signature fullname="FlLrVWorker.compute_loss" id="secretflow.ml.linear.fl_lr_v.FlLrVWorker.compute_loss">
        <Outline.Name>compute\_loss</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">y</span><span>:</span><span>{" "}</span><span className="name">[ndarray](https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray "(in NumPy v1.25)")</span></Outline.Parameter>, <Outline.Parameter><span className="name">h</span><span>:</span><span>{" "}</span><span className="name">[ndarray](https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray "(in NumPy v1.25)")</span></Outline.Parameter>, <Outline.Parameter><span className="name">avg\_flag</span><span>:</span><span>{" "}</span><span className="name">[bool](https://docs.python.org/3/library/functions.html#bool "(in Python v3.11)")</span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[ndarray](https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray "(in NumPy v1.25)")</Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.fl_lr_v.FlLrVWorker.compute_residual"} module={"secretflow.ml.linear.fl_lr_v"} fullname={"FlLrVWorker.compute_residual"} description={"Bases: object"} parameters={["y", "h"]}>
      <Outline.Signature fullname="FlLrVWorker.compute_residual" id="secretflow.ml.linear.fl_lr_v.FlLrVWorker.compute_residual">
        <Outline.Name>compute\_residual</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">y</span><span>:</span><span>{" "}</span><span className="name">[ndarray](https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray "(in NumPy v1.25)")</span></Outline.Parameter>, <Outline.Parameter><span className="name">h</span><span>:</span><span>{" "}</span><span className="name">[ndarray](https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray "(in NumPy v1.25)")</span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[ndarray](https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray "(in NumPy v1.25)")</Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.fl_lr_v.FlLrVWorker.encode"} module={"secretflow.ml.linear.fl_lr_v"} fullname={"FlLrVWorker.encode"} description={"Bases: object"} parameters={["data", "frac_bits"]}>
      <Outline.Signature fullname="FlLrVWorker.encode" id="secretflow.ml.linear.fl_lr_v.FlLrVWorker.encode">
        <Outline.Name>encode</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">data</span><span>:</span><span>{" "}</span><span className="name">[ndarray](https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray "(in NumPy v1.25)")</span></Outline.Parameter>, <Outline.Parameter><span className="name">frac\_bits</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.11)")</span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[ndarray](https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray "(in NumPy v1.25)")</Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.fl_lr_v.FlLrVWorker.decode"} module={"secretflow.ml.linear.fl_lr_v"} fullname={"FlLrVWorker.decode"} description={"Bases: object"} parameters={["data", "frac_bits"]}>
      <Outline.Signature fullname="FlLrVWorker.decode" id="secretflow.ml.linear.fl_lr_v.FlLrVWorker.decode">
        <Outline.Name>decode</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">data</span><span>:</span><span>{" "}</span><span className="name">[ndarray](https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray "(in NumPy v1.25)")</span></Outline.Parameter>, <Outline.Parameter><span className="name">frac\_bits</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.11)")</span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[ndarray](https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray "(in NumPy v1.25)")</Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.fl_lr_v.FlLrVWorker.generate_rand_mask"} module={"secretflow.ml.linear.fl_lr_v"} fullname={"FlLrVWorker.generate_rand_mask"} description={"Bases: object"} parameters={["decode_frac"]}>
      <Outline.Signature fullname="FlLrVWorker.generate_rand_mask" id="secretflow.ml.linear.fl_lr_v.FlLrVWorker.generate_rand_mask">
        <Outline.Name>generate\_rand\_mask</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">decode\_frac</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.11)")</span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[ndarray](https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray "(in NumPy v1.25)")</Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.fl_lr_v.FlLrVWorker.get_weight"} module={"secretflow.ml.linear.fl_lr_v"} fullname={"FlLrVWorker.get_weight"} description={"Bases: object"} parameters={[]}>
      <Outline.Signature fullname="FlLrVWorker.get_weight" id="secretflow.ml.linear.fl_lr_v.FlLrVWorker.get_weight">
        <Outline.Name>get\_weight</Outline.Name><Outline.ParameterList><span>(</span><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[ndarray](https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray "(in NumPy v1.25)")</Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.fl_lr_v.FlLrVWorker.set_weight"} module={"secretflow.ml.linear.fl_lr_v"} fullname={"FlLrVWorker.set_weight"} description={"Bases: object"} parameters={["w"]}>
      <Outline.Signature fullname="FlLrVWorker.set_weight" id="secretflow.ml.linear.fl_lr_v.FlLrVWorker.set_weight">
        <Outline.Name>set\_weight</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">w</span><span>:</span><span>{" "}</span><span className="name">[ndarray](https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray "(in NumPy v1.25)")</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.fl_lr_v.FlLrVWorker.update_weight"} module={"secretflow.ml.linear.fl_lr_v"} fullname={"FlLrVWorker.update_weight"} description={"Bases: object"} parameters={["masked_gradient", "learning_rate"]}>
      <Outline.Signature fullname="FlLrVWorker.update_weight" id="secretflow.ml.linear.fl_lr_v.FlLrVWorker.update_weight">
        <Outline.Name>update\_weight</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">masked\_gradient</span><span>:</span><span>{" "}</span><span className="name">[ndarray](https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray "(in NumPy v1.25)")</span></Outline.Parameter>, <Outline.Parameter><span className="name">learning\_rate</span><span>:</span><span>{" "}</span><span className="name">[float](https://docs.python.org/3/library/functions.html#float "(in Python v3.11)")</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.fl_lr_v.FlLrVWorker.update_weight_agg"} module={"secretflow.ml.linear.fl_lr_v"} fullname={"FlLrVWorker.update_weight_agg"} description={"Bases: object"} parameters={["x_batch", "residual", "learning_rate"]}>
      <Outline.Signature fullname="FlLrVWorker.update_weight_agg" id="secretflow.ml.linear.fl_lr_v.FlLrVWorker.update_weight_agg">
        <Outline.Name>update\_weight\_agg</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">x\_batch</span><span>:</span><span>{" "}</span><span className="name">[ndarray](https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray "(in NumPy v1.25)")</span></Outline.Parameter>, <Outline.Parameter><span className="name">residual</span><span>:</span><span>{" "}</span><span className="name">[ndarray](https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray "(in NumPy v1.25)")</span></Outline.Parameter>, <Outline.Parameter><span className="name">learning\_rate</span><span>:</span><span>{" "}</span><span className="name">[float](https://docs.python.org/3/library/functions.html#float "(in Python v3.11)")</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>
  </Outline.Content>
</Outline>

<Outline domain="py" objectType="attribute" target={"secretflow.ml.linear.fl_lr_v.PYUFlLrVWorker"} module={"secretflow.ml.linear.fl_lr_v"} fullname={"PYUFlLrVWorker"} description={"alias of ActorProxy(PYUFlLrVWorker)\nMethods:"}>
  <Outline.Signature fullname="PYUFlLrVWorker" id="secretflow.ml.linear.fl_lr_v.PYUFlLrVWorker">
    <Outline.Prefix>secretflow\.ml.linear.fl\_lr\_v.</Outline.Prefix><Outline.Name>PYUFlLrVWorker</Outline.Name>
  </Outline.Signature>

  <Outline.Content>
    alias of `ActorProxy(PYUFlLrVWorker)`
    <strong>Methods:</strong>

    <table>
      <tbody>
        <tr>
          <td>
            `__init__`(\*args, \*\*kwargs)
          </td>

          <td>
            Abstraction device object base class.
          </td>
        </tr>

        <tr>
          <td>
            `compute_loss`(y, h, avg\_flag)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `compute_mul`(x\_batch)
          </td>

          <td>
            Compute Xi\*Wi.
          </td>
        </tr>

        <tr>
          <td>
            `compute_residual`(y, h)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `decode`(data, frac\_bits)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `encode`(data, frac\_bits)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `generate_rand_mask`(decode\_frac)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `get_weight`()
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `init_train_data`(x, batch\_size, epochs\[, y, ...])
          </td>

          <td>
            Initialize the training data.
          </td>
        </tr>

        <tr>
          <td>
            `next_batch`()
          </td>

          <td>
            Get next batch of X and y.
          </td>
        </tr>

        <tr>
          <td>
            `predict`(mul)
          </td>

          <td>
            Do prediction.
          </td>
        </tr>

        <tr>
          <td>
            `set_weight`(w)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `update_weight`(masked\_gradient, learning\_rate)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            `update_weight_agg`(x\_batch, residual, ...)
          </td>

          <td>

          </td>
        </tr>
      </tbody>
    </table>
  </Outline.Content>
</Outline>

<Outline domain="py" objectType="class" target={"secretflow.ml.linear.fl_lr_v.FlLogisticRegressionVertical"} module={"secretflow.ml.linear.fl_lr_v"} fullname={"FlLogisticRegressionVertical"} parameters={["devices", "aggregator", "heu", "fxp_bits", "audit_log_dir"]} description={"Bases: object"}>
  <Outline.Signature fullname="FlLogisticRegressionVertical" id="secretflow.ml.linear.fl_lr_v.FlLogisticRegressionVertical">
    <Outline.Keyword>class<span>{" "}</span></Outline.Keyword><Outline.Prefix>secretflow\.ml.linear.fl\_lr\_v.</Outline.Prefix><Outline.Name>FlLogisticRegressionVertical</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">devices</span><span>:</span><span>{" "}</span><span className="name">[List](https://docs.python.org/3/library/typing.html#typing.List "(in Python v3.11)")<span>\[</span>[PYU](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYU "secretflow.device.device.pyu.PYU")<span>]</span></span></Outline.Parameter>, <Outline.Parameter><span className="name">aggregator</span><span>:</span><span>{" "}</span><span className="name">[Aggregator](secretflow.security.security.aggregation.mdx#secretflow.security.aggregation.aggregator.Aggregator "secretflow.security.aggregation.aggregator.Aggregator")</span></Outline.Parameter>, <Outline.Parameter><span className="name">heu</span><span>:</span><span>{" "}</span><span className="name">[HEU](secretflow.device.device.device.mdx#secretflow.device.device.heu.HEU "secretflow.device.device.heu.HEU")</span></Outline.Parameter>, <Outline.Parameter><span className="name">fxp\_bits</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.11)")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>18</span></Outline.Parameter>, <Outline.Parameter><span className="name">audit\_log\_dir</span><span>:</span><span>{" "}</span><span className="name">[Dict](https://docs.python.org/3/library/typing.html#typing.Dict "(in Python v3.11)")<span>\[</span>[PYU](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYU "secretflow.device.device.pyu.PYU")<span>,</span><span>{" "}</span>[str](https://docs.python.org/3/library/stdtypes.html#str "(in Python v3.11)")<span>]</span><span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter><span>)</span></Outline.ParameterList>
  </Outline.Signature>

  <Outline.Content>
    Bases: [`object`](https://docs.python.org/3/library/functions.html#object "(in Python v3.11)")

    Vertical logistic regression.

    Implement the basic SGD based logistic regression among multiple vertical
    participants.

    To explain this algorithm, suppose alice has features and label, while bob
    and charlie have features only.
    The main steps of SGD are:

    1. Alice does prediction using secure aggregation.
    2. Alice sends the residual to bob/charlie in HE(Homomorphic Encryption)
       ciphertext.
    3. Bob and charlie compute gradients in HE ciphertext and send masked
       gradients to alice.
    4. Alice decrypts the masked gradients and send them back to bob/charlie.
    5. Bob and charlie unmask gradients and update their weights independently.
    6. Alice updates its weights also.

    <strong>Methods:</strong>

    <table>
      <tbody>
        <tr>
          <td>
            [`__init__`](#secretflow.ml.linear.fl_lr_v.FlLogisticRegressionVertical.__init__ "secretflow.ml.linear.fl_lr_v.FlLogisticRegressionVertical.__init__")(devices, aggregator, heu\[, ...])
          </td>

          <td>
            Init VanillaVerLogisticRegression.
          </td>
        </tr>

        <tr>
          <td>
            [`init_train_data`](#secretflow.ml.linear.fl_lr_v.FlLogisticRegressionVertical.init_train_data "secretflow.ml.linear.fl_lr_v.FlLogisticRegressionVertical.init_train_data")(x, y, epochs, batch\_size\[, ...])
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [`predict`](#secretflow.ml.linear.fl_lr_v.FlLogisticRegressionVertical.predict "secretflow.ml.linear.fl_lr_v.FlLogisticRegressionVertical.predict")(x)
          </td>

          <td>
            Predict the score.
          </td>
        </tr>

        <tr>
          <td>
            [`compute_loss`](#secretflow.ml.linear.fl_lr_v.FlLogisticRegressionVertical.compute_loss "secretflow.ml.linear.fl_lr_v.FlLogisticRegressionVertical.compute_loss")(x, y\[, avg\_flag])
          </td>

          <td>
            Compute the loss.
          </td>
        </tr>

        <tr>
          <td>
            [`get_weight`](#secretflow.ml.linear.fl_lr_v.FlLogisticRegressionVertical.get_weight "secretflow.ml.linear.fl_lr_v.FlLogisticRegressionVertical.get_weight")()
          </td>

          <td>
            Get weight from this estimator.
          </td>
        </tr>

        <tr>
          <td>
            [`set_weight`](#secretflow.ml.linear.fl_lr_v.FlLogisticRegressionVertical.set_weight "secretflow.ml.linear.fl_lr_v.FlLogisticRegressionVertical.set_weight")(weight)
          </td>

          <td>
            Set weight to this estimator.
          </td>
        </tr>

        <tr>
          <td>
            [`fit`](#secretflow.ml.linear.fl_lr_v.FlLogisticRegressionVertical.fit "secretflow.ml.linear.fl_lr_v.FlLogisticRegressionVertical.fit")(x, y, batch\_size, epochs\[, tol, ...])
          </td>

          <td>
            Fit the model.
          </td>
        </tr>

        <tr>
          <td>
            [`fit_in_steps`](#secretflow.ml.linear.fl_lr_v.FlLogisticRegressionVertical.fit_in_steps "secretflow.ml.linear.fl_lr_v.FlLogisticRegressionVertical.fit_in_steps")(n\_step, learning\_rate, epoch)
          </td>

          <td>
            Fit in steps.
          </td>
        </tr>
      </tbody>
    </table>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.fl_lr_v.FlLogisticRegressionVertical.__init__"} module={"secretflow.ml.linear.fl_lr_v"} fullname={"FlLogisticRegressionVertical.__init__"} parameters={["devices", "aggregator", "heu", "fxp_bits", "audit_log_dir"]} description={"Init VanillaVerLogisticRegression."}>
      <Outline.Signature fullname="FlLogisticRegressionVertical.__init__" id="secretflow.ml.linear.fl_lr_v.FlLogisticRegressionVertical.__init__">
        <Outline.Name>\_\_init\_\_</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">devices</span><span>:</span><span>{" "}</span><span className="name">[List](https://docs.python.org/3/library/typing.html#typing.List "(in Python v3.11)")<span>\[</span>[PYU](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYU "secretflow.device.device.pyu.PYU")<span>]</span></span></Outline.Parameter>, <Outline.Parameter><span className="name">aggregator</span><span>:</span><span>{" "}</span><span className="name">[Aggregator](secretflow.security.security.aggregation.mdx#secretflow.security.aggregation.aggregator.Aggregator "secretflow.security.aggregation.aggregator.Aggregator")</span></Outline.Parameter>, <Outline.Parameter><span className="name">heu</span><span>:</span><span>{" "}</span><span className="name">[HEU](secretflow.device.device.device.mdx#secretflow.device.device.heu.HEU "secretflow.device.device.heu.HEU")</span></Outline.Parameter>, <Outline.Parameter><span className="name">fxp\_bits</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.11)")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>18</span></Outline.Parameter>, <Outline.Parameter><span className="name">audit\_log\_dir</span><span>:</span><span>{" "}</span><span className="name">[Dict](https://docs.python.org/3/library/typing.html#typing.Dict "(in Python v3.11)")<span>\[</span>[PYU](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYU "secretflow.device.device.pyu.PYU")<span>,</span><span>{" "}</span>[str](https://docs.python.org/3/library/stdtypes.html#str "(in Python v3.11)")<span>]</span><span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content>
        Init VanillaVerLogisticRegression.

        <FieldList>
          <dl>
            <dt className="field-name">
              Parameters
            </dt>

            <dd className="field-body">
              - <Outline.ParameterTarget>devices</Outline.ParameterTarget> – a list of PYU devices taking part in the computation.
              - <Outline.ParameterTarget>aggregator</Outline.ParameterTarget> – the aggregator instance.
              - <Outline.ParameterTarget>heu</Outline.ParameterTarget> – the heu device instance.
              - <Outline.ParameterTarget>fxp\_bits</Outline.ParameterTarget> – the fraction bit length for encoding before send to
                heu device. Defaults to spu\_fxp\_precision(spu.spu\_pb2.FM64).
              - <Outline.ParameterTarget>audit\_log\_dir</Outline.ParameterTarget> – a dict specifying the audit log directory for each
                device. No audit log if is None. Default to None.
                Please leave it None unless you are very sure what the audit
                does and accept the risk.
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.fl_lr_v.FlLogisticRegressionVertical.init_train_data"} module={"secretflow.ml.linear.fl_lr_v"} fullname={"FlLogisticRegressionVertical.init_train_data"} parameters={["x", "y", "epochs", "batch_size", "shuffle_seed"]} description={"Bases: object"}>
      <Outline.Signature fullname="FlLogisticRegressionVertical.init_train_data" id="secretflow.ml.linear.fl_lr_v.FlLogisticRegressionVertical.init_train_data">
        <Outline.Name>init\_train\_data</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">x</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.mdx#secretflow.data.ndarray.FedNdarray "secretflow.data.ndarray.FedNdarray")</span></Outline.Parameter>, <Outline.Parameter><span className="name">y</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.mdx#secretflow.data.ndarray.FedNdarray "secretflow.data.ndarray.FedNdarray")</span></Outline.Parameter>, <Outline.Parameter><span className="name">epochs</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.11)")</span></Outline.Parameter>, <Outline.Parameter><span className="name">batch\_size</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.11)")</span></Outline.Parameter>, <Outline.Parameter><span className="name">shuffle\_seed</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.11)")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.fl_lr_v.FlLogisticRegressionVertical.predict"} module={"secretflow.ml.linear.fl_lr_v"} fullname={"FlLogisticRegressionVertical.predict"} parameters={["x"]} description={"Predict the score."}>
      <Outline.Signature fullname="FlLogisticRegressionVertical.predict" id="secretflow.ml.linear.fl_lr_v.FlLogisticRegressionVertical.predict">
        <Outline.Name>predict</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">x</span><span>:</span><span>{" "}</span><span className="name">[VDataFrame](secretflow.data.data.vertical.mdx#secretflow.data.vertical.dataframe.VDataFrame "secretflow.data.vertical.dataframe.VDataFrame")<span>{" "}</span><span>|</span><span>{" "}</span>[FedNdarray](secretflow.data.mdx#secretflow.data.ndarray.FedNdarray "secretflow.data.ndarray.FedNdarray")<span>{" "}</span><span>|</span><span>{" "}</span>[List](https://docs.python.org/3/library/typing.html#typing.List "(in Python v3.11)")<span>\[</span>[PYUObject](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYUObject "secretflow.device.device.pyu.PYUObject")<span>]</span></span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[PYUObject](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYUObject "secretflow.device.device.pyu.PYUObject")</Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content>
        Predict the score.

        <FieldList>
          <dl>
            <dt className="field-name">
              Parameters
            </dt>

            <dd className="field-body">
              <Outline.ParameterTarget>x</Outline.ParameterTarget> – the samples to predict.
            </dd>

            <dt className="field-name">
              Returns
            </dt>

            <dd className="field-body">
              a PYUObject holds prediction results.
            </dd>

            <dt className="field-name">
              Return type
            </dt>

            <dd className="field-body">
              [PYUObject](secretflow.mdx#secretflow.PYUObject "secretflow.PYUObject")
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.fl_lr_v.FlLogisticRegressionVertical.compute_loss"} module={"secretflow.ml.linear.fl_lr_v"} fullname={"FlLogisticRegressionVertical.compute_loss"} parameters={["x", "y", "avg_flag"]} description={"Compute the loss."}>
      <Outline.Signature fullname="FlLogisticRegressionVertical.compute_loss" id="secretflow.ml.linear.fl_lr_v.FlLogisticRegressionVertical.compute_loss">
        <Outline.Name>compute\_loss</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">x</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.mdx#secretflow.data.ndarray.FedNdarray "secretflow.data.ndarray.FedNdarray")</span></Outline.Parameter>, <Outline.Parameter><span className="name">y</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.mdx#secretflow.data.ndarray.FedNdarray "secretflow.data.ndarray.FedNdarray")</span></Outline.Parameter>, <Outline.Parameter><span className="name">avg\_flag</span><span>:</span><span>{" "}</span><span className="name">[bool](https://docs.python.org/3/library/functions.html#bool "(in Python v3.11)")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>True</span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[PYUObject](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYUObject "secretflow.device.device.pyu.PYUObject")</Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content>
        Compute the loss.

        <FieldList>
          <dl>
            <dt className="field-name">
              Parameters
            </dt>

            <dd className="field-body">
              - <Outline.ParameterTarget>x</Outline.ParameterTarget> – the samples.
              - <Outline.ParameterTarget>y</Outline.ParameterTarget> – the label.
              - <Outline.ParameterTarget>avg\_flag</Outline.ParameterTarget> – whether dividing the sample number. Defaults to True.
            </dd>

            <dt className="field-name">
              Returns
            </dt>

            <dd className="field-body">
              a PYUObject holds loss value.
            </dd>

            <dt className="field-name">
              Return type
            </dt>

            <dd className="field-body">
              [PYUObject](secretflow.mdx#secretflow.PYUObject "secretflow.PYUObject")
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.fl_lr_v.FlLogisticRegressionVertical.get_weight"} module={"secretflow.ml.linear.fl_lr_v"} fullname={"FlLogisticRegressionVertical.get_weight"} parameters={[]} description={"Get weight from this estimator."}>
      <Outline.Signature fullname="FlLogisticRegressionVertical.get_weight" id="secretflow.ml.linear.fl_lr_v.FlLogisticRegressionVertical.get_weight">
        <Outline.Name>get\_weight</Outline.Name><Outline.ParameterList><span>(</span><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[Dict](https://docs.python.org/3/library/typing.html#typing.Dict "(in Python v3.11)")<span>\[</span>[PYU](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYU "secretflow.device.device.pyu.PYU")<span>,</span><span>{" "}</span>[PYUObject](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYUObject "secretflow.device.device.pyu.PYUObject")<span>]</span></Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content>
        Get weight from this estimator.

        <FieldList>
          <dl>
            <dt className="field-name">
              Returns
            </dt>

            <dd className="field-body">
              A dict of pyu and its weight. Note that the intecept(w0)
              is the first column of the label deivce weight.
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.fl_lr_v.FlLogisticRegressionVertical.set_weight"} module={"secretflow.ml.linear.fl_lr_v"} fullname={"FlLogisticRegressionVertical.set_weight"} parameters={["weight"]} description={"Set weight to this estimator."}>
      <Outline.Signature fullname="FlLogisticRegressionVertical.set_weight" id="secretflow.ml.linear.fl_lr_v.FlLogisticRegressionVertical.set_weight">
        <Outline.Name>set\_weight</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">weight</span><span>:</span><span>{" "}</span><span className="name">[Dict](https://docs.python.org/3/library/typing.html#typing.Dict "(in Python v3.11)")<span>\[</span>[PYU](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYU "secretflow.device.device.pyu.PYU")<span>,</span><span>{" "}</span>[PYUObject](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYUObject "secretflow.device.device.pyu.PYUObject")<span>{" "}</span><span>|</span><span>{" "}</span>[ndarray](https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray "(in NumPy v1.25)")<span>]</span></span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content>
        Set weight to this estimator.

        <FieldList>
          <dl>
            <dt className="field-name">
              Parameters
            </dt>

            <dd className="field-body">
              <Outline.ParameterTarget>weight</Outline.ParameterTarget> – a dict of pyu and its weight.
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.fl_lr_v.FlLogisticRegressionVertical.fit"} module={"secretflow.ml.linear.fl_lr_v"} fullname={"FlLogisticRegressionVertical.fit"} parameters={["x", "y", "batch_size", "epochs", "tol", "learning_rate"]} description={"Fit the model."}>
      <Outline.Signature fullname="FlLogisticRegressionVertical.fit" id="secretflow.ml.linear.fl_lr_v.FlLogisticRegressionVertical.fit">
        <Outline.Name>fit</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">x</span><span>:</span><span>{" "}</span><span className="name">[VDataFrame](secretflow.data.data.vertical.mdx#secretflow.data.vertical.dataframe.VDataFrame "secretflow.data.vertical.dataframe.VDataFrame")<span>{" "}</span><span>|</span><span>{" "}</span>[FedNdarray](secretflow.data.mdx#secretflow.data.ndarray.FedNdarray "secretflow.data.ndarray.FedNdarray")</span></Outline.Parameter>, <Outline.Parameter><span className="name">y</span><span>:</span><span>{" "}</span><span className="name">[VDataFrame](secretflow.data.data.vertical.mdx#secretflow.data.vertical.dataframe.VDataFrame "secretflow.data.vertical.dataframe.VDataFrame")<span>{" "}</span><span>|</span><span>{" "}</span>[FedNdarray](secretflow.data.mdx#secretflow.data.ndarray.FedNdarray "secretflow.data.ndarray.FedNdarray")</span></Outline.Parameter>, <Outline.Parameter><span className="name">batch\_size</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.11)")</span></Outline.Parameter>, <Outline.Parameter><span className="name">epochs</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.11)")</span></Outline.Parameter>, <Outline.Parameter><span className="name">tol</span><span>:</span><span>{" "}</span><span className="name">[float](https://docs.python.org/3/library/functions.html#float "(in Python v3.11)")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>0.0001</span></Outline.Parameter>, <Outline.Parameter><span className="name">learning\_rate</span><span>:</span><span>{" "}</span><span className="name">[float](https://docs.python.org/3/library/functions.html#float "(in Python v3.11)")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>0.1</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content>
        Fit the model.

        <FieldList>
          <dl>
            <dt className="field-name">
              Parameters
            </dt>

            <dd className="field-body">
              - <Outline.ParameterTarget>x</Outline.ParameterTarget> – training vector.
              - <Outline.ParameterTarget>y</Outline.ParameterTarget> – target vector relative to x.
              - <Outline.ParameterTarget>batch\_size</Outline.ParameterTarget> – number of samples per gradient update.
              - <Outline.ParameterTarget>epochs</Outline.ParameterTarget> – number of epochs to train the model.
              - <Outline.ParameterTarget>tol</Outline.ParameterTarget> – optional, tolerance for stopping criteria. Defaults to 1e-4.
              - <Outline.ParameterTarget>learning\_rate</Outline.ParameterTarget> – optional, learning rate. Defaults to 0.1.
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.fl_lr_v.FlLogisticRegressionVertical.fit_in_steps"} module={"secretflow.ml.linear.fl_lr_v"} fullname={"FlLogisticRegressionVertical.fit_in_steps"} parameters={["n_step", "learning_rate", "epoch"]} description={"Fit in steps."}>
      <Outline.Signature fullname="FlLogisticRegressionVertical.fit_in_steps" id="secretflow.ml.linear.fl_lr_v.FlLogisticRegressionVertical.fit_in_steps">
        <Outline.Name>fit\_in\_steps</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">n\_step</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.11)")</span></Outline.Parameter>, <Outline.Parameter><span className="name">learning\_rate</span><span>:</span><span>{" "}</span><span className="name">[float](https://docs.python.org/3/library/functions.html#float "(in Python v3.11)")</span></Outline.Parameter>, <Outline.Parameter><span className="name">epoch</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.11)")</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content>
        Fit in steps.

        <FieldList>
          <dl>
            <dt className="field-name">
              Parameters
            </dt>

            <dd className="field-body">
              - <Outline.ParameterTarget>n\_step</Outline.ParameterTarget> – the number of steps.
              - <Outline.ParameterTarget>learning\_rate</Outline.ParameterTarget> – learning rate.
              - <Outline.ParameterTarget>epoch</Outline.ParameterTarget> – the current epoch.
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>
  </Outline.Content>
</Outline>

:target{id="module-secretflow.ml.linear.linear_model"}

## secretflow\.ml.linear.linear\_model module

<strong>Classes:</strong>

<table>
  <tbody>
    <tr>
      <td>
        [`RegType`](#secretflow.ml.linear.linear_model.RegType "secretflow.ml.linear.linear_model.RegType")(value)
      </td>

      <td>
        An enumeration.
      </td>
    </tr>

    <tr>
      <td>
        [`LinearModel`](#secretflow.ml.linear.linear_model.LinearModel "secretflow.ml.linear.linear_model.LinearModel")(weights, reg\_type, sig\_type)
      </td>

      <td>
        Unified linear regression model.
      </td>
    </tr>
  </tbody>
</table>

<Outline domain="py" objectType="class" target={"secretflow.ml.linear.linear_model.RegType"} module={"secretflow.ml.linear.linear_model"} fullname={"RegType"} parameters={["value"]} description={"Bases: Enum"}>
  <Outline.Signature fullname="RegType" id="secretflow.ml.linear.linear_model.RegType">
    <Outline.Keyword>class<span>{" "}</span></Outline.Keyword><Outline.Prefix>secretflow\.ml.linear.linear\_model.</Outline.Prefix><Outline.Name>RegType</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">value</span></Outline.Parameter><span>)</span></Outline.ParameterList>
  </Outline.Signature>

  <Outline.Content>
    Bases: [`Enum`](https://docs.python.org/3/library/enum.html#enum.Enum "(in Python v3.11)")

    An enumeration.

    <strong>Attributes:</strong>

    <table>
      <tbody>
        <tr>
          <td>
            [`Linear`](#secretflow.ml.linear.linear_model.RegType.Linear "secretflow.ml.linear.linear_model.RegType.Linear")
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [`Logistic`](#secretflow.ml.linear.linear_model.RegType.Logistic "secretflow.ml.linear.linear_model.RegType.Logistic")
          </td>

          <td>

          </td>
        </tr>
      </tbody>
    </table>

    <Outline domain="py" objectType="attribute" target={"secretflow.ml.linear.linear_model.RegType.Linear"} module={"secretflow.ml.linear.linear_model"} fullname={"RegType.Linear"} parameters={["value"]} description={"Bases: Enum"}>
      <Outline.Signature fullname="RegType.Linear" id="secretflow.ml.linear.linear_model.RegType.Linear">
        <Outline.Name>Linear</Outline.Name><Outline.Keyword><span>{" "}</span><span>=</span><span>{" "}</span>'linear'</Outline.Keyword>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="attribute" target={"secretflow.ml.linear.linear_model.RegType.Logistic"} module={"secretflow.ml.linear.linear_model"} fullname={"RegType.Logistic"} parameters={["value"]} description={"Bases: Enum"}>
      <Outline.Signature fullname="RegType.Logistic" id="secretflow.ml.linear.linear_model.RegType.Logistic">
        <Outline.Name>Logistic</Outline.Name><Outline.Keyword><span>{" "}</span><span>=</span><span>{" "}</span>'logistic'</Outline.Keyword>
      </Outline.Signature>

      <Outline.Content />
    </Outline>
  </Outline.Content>
</Outline>

<Outline domain="py" objectType="class" target={"secretflow.ml.linear.linear_model.LinearModel"} module={"secretflow.ml.linear.linear_model"} fullname={"LinearModel"} parameters={["weights", "reg_type", "sig_type"]} description={"Bases: object"}>
  <Outline.Signature fullname="LinearModel" id="secretflow.ml.linear.linear_model.LinearModel">
    <Outline.Keyword>class<span>{" "}</span></Outline.Keyword><Outline.Prefix>secretflow\.ml.linear.linear\_model.</Outline.Prefix><Outline.Name>LinearModel</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">weights</span><span>:</span><span>{" "}</span><span className="name">[SPUObject](secretflow.device.device.device.mdx#secretflow.device.device.spu.SPUObject "secretflow.device.device.spu.SPUObject")<span>{" "}</span><span>|</span><span>{" "}</span>[List](https://docs.python.org/3/library/typing.html#typing.List "(in Python v3.11)")<span>\[</span>[PYUObject](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYUObject "secretflow.device.device.pyu.PYUObject")<span>]</span></span></Outline.Parameter>, <Outline.Parameter><span className="name">reg\_type</span><span>:</span><span>{" "}</span><span className="name">[RegType](#secretflow.ml.linear.linear_model.RegType "secretflow.ml.linear.linear_model.RegType")</span></Outline.Parameter>, <Outline.Parameter><span className="name">sig\_type</span><span>:</span><span>{" "}</span><span className="name">[SigType](secretflow.utils.mdx#secretflow.utils.sigmoid.SigType "secretflow.utils.sigmoid.SigType")</span></Outline.Parameter><span>)</span></Outline.ParameterList>
  </Outline.Signature>

  <Outline.Content>
    Bases: [`object`](https://docs.python.org/3/library/functions.html#object "(in Python v3.11)")

    Unified linear regression model.

    <Outline domain="py" objectType="attribute" target={"secretflow.ml.linear.linear_model.LinearModel.weights"} module={"secretflow.ml.linear.linear_model"} fullname={"LinearModel.weights"} parameters={["weights", "reg_type", "sig_type"]} description={"{SPUObject, List[PYUObject]}\nfor mpc lr, use SPUObject save all weights; for fl lr, use list of PYUObject."}>
      <Outline.Signature fullname="LinearModel.weights" id="secretflow.ml.linear.linear_model.LinearModel.weights">
        <Outline.Name>weights</Outline.Name>
      </Outline.Signature>

      <Outline.Content>
        \{SPUObject, List\[PYUObject]}
        for mpc lr, use SPUObject save all weights; for fl lr, use list of PYUObject.

        <FieldList>
          <dl>
            <dt className="field-name">
              Type
            </dt>

            <dd className="field-body">
              [secretflow.device.device.spu.SPUObject](secretflow.device.device.device.mdx#secretflow.device.device.spu.SPUObject "secretflow.device.device.spu.SPUObject") | List\[[secretflow.device.device.pyu.PYUObject](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYUObject "secretflow.device.device.pyu.PYUObject")]
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="attribute" target={"secretflow.ml.linear.linear_model.LinearModel.reg_type"} module={"secretflow.ml.linear.linear_model"} fullname={"LinearModel.reg_type"} parameters={["weights", "reg_type", "sig_type"]} description={"RegType\nlinear regression or logistic regression model."}>
      <Outline.Signature fullname="LinearModel.reg_type" id="secretflow.ml.linear.linear_model.LinearModel.reg_type">
        <Outline.Name>reg\_type</Outline.Name>
      </Outline.Signature>

      <Outline.Content>
        RegType
        linear regression or logistic regression model.

        <FieldList>
          <dl>
            <dt className="field-name">
              Type
            </dt>

            <dd className="field-body">
              [secretflow.ml.linear.linear\_model.RegType](#secretflow.ml.linear.linear_model.RegType "secretflow.ml.linear.linear_model.RegType")
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="attribute" target={"secretflow.ml.linear.linear_model.LinearModel.sig_type"} module={"secretflow.ml.linear.linear_model"} fullname={"LinearModel.sig_type"} parameters={["weights", "reg_type", "sig_type"]} description={"SigType\nwhich sigmoid approximation should use, only use in mpc lr."}>
      <Outline.Signature fullname="LinearModel.sig_type" id="secretflow.ml.linear.linear_model.LinearModel.sig_type">
        <Outline.Name>sig\_type</Outline.Name>
      </Outline.Signature>

      <Outline.Content>
        SigType
        which sigmoid approximation should use, only use in mpc lr.

        <FieldList>
          <dl>
            <dt className="field-name">
              Type
            </dt>

            <dd className="field-body">
              [secretflow.utils.sigmoid.SigType](secretflow.utils.mdx#secretflow.utils.sigmoid.SigType "secretflow.utils.sigmoid.SigType")
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>

    <strong>Attributes:</strong>

    <table>
      <tbody>
        <tr>
          <td>
            [`weights`](#id0 "secretflow.ml.linear.linear_model.LinearModel.weights")
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [`reg_type`](#id5 "secretflow.ml.linear.linear_model.LinearModel.reg_type")
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [`sig_type`](#id6 "secretflow.ml.linear.linear_model.LinearModel.sig_type")
          </td>

          <td>

          </td>
        </tr>
      </tbody>
    </table>

    <strong>Methods:</strong>

    <table>
      <tbody>
        <tr>
          <td>
            [`__init__`](#secretflow.ml.linear.linear_model.LinearModel.__init__ "secretflow.ml.linear.linear_model.LinearModel.__init__")(weights, reg\_type, sig\_type)
          </td>

          <td>

          </td>
        </tr>
      </tbody>
    </table>

    <Outline domain="py" objectType="attribute" target={"id0"} module={"secretflow.ml.linear.linear_model"} fullname={"LinearModel.weights"} parameters={["weights", "reg_type", "sig_type"]} description={"Bases: object"}>
      <Outline.Signature fullname="LinearModel.weights" id="id0">
        <Outline.Name>weights</Outline.Name><Outline.Keyword><span>:</span><span>{" "}</span>[SPUObject](secretflow.device.device.device.mdx#secretflow.device.device.spu.SPUObject "secretflow.device.device.spu.SPUObject")<span>{" "}</span><span>|</span><span>{" "}</span>[List](https://docs.python.org/3/library/typing.html#typing.List "(in Python v3.11)")<span>\[</span>[PYUObject](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYUObject "secretflow.device.device.pyu.PYUObject")<span>]</span></Outline.Keyword>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="attribute" target={"id5"} module={"secretflow.ml.linear.linear_model"} fullname={"LinearModel.reg_type"} parameters={["weights", "reg_type", "sig_type"]} description={"Bases: object"}>
      <Outline.Signature fullname="LinearModel.reg_type" id="id5">
        <Outline.Name>reg\_type</Outline.Name><Outline.Keyword><span>:</span><span>{" "}</span>[RegType](#secretflow.ml.linear.linear_model.RegType "secretflow.ml.linear.linear_model.RegType")</Outline.Keyword>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="attribute" target={"id6"} module={"secretflow.ml.linear.linear_model"} fullname={"LinearModel.sig_type"} parameters={["weights", "reg_type", "sig_type"]} description={"Bases: object"}>
      <Outline.Signature fullname="LinearModel.sig_type" id="id6">
        <Outline.Name>sig\_type</Outline.Name><Outline.Keyword><span>:</span><span>{" "}</span>[SigType](secretflow.utils.mdx#secretflow.utils.sigmoid.SigType "secretflow.utils.sigmoid.SigType")</Outline.Keyword>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.linear_model.LinearModel.__init__"} module={"secretflow.ml.linear.linear_model"} fullname={"LinearModel.__init__"} parameters={["weights", "reg_type", "sig_type"]} description={"Bases: object"}>
      <Outline.Signature fullname="LinearModel.__init__" id="secretflow.ml.linear.linear_model.LinearModel.__init__">
        <Outline.Name>\_\_init\_\_</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">weights</span><span>:</span><span>{" "}</span><span className="name">[SPUObject](secretflow.device.device.device.mdx#secretflow.device.device.spu.SPUObject "secretflow.device.device.spu.SPUObject")<span>{" "}</span><span>|</span><span>{" "}</span>[List](https://docs.python.org/3/library/typing.html#typing.List "(in Python v3.11)")<span>\[</span>[PYUObject](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYUObject "secretflow.device.device.pyu.PYUObject")<span>]</span></span></Outline.Parameter>, <Outline.Parameter><span className="name">reg\_type</span><span>:</span><span>{" "}</span><span className="name">[RegType](#secretflow.ml.linear.linear_model.RegType "secretflow.ml.linear.linear_model.RegType")</span></Outline.Parameter>, <Outline.Parameter><span className="name">sig\_type</span><span>:</span><span>{" "}</span><span className="name">[SigType](secretflow.utils.mdx#secretflow.utils.sigmoid.SigType "secretflow.utils.sigmoid.SigType")</span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.11)")</Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content />
    </Outline>
  </Outline.Content>
</Outline>

:target{id="module-secretflow.ml.linear"}

## Module contents

<strong>Classes:</strong>

<table>
  <tbody>
    <tr>
      <td>
        [`FlLogisticRegressionMix`](#secretflow.ml.linear.FlLogisticRegressionMix "secretflow.ml.linear.FlLogisticRegressionMix")()
      </td>

      <td>
        SGD based logistic regression for mix partitioned data.
      </td>
    </tr>

    <tr>
      <td>
        [`FlLogisticRegressionVertical`](#secretflow.ml.linear.FlLogisticRegressionVertical "secretflow.ml.linear.FlLogisticRegressionVertical")(devices, ...\[, ...])
      </td>

      <td>
        Vertical logistic regression.
      </td>
    </tr>

    <tr>
      <td>
        [`HESSLogisticRegression`](#secretflow.ml.linear.HESSLogisticRegression "secretflow.ml.linear.HESSLogisticRegression")(spu, heu\_x, heu\_y)
      </td>

      <td>
        This method provides logistic regression linear models for vertical split dataset setting by using secret sharing and homomorphic encryption with mini batch SGD training solver.
      </td>
    </tr>

    <tr>
      <td>
        [`SSRegression`](#secretflow.ml.linear.SSRegression "secretflow.ml.linear.SSRegression")(spu)
      </td>

      <td>
        This method provides both linear and logistic regression linear models for vertical split dataset setting by using secret sharing with mini batch SGD training solver.
      </td>
    </tr>

    <tr>
      <td>
        [`LinearModel`](#secretflow.ml.linear.LinearModel "secretflow.ml.linear.LinearModel")(weights, reg\_type, sig\_type)
      </td>

      <td>
        Unified linear regression model.
      </td>
    </tr>

    <tr>
      <td>
        [`RegType`](#secretflow.ml.linear.RegType "secretflow.ml.linear.RegType")(value)
      </td>

      <td>
        An enumeration.
      </td>
    </tr>

    <tr>
      <td>
        [`SSGLM`](#secretflow.ml.linear.SSGLM "secretflow.ml.linear.SSGLM")(spu)
      </td>

      <td>

      </td>
    </tr>
  </tbody>
</table>

<Outline domain="py" objectType="class" target={"secretflow.ml.linear.FlLogisticRegressionMix"} module={"secretflow.ml.linear"} fullname={"FlLogisticRegressionMix"} description={"Bases: object"}>
  <Outline.Signature fullname="FlLogisticRegressionMix" id="secretflow.ml.linear.FlLogisticRegressionMix">
    <Outline.Keyword>class<span>{" "}</span></Outline.Keyword><Outline.Prefix>secretflow\.ml.linear.</Outline.Prefix><Outline.Name>FlLogisticRegressionMix</Outline.Name>
  </Outline.Signature>

  <Outline.Content>
    Bases: [`object`](https://docs.python.org/3/library/functions.html#object "(in Python v3.11)")

    SGD based logistic regression for mix partitioned data.

    The following is an example to illustrate the algorithm.

    Suppose alice has features and label,  while bob/carol/dave have features
    only.

    The perspective of MixDataFrame X is as follows:

    <table>
      <tbody>
        <tr>
          <td colSpan={4}>
            X
          </td>
        </tr>

        <tr>
          <td>
            VDataFrame\_0
          </td>

          <td>
            alice\_x0
          </td>

          <td>
            bob\_x
          </td>

          <td>
            dave\_x0
          </td>
        </tr>

        <tr>
          <td>
            VDataFrame\_1
          </td>

          <td>
            alice\_x1
          </td>

          <td>
            carol\_x
          </td>

          <td>
            dave\_x1
          </td>
        </tr>
      </tbody>
    </table>

    The perspective of MixDataFrame Y is as follows:

    <table>
      <tbody>
        <tr>
          <td colSpan={2}>
            Y
          </td>
        </tr>

        <tr>
          <td>
            VDataFrame\_0
          </td>

          <td>
            alice\_y0
          </td>
        </tr>

        <tr>
          <td>
            VDataFrame\_1
          </td>

          <td>
            alice\_y1
          </td>
        </tr>
      </tbody>
    </table>

    When fitted with the X and Y, two
    [`FlLogisticRegressionVertical`](#secretflow.ml.linear.FlLogisticRegressionVertical "secretflow.ml.linear.FlLogisticRegressionVertical") instances
    are constructed. The first one will be fitted with VDataFrame\_0 of X and Y,
    while the second one will be fitted with  VDataFrame\_1 of X and Y,.

    The main steps of one epoch are:

    1. The <cite>FlLogisticRegressionVertical</cite> are fitted with the <cite>VDataFrame</cite> of X
       and Y respectly.
    2. Aggregate <InlineMath>${\theta}$</InlineMath> of the <cite>FlLogisticRegressionVertical</cite> with
       [`SecureAggregator`](secretflow.security.security.aggregation.mdx#secretflow.security.aggregation.SecureAggregator "secretflow.security.aggregation.SecureAggregator").
    3. Send aggregated <InlineMath>${\theta}$</InlineMath> to the <cite>FlLogisticRegressionVertical</cite>.

    <strong>Methods:</strong>

    <table>
      <tbody>
        <tr>
          <td>
            [`fit`](#secretflow.ml.linear.FlLogisticRegressionMix.fit "secretflow.ml.linear.FlLogisticRegressionMix.fit")(x, y, batch\_size, epochs, aggregators, heus)
          </td>

          <td>
            Fit the model.
          </td>
        </tr>

        <tr>
          <td>
            [`predict`](#secretflow.ml.linear.FlLogisticRegressionMix.predict "secretflow.ml.linear.FlLogisticRegressionMix.predict")(x)
          </td>

          <td>
            Predict the score.
          </td>
        </tr>
      </tbody>
    </table>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.FlLogisticRegressionMix.fit"} module={"secretflow.ml.linear"} fullname={"FlLogisticRegressionMix.fit"} description={"Fit the model."} parameters={["x", "y", "batch_size", "epochs", "aggregators", "heus", "fxp_bits", "tol", "learning_rate", "agg_epochs", "audit_log_dir", "aggr_hooks"]}>
      <Outline.Signature fullname="FlLogisticRegressionMix.fit" id="secretflow.ml.linear.FlLogisticRegressionMix.fit">
        <Outline.Name>fit</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">x</span><span>:</span><span>{" "}</span><span className="name">[MixDataFrame](secretflow.data.data.mix.mdx#secretflow.data.mix.dataframe.MixDataFrame "secretflow.data.mix.dataframe.MixDataFrame")</span></Outline.Parameter>, <Outline.Parameter><span className="name">y</span><span>:</span><span>{" "}</span><span className="name">[MixDataFrame](secretflow.data.data.mix.mdx#secretflow.data.mix.dataframe.MixDataFrame "secretflow.data.mix.dataframe.MixDataFrame")</span></Outline.Parameter>, <Outline.Parameter><span className="name">batch\_size</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.11)")</span></Outline.Parameter>, <Outline.Parameter><span className="name">epochs</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.11)")</span></Outline.Parameter>, <Outline.Parameter><span className="name">aggregators</span><span>:</span><span>{" "}</span><span className="name">[List](https://docs.python.org/3/library/typing.html#typing.List "(in Python v3.11)")<span>\[</span>[Aggregator](secretflow.security.security.aggregation.mdx#secretflow.security.aggregation.aggregator.Aggregator "secretflow.security.aggregation.aggregator.Aggregator")<span>]</span></span></Outline.Parameter>, <Outline.Parameter><span className="name">heus</span><span>:</span><span>{" "}</span><span className="name">[List](https://docs.python.org/3/library/typing.html#typing.List "(in Python v3.11)")<span>\[</span>[HEU](secretflow.device.device.device.mdx#secretflow.device.device.heu.HEU "secretflow.device.device.heu.HEU")<span>]</span></span></Outline.Parameter>, <Outline.Parameter><span className="name">fxp\_bits</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.11)")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>18</span></Outline.Parameter>, <Outline.Parameter><span className="name">tol</span><span>:</span><span>{" "}</span><span className="name">[float](https://docs.python.org/3/library/functions.html#float "(in Python v3.11)")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>0.0001</span></Outline.Parameter>, <Outline.Parameter><span className="name">learning\_rate</span><span>:</span><span>{" "}</span><span className="name">[float](https://docs.python.org/3/library/functions.html#float "(in Python v3.11)")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>0.1</span></Outline.Parameter>, <Outline.Parameter><span className="name">agg\_epochs</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.11)")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>1</span></Outline.Parameter>, <Outline.Parameter><span className="name">audit\_log\_dir</span><span>:</span><span>{" "}</span><span className="name">[Dict](https://docs.python.org/3/library/typing.html#typing.Dict "(in Python v3.11)")<span>\[</span>[PYU](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYU "secretflow.device.device.pyu.PYU")<span>,</span><span>{" "}</span>[str](https://docs.python.org/3/library/stdtypes.html#str "(in Python v3.11)")<span>]</span><span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter>, <Outline.Parameter><span className="name">aggr\_hooks</span><span>:</span><span>{" "}</span><span className="name">[List](https://docs.python.org/3/library/typing.html#typing.List "(in Python v3.11)")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content>
        Fit the model.

        <FieldList>
          <dl>
            <dt className="field-name">
              Parameters
            </dt>

            <dd className="field-body">
              - <Outline.ParameterTarget>x</Outline.ParameterTarget> – training vector. X should be a horizontal partitioned
                [`MixDataFrame`](secretflow.data.data.mix.mdx#secretflow.data.mix.MixDataFrame "secretflow.data.mix.MixDataFrame"), which consists
                of \:py\:class:<del id="id8">\`</del>\~secretflow\.data.vertical.VDataFrame\`s.
              - <Outline.ParameterTarget>y</Outline.ParameterTarget> – target vector relative to x. Y should be a horizontal partitioned
                [`MixDataFrame`](secretflow.data.data.mix.mdx#secretflow.data.mix.MixDataFrame "secretflow.data.mix.MixDataFrame") alos. X and y
                should have the same amount of <del id="id10">\`</del>VDataFrame\`s.
              - <Outline.ParameterTarget>batch\_size</Outline.ParameterTarget> – number of samples per gradient update.
              - <Outline.ParameterTarget>epochs</Outline.ParameterTarget> – number of epochs to train the model.
              - <Outline.ParameterTarget>aggregators</Outline.ParameterTarget> – aggregator used to compute vertical lr. Amount of
                aggregators should be same as the <cite>VDataFrame</cite> of X.
              - <Outline.ParameterTarget>heus</Outline.ParameterTarget> – a list of heu used to compute vertical lr. Amount of
                heus should be same as the <cite>VDataFrame</cite> of X.
              - <Outline.ParameterTarget>fxp\_bits</Outline.ParameterTarget> – the fraction bit length for encoding before sending to
                heu device. Defaults to spu\_fxp\_precision(spu.spu\_pb2.FM64).
              - <Outline.ParameterTarget>tol</Outline.ParameterTarget> – optional, tolerance for stopping criteria. Defaults to 1e-4.
              - <Outline.ParameterTarget>learning\_rate</Outline.ParameterTarget> – optional, learning rate. Defaults to 0.1.
              - <Outline.ParameterTarget>agg\_epochs</Outline.ParameterTarget> – aggregate weights for every \{agg\_epochs} epochs.
                Defaults to 1.
              - <Outline.ParameterTarget>audit\_log\_dir</Outline.ParameterTarget> – a dict specifying the audit log directory for each
                device. No audit log if is None. Default to None.
                Please leave it None unless you are very sure what the audit
                does and accept the risk.
              - <Outline.ParameterTarget>aggr\_hooks</Outline.ParameterTarget> – The hooks called on each aggregation
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.FlLogisticRegressionMix.predict"} module={"secretflow.ml.linear"} fullname={"FlLogisticRegressionMix.predict"} description={"Predict the score."} parameters={["x"]}>
      <Outline.Signature fullname="FlLogisticRegressionMix.predict" id="secretflow.ml.linear.FlLogisticRegressionMix.predict">
        <Outline.Name>predict</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">x</span><span>:</span><span>{" "}</span><span className="name">[MixDataFrame](secretflow.data.data.mix.mdx#secretflow.data.mix.dataframe.MixDataFrame "secretflow.data.mix.dataframe.MixDataFrame")</span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[List](https://docs.python.org/3/library/typing.html#typing.List "(in Python v3.11)")<span>\[</span>[PYUObject](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYUObject "secretflow.device.device.pyu.PYUObject")<span>]</span></Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content>
        Predict the score.

        <FieldList>
          <dl>
            <dt className="field-name">
              Parameters
            </dt>

            <dd className="field-body">
              <Outline.ParameterTarget>x</Outline.ParameterTarget> – the samples to predict.
            </dd>

            <dt className="field-name">
              Returns
            </dt>

            <dd className="field-body">
              a list of PYUObjects holding prediction results.
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>
  </Outline.Content>
</Outline>

<Outline domain="py" objectType="class" target={"secretflow.ml.linear.FlLogisticRegressionVertical"} module={"secretflow.ml.linear"} fullname={"FlLogisticRegressionVertical"} parameters={["devices", "aggregator", "heu", "fxp_bits", "audit_log_dir"]} description={"Bases: object"}>
  <Outline.Signature fullname="FlLogisticRegressionVertical" id="secretflow.ml.linear.FlLogisticRegressionVertical">
    <Outline.Keyword>class<span>{" "}</span></Outline.Keyword><Outline.Prefix>secretflow\.ml.linear.</Outline.Prefix><Outline.Name>FlLogisticRegressionVertical</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">devices</span><span>:</span><span>{" "}</span><span className="name">[List](https://docs.python.org/3/library/typing.html#typing.List "(in Python v3.11)")<span>\[</span>[PYU](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYU "secretflow.device.device.pyu.PYU")<span>]</span></span></Outline.Parameter>, <Outline.Parameter><span className="name">aggregator</span><span>:</span><span>{" "}</span><span className="name">[Aggregator](secretflow.security.security.aggregation.mdx#secretflow.security.aggregation.aggregator.Aggregator "secretflow.security.aggregation.aggregator.Aggregator")</span></Outline.Parameter>, <Outline.Parameter><span className="name">heu</span><span>:</span><span>{" "}</span><span className="name">[HEU](secretflow.device.device.device.mdx#secretflow.device.device.heu.HEU "secretflow.device.device.heu.HEU")</span></Outline.Parameter>, <Outline.Parameter><span className="name">fxp\_bits</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.11)")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>18</span></Outline.Parameter>, <Outline.Parameter><span className="name">audit\_log\_dir</span><span>:</span><span>{" "}</span><span className="name">[Dict](https://docs.python.org/3/library/typing.html#typing.Dict "(in Python v3.11)")<span>\[</span>[PYU](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYU "secretflow.device.device.pyu.PYU")<span>,</span><span>{" "}</span>[str](https://docs.python.org/3/library/stdtypes.html#str "(in Python v3.11)")<span>]</span><span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter><span>)</span></Outline.ParameterList>
  </Outline.Signature>

  <Outline.Content>
    Bases: [`object`](https://docs.python.org/3/library/functions.html#object "(in Python v3.11)")

    Vertical logistic regression.

    Implement the basic SGD based logistic regression among multiple vertical
    participants.

    To explain this algorithm, suppose alice has features and label, while bob
    and charlie have features only.
    The main steps of SGD are:

    1. Alice does prediction using secure aggregation.
    2. Alice sends the residual to bob/charlie in HE(Homomorphic Encryption)
       ciphertext.
    3. Bob and charlie compute gradients in HE ciphertext and send masked
       gradients to alice.
    4. Alice decrypts the masked gradients and send them back to bob/charlie.
    5. Bob and charlie unmask gradients and update their weights independently.
    6. Alice updates its weights also.

    <strong>Methods:</strong>

    <table>
      <tbody>
        <tr>
          <td>
            [`__init__`](#secretflow.ml.linear.FlLogisticRegressionVertical.__init__ "secretflow.ml.linear.FlLogisticRegressionVertical.__init__")(devices, aggregator, heu\[, ...])
          </td>

          <td>
            Init VanillaVerLogisticRegression.
          </td>
        </tr>

        <tr>
          <td>
            [`init_train_data`](#secretflow.ml.linear.FlLogisticRegressionVertical.init_train_data "secretflow.ml.linear.FlLogisticRegressionVertical.init_train_data")(x, y, epochs, batch\_size\[, ...])
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [`predict`](#secretflow.ml.linear.FlLogisticRegressionVertical.predict "secretflow.ml.linear.FlLogisticRegressionVertical.predict")(x)
          </td>

          <td>
            Predict the score.
          </td>
        </tr>

        <tr>
          <td>
            [`compute_loss`](#secretflow.ml.linear.FlLogisticRegressionVertical.compute_loss "secretflow.ml.linear.FlLogisticRegressionVertical.compute_loss")(x, y\[, avg\_flag])
          </td>

          <td>
            Compute the loss.
          </td>
        </tr>

        <tr>
          <td>
            [`get_weight`](#secretflow.ml.linear.FlLogisticRegressionVertical.get_weight "secretflow.ml.linear.FlLogisticRegressionVertical.get_weight")()
          </td>

          <td>
            Get weight from this estimator.
          </td>
        </tr>

        <tr>
          <td>
            [`set_weight`](#secretflow.ml.linear.FlLogisticRegressionVertical.set_weight "secretflow.ml.linear.FlLogisticRegressionVertical.set_weight")(weight)
          </td>

          <td>
            Set weight to this estimator.
          </td>
        </tr>

        <tr>
          <td>
            [`fit`](#secretflow.ml.linear.FlLogisticRegressionVertical.fit "secretflow.ml.linear.FlLogisticRegressionVertical.fit")(x, y, batch\_size, epochs\[, tol, ...])
          </td>

          <td>
            Fit the model.
          </td>
        </tr>

        <tr>
          <td>
            [`fit_in_steps`](#secretflow.ml.linear.FlLogisticRegressionVertical.fit_in_steps "secretflow.ml.linear.FlLogisticRegressionVertical.fit_in_steps")(n\_step, learning\_rate, epoch)
          </td>

          <td>
            Fit in steps.
          </td>
        </tr>
      </tbody>
    </table>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.FlLogisticRegressionVertical.__init__"} module={"secretflow.ml.linear"} fullname={"FlLogisticRegressionVertical.__init__"} parameters={["devices", "aggregator", "heu", "fxp_bits", "audit_log_dir"]} description={"Init VanillaVerLogisticRegression."}>
      <Outline.Signature fullname="FlLogisticRegressionVertical.__init__" id="secretflow.ml.linear.FlLogisticRegressionVertical.__init__">
        <Outline.Name>\_\_init\_\_</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">devices</span><span>:</span><span>{" "}</span><span className="name">[List](https://docs.python.org/3/library/typing.html#typing.List "(in Python v3.11)")<span>\[</span>[PYU](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYU "secretflow.device.device.pyu.PYU")<span>]</span></span></Outline.Parameter>, <Outline.Parameter><span className="name">aggregator</span><span>:</span><span>{" "}</span><span className="name">[Aggregator](secretflow.security.security.aggregation.mdx#secretflow.security.aggregation.aggregator.Aggregator "secretflow.security.aggregation.aggregator.Aggregator")</span></Outline.Parameter>, <Outline.Parameter><span className="name">heu</span><span>:</span><span>{" "}</span><span className="name">[HEU](secretflow.device.device.device.mdx#secretflow.device.device.heu.HEU "secretflow.device.device.heu.HEU")</span></Outline.Parameter>, <Outline.Parameter><span className="name">fxp\_bits</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.11)")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>18</span></Outline.Parameter>, <Outline.Parameter><span className="name">audit\_log\_dir</span><span>:</span><span>{" "}</span><span className="name">[Dict](https://docs.python.org/3/library/typing.html#typing.Dict "(in Python v3.11)")<span>\[</span>[PYU](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYU "secretflow.device.device.pyu.PYU")<span>,</span><span>{" "}</span>[str](https://docs.python.org/3/library/stdtypes.html#str "(in Python v3.11)")<span>]</span><span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content>
        Init VanillaVerLogisticRegression.

        <FieldList>
          <dl>
            <dt className="field-name">
              Parameters
            </dt>

            <dd className="field-body">
              - <Outline.ParameterTarget>devices</Outline.ParameterTarget> – a list of PYU devices taking part in the computation.
              - <Outline.ParameterTarget>aggregator</Outline.ParameterTarget> – the aggregator instance.
              - <Outline.ParameterTarget>heu</Outline.ParameterTarget> – the heu device instance.
              - <Outline.ParameterTarget>fxp\_bits</Outline.ParameterTarget> – the fraction bit length for encoding before send to
                heu device. Defaults to spu\_fxp\_precision(spu.spu\_pb2.FM64).
              - <Outline.ParameterTarget>audit\_log\_dir</Outline.ParameterTarget> – a dict specifying the audit log directory for each
                device. No audit log if is None. Default to None.
                Please leave it None unless you are very sure what the audit
                does and accept the risk.
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.FlLogisticRegressionVertical.init_train_data"} module={"secretflow.ml.linear"} fullname={"FlLogisticRegressionVertical.init_train_data"} parameters={["x", "y", "epochs", "batch_size", "shuffle_seed"]} description={"Bases: object"}>
      <Outline.Signature fullname="FlLogisticRegressionVertical.init_train_data" id="secretflow.ml.linear.FlLogisticRegressionVertical.init_train_data">
        <Outline.Name>init\_train\_data</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">x</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.mdx#secretflow.data.ndarray.FedNdarray "secretflow.data.ndarray.FedNdarray")</span></Outline.Parameter>, <Outline.Parameter><span className="name">y</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.mdx#secretflow.data.ndarray.FedNdarray "secretflow.data.ndarray.FedNdarray")</span></Outline.Parameter>, <Outline.Parameter><span className="name">epochs</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.11)")</span></Outline.Parameter>, <Outline.Parameter><span className="name">batch\_size</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.11)")</span></Outline.Parameter>, <Outline.Parameter><span className="name">shuffle\_seed</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.11)")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.FlLogisticRegressionVertical.predict"} module={"secretflow.ml.linear"} fullname={"FlLogisticRegressionVertical.predict"} parameters={["x"]} description={"Predict the score."}>
      <Outline.Signature fullname="FlLogisticRegressionVertical.predict" id="secretflow.ml.linear.FlLogisticRegressionVertical.predict">
        <Outline.Name>predict</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">x</span><span>:</span><span>{" "}</span><span className="name">[VDataFrame](secretflow.data.data.vertical.mdx#secretflow.data.vertical.dataframe.VDataFrame "secretflow.data.vertical.dataframe.VDataFrame")<span>{" "}</span><span>|</span><span>{" "}</span>[FedNdarray](secretflow.data.mdx#secretflow.data.ndarray.FedNdarray "secretflow.data.ndarray.FedNdarray")<span>{" "}</span><span>|</span><span>{" "}</span>[List](https://docs.python.org/3/library/typing.html#typing.List "(in Python v3.11)")<span>\[</span>[PYUObject](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYUObject "secretflow.device.device.pyu.PYUObject")<span>]</span></span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[PYUObject](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYUObject "secretflow.device.device.pyu.PYUObject")</Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content>
        Predict the score.

        <FieldList>
          <dl>
            <dt className="field-name">
              Parameters
            </dt>

            <dd className="field-body">
              <Outline.ParameterTarget>x</Outline.ParameterTarget> – the samples to predict.
            </dd>

            <dt className="field-name">
              Returns
            </dt>

            <dd className="field-body">
              a PYUObject holds prediction results.
            </dd>

            <dt className="field-name">
              Return type
            </dt>

            <dd className="field-body">
              [PYUObject](secretflow.mdx#secretflow.PYUObject "secretflow.PYUObject")
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.FlLogisticRegressionVertical.compute_loss"} module={"secretflow.ml.linear"} fullname={"FlLogisticRegressionVertical.compute_loss"} parameters={["x", "y", "avg_flag"]} description={"Compute the loss."}>
      <Outline.Signature fullname="FlLogisticRegressionVertical.compute_loss" id="secretflow.ml.linear.FlLogisticRegressionVertical.compute_loss">
        <Outline.Name>compute\_loss</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">x</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.mdx#secretflow.data.ndarray.FedNdarray "secretflow.data.ndarray.FedNdarray")</span></Outline.Parameter>, <Outline.Parameter><span className="name">y</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.mdx#secretflow.data.ndarray.FedNdarray "secretflow.data.ndarray.FedNdarray")</span></Outline.Parameter>, <Outline.Parameter><span className="name">avg\_flag</span><span>:</span><span>{" "}</span><span className="name">[bool](https://docs.python.org/3/library/functions.html#bool "(in Python v3.11)")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>True</span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[PYUObject](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYUObject "secretflow.device.device.pyu.PYUObject")</Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content>
        Compute the loss.

        <FieldList>
          <dl>
            <dt className="field-name">
              Parameters
            </dt>

            <dd className="field-body">
              - <Outline.ParameterTarget>x</Outline.ParameterTarget> – the samples.
              - <Outline.ParameterTarget>y</Outline.ParameterTarget> – the label.
              - <Outline.ParameterTarget>avg\_flag</Outline.ParameterTarget> – whether dividing the sample number. Defaults to True.
            </dd>

            <dt className="field-name">
              Returns
            </dt>

            <dd className="field-body">
              a PYUObject holds loss value.
            </dd>

            <dt className="field-name">
              Return type
            </dt>

            <dd className="field-body">
              [PYUObject](secretflow.mdx#secretflow.PYUObject "secretflow.PYUObject")
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.FlLogisticRegressionVertical.get_weight"} module={"secretflow.ml.linear"} fullname={"FlLogisticRegressionVertical.get_weight"} parameters={[]} description={"Get weight from this estimator."}>
      <Outline.Signature fullname="FlLogisticRegressionVertical.get_weight" id="secretflow.ml.linear.FlLogisticRegressionVertical.get_weight">
        <Outline.Name>get\_weight</Outline.Name><Outline.ParameterList><span>(</span><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[Dict](https://docs.python.org/3/library/typing.html#typing.Dict "(in Python v3.11)")<span>\[</span>[PYU](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYU "secretflow.device.device.pyu.PYU")<span>,</span><span>{" "}</span>[PYUObject](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYUObject "secretflow.device.device.pyu.PYUObject")<span>]</span></Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content>
        Get weight from this estimator.

        <FieldList>
          <dl>
            <dt className="field-name">
              Returns
            </dt>

            <dd className="field-body">
              A dict of pyu and its weight. Note that the intecept(w0)
              is the first column of the label deivce weight.
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.FlLogisticRegressionVertical.set_weight"} module={"secretflow.ml.linear"} fullname={"FlLogisticRegressionVertical.set_weight"} parameters={["weight"]} description={"Set weight to this estimator."}>
      <Outline.Signature fullname="FlLogisticRegressionVertical.set_weight" id="secretflow.ml.linear.FlLogisticRegressionVertical.set_weight">
        <Outline.Name>set\_weight</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">weight</span><span>:</span><span>{" "}</span><span className="name">[Dict](https://docs.python.org/3/library/typing.html#typing.Dict "(in Python v3.11)")<span>\[</span>[PYU](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYU "secretflow.device.device.pyu.PYU")<span>,</span><span>{" "}</span>[PYUObject](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYUObject "secretflow.device.device.pyu.PYUObject")<span>{" "}</span><span>|</span><span>{" "}</span>[ndarray](https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray "(in NumPy v1.25)")<span>]</span></span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content>
        Set weight to this estimator.

        <FieldList>
          <dl>
            <dt className="field-name">
              Parameters
            </dt>

            <dd className="field-body">
              <Outline.ParameterTarget>weight</Outline.ParameterTarget> – a dict of pyu and its weight.
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.FlLogisticRegressionVertical.fit"} module={"secretflow.ml.linear"} fullname={"FlLogisticRegressionVertical.fit"} parameters={["x", "y", "batch_size", "epochs", "tol", "learning_rate"]} description={"Fit the model."}>
      <Outline.Signature fullname="FlLogisticRegressionVertical.fit" id="secretflow.ml.linear.FlLogisticRegressionVertical.fit">
        <Outline.Name>fit</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">x</span><span>:</span><span>{" "}</span><span className="name">[VDataFrame](secretflow.data.data.vertical.mdx#secretflow.data.vertical.dataframe.VDataFrame "secretflow.data.vertical.dataframe.VDataFrame")<span>{" "}</span><span>|</span><span>{" "}</span>[FedNdarray](secretflow.data.mdx#secretflow.data.ndarray.FedNdarray "secretflow.data.ndarray.FedNdarray")</span></Outline.Parameter>, <Outline.Parameter><span className="name">y</span><span>:</span><span>{" "}</span><span className="name">[VDataFrame](secretflow.data.data.vertical.mdx#secretflow.data.vertical.dataframe.VDataFrame "secretflow.data.vertical.dataframe.VDataFrame")<span>{" "}</span><span>|</span><span>{" "}</span>[FedNdarray](secretflow.data.mdx#secretflow.data.ndarray.FedNdarray "secretflow.data.ndarray.FedNdarray")</span></Outline.Parameter>, <Outline.Parameter><span className="name">batch\_size</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.11)")</span></Outline.Parameter>, <Outline.Parameter><span className="name">epochs</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.11)")</span></Outline.Parameter>, <Outline.Parameter><span className="name">tol</span><span>:</span><span>{" "}</span><span className="name">[float](https://docs.python.org/3/library/functions.html#float "(in Python v3.11)")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>0.0001</span></Outline.Parameter>, <Outline.Parameter><span className="name">learning\_rate</span><span>:</span><span>{" "}</span><span className="name">[float](https://docs.python.org/3/library/functions.html#float "(in Python v3.11)")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>0.1</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content>
        Fit the model.

        <FieldList>
          <dl>
            <dt className="field-name">
              Parameters
            </dt>

            <dd className="field-body">
              - <Outline.ParameterTarget>x</Outline.ParameterTarget> – training vector.
              - <Outline.ParameterTarget>y</Outline.ParameterTarget> – target vector relative to x.
              - <Outline.ParameterTarget>batch\_size</Outline.ParameterTarget> – number of samples per gradient update.
              - <Outline.ParameterTarget>epochs</Outline.ParameterTarget> – number of epochs to train the model.
              - <Outline.ParameterTarget>tol</Outline.ParameterTarget> – optional, tolerance for stopping criteria. Defaults to 1e-4.
              - <Outline.ParameterTarget>learning\_rate</Outline.ParameterTarget> – optional, learning rate. Defaults to 0.1.
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.FlLogisticRegressionVertical.fit_in_steps"} module={"secretflow.ml.linear"} fullname={"FlLogisticRegressionVertical.fit_in_steps"} parameters={["n_step", "learning_rate", "epoch"]} description={"Fit in steps."}>
      <Outline.Signature fullname="FlLogisticRegressionVertical.fit_in_steps" id="secretflow.ml.linear.FlLogisticRegressionVertical.fit_in_steps">
        <Outline.Name>fit\_in\_steps</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">n\_step</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.11)")</span></Outline.Parameter>, <Outline.Parameter><span className="name">learning\_rate</span><span>:</span><span>{" "}</span><span className="name">[float](https://docs.python.org/3/library/functions.html#float "(in Python v3.11)")</span></Outline.Parameter>, <Outline.Parameter><span className="name">epoch</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.11)")</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content>
        Fit in steps.

        <FieldList>
          <dl>
            <dt className="field-name">
              Parameters
            </dt>

            <dd className="field-body">
              - <Outline.ParameterTarget>n\_step</Outline.ParameterTarget> – the number of steps.
              - <Outline.ParameterTarget>learning\_rate</Outline.ParameterTarget> – learning rate.
              - <Outline.ParameterTarget>epoch</Outline.ParameterTarget> – the current epoch.
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>
  </Outline.Content>
</Outline>

<Outline domain="py" objectType="class" target={"secretflow.ml.linear.HESSLogisticRegression"} module={"secretflow.ml.linear"} fullname={"HESSLogisticRegression"} parameters={["spu", "heu_x", "heu_y"]} description={"Bases: object"}>
  <Outline.Signature fullname="HESSLogisticRegression" id="secretflow.ml.linear.HESSLogisticRegression">
    <Outline.Keyword>class<span>{" "}</span></Outline.Keyword><Outline.Prefix>secretflow\.ml.linear.</Outline.Prefix><Outline.Name>HESSLogisticRegression</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">spu</span><span>:</span><span>{" "}</span><span className="name">[SPU](secretflow.device.device.device.mdx#secretflow.device.device.spu.SPU "secretflow.device.device.spu.SPU")</span></Outline.Parameter>, <Outline.Parameter><span className="name">heu\_x</span><span>:</span><span>{" "}</span><span className="name">[HEU](secretflow.device.device.device.mdx#secretflow.device.device.heu.HEU "secretflow.device.device.heu.HEU")</span></Outline.Parameter>, <Outline.Parameter><span className="name">heu\_y</span><span>:</span><span>{" "}</span><span className="name">[HEU](secretflow.device.device.device.mdx#secretflow.device.device.heu.HEU "secretflow.device.device.heu.HEU")</span></Outline.Parameter><span>)</span></Outline.ParameterList>
  </Outline.Signature>

  <Outline.Content>
    Bases: [`object`](https://docs.python.org/3/library/functions.html#object "(in Python v3.11)")

    This method provides logistic regression linear models for vertical split dataset
    setting by using secret sharing and homomorphic encryption with mini batch SGD
    training solver. HESS-SGD is short for HE & secret sharing SGD training.

    During the calculation process, the HEU is used to protect the weights and
    calculate the predicted y, and the SPU is used to calculate the sigmoid and gradient.

    SPU is a verifiable and measurable secure computing device that running
    under various MPC protocols to provide provable security. More detail:
    [https://www.secretflow.org.cn/docs/spu/en/](https://www.secretflow.org.cn/docs/spu/en/)

    HEU is a secure computing device that implementing HE encryption and decryption,
    and provides matrix operations similar to the numpy, reducing the threshold for use.
    More detail: [https://www.secretflow.org.cn/docs/heu/en/](https://www.secretflow.org.cn/docs/heu/en/)

    For more detail, please refer to paper in KDD’21:
    [https://dl.acm.org/doi/10.1145/3447548.3467210](https://dl.acm.org/doi/10.1145/3447548.3467210)

    <FieldList>
      <dl>
        <dt className="field-name">
          Parameters
        </dt>

        <dd className="field-body">
          - <Outline.ParameterTarget>spu</Outline.ParameterTarget> – SPU
            SPU device.
          - <Outline.ParameterTarget>heu\_x</Outline.ParameterTarget> – HEU
            HEU device without label.
          - <Outline.ParameterTarget>heu\_y</Outline.ParameterTarget> – HEU
            HEU device with label.
        </dd>
      </dl>
    </FieldList>

    <p className="sidebar-rubric">
      Notes
    </p>

    training dataset should be normalized or standardized,
    otherwise the SGD solver will not converge.

    <strong>Methods:</strong>

    <table>
      <tbody>
        <tr>
          <td>
            [`__init__`](#secretflow.ml.linear.HESSLogisticRegression.__init__ "secretflow.ml.linear.HESSLogisticRegression.__init__")(spu, heu\_x, heu\_y)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [`fit`](#secretflow.ml.linear.HESSLogisticRegression.fit "secretflow.ml.linear.HESSLogisticRegression.fit")(x, y\[, learning\_rate, epochs, batch\_size])
          </td>

          <td>
            Fit linear model with Stochastic Gradient Descent.
          </td>
        </tr>

        <tr>
          <td>
            [`save_model`](#secretflow.ml.linear.HESSLogisticRegression.save_model "secretflow.ml.linear.HESSLogisticRegression.save_model")()
          </td>

          <td>
            Save fit model in LinearModel format.
          </td>
        </tr>

        <tr>
          <td>
            [`load_model`](#secretflow.ml.linear.HESSLogisticRegression.load_model "secretflow.ml.linear.HESSLogisticRegression.load_model")(m)
          </td>

          <td>
            Load LinearModel format model.
          </td>
        </tr>

        <tr>
          <td>
            [`predict`](#secretflow.ml.linear.HESSLogisticRegression.predict "secretflow.ml.linear.HESSLogisticRegression.predict")(x)
          </td>

          <td>
            Probability estimates.
          </td>
        </tr>
      </tbody>
    </table>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.HESSLogisticRegression.__init__"} module={"secretflow.ml.linear"} fullname={"HESSLogisticRegression.__init__"} parameters={["spu", "heu_x", "heu_y"]} description={"Bases: object"}>
      <Outline.Signature fullname="HESSLogisticRegression.__init__" id="secretflow.ml.linear.HESSLogisticRegression.__init__">
        <Outline.Name>\_\_init\_\_</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">spu</span><span>:</span><span>{" "}</span><span className="name">[SPU](secretflow.device.device.device.mdx#secretflow.device.device.spu.SPU "secretflow.device.device.spu.SPU")</span></Outline.Parameter>, <Outline.Parameter><span className="name">heu\_x</span><span>:</span><span>{" "}</span><span className="name">[HEU](secretflow.device.device.device.mdx#secretflow.device.device.heu.HEU "secretflow.device.device.heu.HEU")</span></Outline.Parameter>, <Outline.Parameter><span className="name">heu\_y</span><span>:</span><span>{" "}</span><span className="name">[HEU](secretflow.device.device.device.mdx#secretflow.device.device.heu.HEU "secretflow.device.device.heu.HEU")</span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.11)")</Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.HESSLogisticRegression.fit"} module={"secretflow.ml.linear"} fullname={"HESSLogisticRegression.fit"} parameters={["x", "y", "learning_rate", "epochs", "batch_size"]} description={"Fit linear model with Stochastic Gradient Descent."}>
      <Outline.Signature fullname="HESSLogisticRegression.fit" id="secretflow.ml.linear.HESSLogisticRegression.fit">
        <Outline.Name>fit</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">x</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.mdx#secretflow.data.ndarray.FedNdarray "secretflow.data.ndarray.FedNdarray")<span>{" "}</span><span>|</span><span>{" "}</span>[VDataFrame](secretflow.data.data.vertical.mdx#secretflow.data.vertical.dataframe.VDataFrame "secretflow.data.vertical.dataframe.VDataFrame")</span></Outline.Parameter>, <Outline.Parameter><span className="name">y</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.mdx#secretflow.data.ndarray.FedNdarray "secretflow.data.ndarray.FedNdarray")<span>{" "}</span><span>|</span><span>{" "}</span>[VDataFrame](secretflow.data.data.vertical.mdx#secretflow.data.vertical.dataframe.VDataFrame "secretflow.data.vertical.dataframe.VDataFrame")</span></Outline.Parameter>, <Outline.Parameter><span className="name">learning\_rate</span><span>=</span><span>0.001</span></Outline.Parameter>, <Outline.Parameter><span className="name">epochs</span><span>=</span><span>1</span></Outline.Parameter>, <Outline.Parameter><span className="name">batch\_size</span><span>=</span><span>None</span></Outline.Parameter><span>)</span></Outline.ParameterList>
      </Outline.Signature>

      <Outline.Content>
        Fit linear model with Stochastic Gradient Descent.

        <FieldList>
          <dl>
            <dt className="field-name">
              Parameters
            </dt>

            <dd className="field-body">
              - <Outline.ParameterTarget>x</Outline.ParameterTarget> – \{FedNdarray, VDataFrame}
                Input data, must be colocated with SPU.
              - <Outline.ParameterTarget>y</Outline.ParameterTarget> – \{FedNdarray, VDataFrame}
                Target data, must be located on <cite>self.\_heu\_y</cite>.
              - <Outline.ParameterTarget>learning\_rate</Outline.ParameterTarget> – float, default=1e-3.
                Learning rate.
              - <Outline.ParameterTarget>epochs</Outline.ParameterTarget> – int, default=1
                Number of epochs to train the model
              - <Outline.ParameterTarget>batch\_size</Outline.ParameterTarget> – int, default=None
                Number of samples per gradient update.
                If None, batch\_size will default to number of all samples.
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.HESSLogisticRegression.save_model"} module={"secretflow.ml.linear"} fullname={"HESSLogisticRegression.save_model"} parameters={[]} description={"Save fit model in LinearModel format."}>
      <Outline.Signature fullname="HESSLogisticRegression.save_model" id="secretflow.ml.linear.HESSLogisticRegression.save_model">
        <Outline.Name>save\_model</Outline.Name><Outline.ParameterList><span>(</span><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[LinearModel](#secretflow.ml.linear.linear_model.LinearModel "secretflow.ml.linear.linear_model.LinearModel")</Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content>
        Save fit model in LinearModel format.
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.HESSLogisticRegression.load_model"} module={"secretflow.ml.linear"} fullname={"HESSLogisticRegression.load_model"} parameters={["m"]} description={"Load LinearModel format model."}>
      <Outline.Signature fullname="HESSLogisticRegression.load_model" id="secretflow.ml.linear.HESSLogisticRegression.load_model">
        <Outline.Name>load\_model</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">m</span><span>:</span><span>{" "}</span><span className="name">[LinearModel](#secretflow.ml.linear.linear_model.LinearModel "secretflow.ml.linear.linear_model.LinearModel")</span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.11)")</Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content>
        Load LinearModel format model.
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.HESSLogisticRegression.predict"} module={"secretflow.ml.linear"} fullname={"HESSLogisticRegression.predict"} parameters={["x"]} description={"Probability estimates."}>
      <Outline.Signature fullname="HESSLogisticRegression.predict" id="secretflow.ml.linear.HESSLogisticRegression.predict">
        <Outline.Name>predict</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">x</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.mdx#secretflow.data.ndarray.FedNdarray "secretflow.data.ndarray.FedNdarray")<span>{" "}</span><span>|</span><span>{" "}</span>[VDataFrame](secretflow.data.data.vertical.mdx#secretflow.data.vertical.dataframe.VDataFrame "secretflow.data.vertical.dataframe.VDataFrame")</span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[PYUObject](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYUObject "secretflow.device.device.pyu.PYUObject")</Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content>
        Probability estimates.

        <FieldList>
          <dl>
            <dt className="field-name">
              Parameters
            </dt>

            <dd className="field-body">
              <Outline.ParameterTarget>x</Outline.ParameterTarget> – \{FedNdarray, VDataFrame}
              Predict samples.
            </dd>

            <dt className="field-name">
              Returns
            </dt>

            <dd className="field-body">
              probability of the sample for each class in the model.
            </dd>

            <dt className="field-name">
              Return type
            </dt>

            <dd className="field-body">
              [PYUObject](secretflow.mdx#secretflow.PYUObject "secretflow.PYUObject")
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>
  </Outline.Content>
</Outline>

<Outline domain="py" objectType="class" target={"secretflow.ml.linear.SSRegression"} module={"secretflow.ml.linear"} fullname={"SSRegression"} parameters={["spu"]} description={"Bases: object"}>
  <Outline.Signature fullname="SSRegression" id="secretflow.ml.linear.SSRegression">
    <Outline.Keyword>class<span>{" "}</span></Outline.Keyword><Outline.Prefix>secretflow\.ml.linear.</Outline.Prefix><Outline.Name>SSRegression</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">spu</span><span>:</span><span>{" "}</span><span className="name">[SPU](secretflow.device.device.device.mdx#secretflow.device.device.spu.SPU "secretflow.device.device.spu.SPU")</span></Outline.Parameter><span>)</span></Outline.ParameterList>
  </Outline.Signature>

  <Outline.Content>
    Bases: [`object`](https://docs.python.org/3/library/functions.html#object "(in Python v3.11)")

    This method provides both linear and logistic regression linear models
    for vertical split dataset setting by using secret sharing with mini
    batch SGD training solver. SS-SGD is short for secret sharing SGD training.

    more detail for SGD:
    [https://stats.stackexchange.com/questions/488017/understanding-mini-batch-gradient-descent](https://stats.stackexchange.com/questions/488017/understanding-mini-batch-gradient-descent)

    Linear regression fits a linear model with coefficients w = (w1, …, wp)
    to minimize the residual sum of squares between the observed targets in
    the dataset, and the targets predicted by the linear approximation.

    more detail for linear regression:
    [https://en.wikipedia.org/wiki/Linear\_regression](https://en.wikipedia.org/wiki/Linear_regression)

    Logistic regression, despite its name, is a linear model for classification
    rather than regression. logistic regression is also known in the literature
    as logit regression, maximum-entropy classification (MaxEnt) or the log-linear
    classifier. the probabilities describing the possible outcomes of a single trial
    are modeled using a logistic function. This method can fit binary regularization
    with optional L2 regularization.

    more detail for logistic regression:
    [https://en.wikipedia.org/wiki/Logistic\_regression](https://en.wikipedia.org/wiki/Logistic_regression)

    SPU is a verifiable and measurable secure computing device that running
    under various MPC protocols to provide provable security.

    More detail for SPU:
    [https://www.secretflow.org.cn/docs/spu/en/](https://www.secretflow.org.cn/docs/spu/en/)

    This method protects the original dataset and the final model by secret sharing
    the dataset to SPU device and running model fit under SPU.

    <FieldList>
      <dl>
        <dt className="field-name">
          Parameters
        </dt>

        <dd className="field-body">
          <Outline.ParameterTarget>spu</Outline.ParameterTarget> – secure device.
        </dd>
      </dl>
    </FieldList>

    <p className="sidebar-rubric">
      Notes
    </p>

    training dataset should be normalized or standardized,
    otherwise the SGD solver will not converge.

    <strong>Methods:</strong>

    <table>
      <tbody>
        <tr>
          <td>
            [`__init__`](#secretflow.ml.linear.SSRegression.__init__ "secretflow.ml.linear.SSRegression.__init__")(spu)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [`fit`](#secretflow.ml.linear.SSRegression.fit "secretflow.ml.linear.SSRegression.fit")(x, y, epochs\[, learning\_rate, ...])
          </td>

          <td>
            Fit the model according to the given training data.
          </td>
        </tr>

        <tr>
          <td>
            [`save_model`](#secretflow.ml.linear.SSRegression.save_model "secretflow.ml.linear.SSRegression.save_model")()
          </td>

          <td>
            Save fit model in LinearModel format.
          </td>
        </tr>

        <tr>
          <td>
            [`load_model`](#secretflow.ml.linear.SSRegression.load_model "secretflow.ml.linear.SSRegression.load_model")(m)
          </td>

          <td>
            Load LinearModel format model.
          </td>
        </tr>

        <tr>
          <td>
            [`predict`](#secretflow.ml.linear.SSRegression.predict "secretflow.ml.linear.SSRegression.predict")(x\[, batch\_size, to\_pyu])
          </td>

          <td>
            Predict using the model.
          </td>
        </tr>
      </tbody>
    </table>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.SSRegression.__init__"} module={"secretflow.ml.linear"} fullname={"SSRegression.__init__"} parameters={["spu"]} description={"Bases: object"}>
      <Outline.Signature fullname="SSRegression.__init__" id="secretflow.ml.linear.SSRegression.__init__">
        <Outline.Name>\_\_init\_\_</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">spu</span><span>:</span><span>{" "}</span><span className="name">[SPU](secretflow.device.device.device.mdx#secretflow.device.device.spu.SPU "secretflow.device.device.spu.SPU")</span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.11)")</Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.SSRegression.fit"} module={"secretflow.ml.linear"} fullname={"SSRegression.fit"} parameters={["x", "y", "epochs", "learning_rate", "batch_size", "sig_type", "reg_type", "penalty", "l2_norm", "eps", "decay_epoch", "decay_rate", "strategy"]} description={"Fit the model according to the given training data."}>
      <Outline.Signature fullname="SSRegression.fit" id="secretflow.ml.linear.SSRegression.fit">
        <Outline.Name>fit</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">x</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.mdx#secretflow.data.ndarray.FedNdarray "secretflow.data.ndarray.FedNdarray")<span>{" "}</span><span>|</span><span>{" "}</span>[VDataFrame](secretflow.data.data.vertical.mdx#secretflow.data.vertical.dataframe.VDataFrame "secretflow.data.vertical.dataframe.VDataFrame")</span></Outline.Parameter>, <Outline.Parameter><span className="name">y</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.mdx#secretflow.data.ndarray.FedNdarray "secretflow.data.ndarray.FedNdarray")<span>{" "}</span><span>|</span><span>{" "}</span>[VDataFrame](secretflow.data.data.vertical.mdx#secretflow.data.vertical.dataframe.VDataFrame "secretflow.data.vertical.dataframe.VDataFrame")</span></Outline.Parameter>, <Outline.Parameter><span className="name">epochs</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.11)")</span></Outline.Parameter>, <Outline.Parameter><span className="name">learning\_rate</span><span>:</span><span>{" "}</span><span className="name">[float](https://docs.python.org/3/library/functions.html#float "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>0.1</span></Outline.Parameter>, <Outline.Parameter><span className="name">batch\_size</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>1024</span></Outline.Parameter>, <Outline.Parameter><span className="name">sig\_type</span><span>:</span><span>{" "}</span><span className="name">[str](https://docs.python.org/3/library/stdtypes.html#str "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>'t1'</span></Outline.Parameter>, <Outline.Parameter><span className="name">reg\_type</span><span>:</span><span>{" "}</span><span className="name">[str](https://docs.python.org/3/library/stdtypes.html#str "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>'logistic'</span></Outline.Parameter>, <Outline.Parameter><span className="name">penalty</span><span>:</span><span>{" "}</span><span className="name">[str](https://docs.python.org/3/library/stdtypes.html#str "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>'None'</span></Outline.Parameter>, <Outline.Parameter><span className="name">l2\_norm</span><span>:</span><span>{" "}</span><span className="name">[float](https://docs.python.org/3/library/functions.html#float "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>0.5</span></Outline.Parameter>, <Outline.Parameter><span className="name">eps</span><span>:</span><span>{" "}</span><span className="name">[float](https://docs.python.org/3/library/functions.html#float "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>0.001</span></Outline.Parameter>, <Outline.Parameter><span className="name">decay\_epoch</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.11)")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter>, <Outline.Parameter><span className="name">decay\_rate</span><span>:</span><span>{" "}</span><span className="name">[float](https://docs.python.org/3/library/functions.html#float "(in Python v3.11)")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter>, <Outline.Parameter><span className="name">strategy</span><span>:</span><span>{" "}</span><span className="name">[str](https://docs.python.org/3/library/stdtypes.html#str "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>'naive\_sgd'</span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.11)")</Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content>
        Fit the model according to the given training data.

        <FieldList>
          <dl>
            <dt className="field-name">
              Parameters
            </dt>

            <dd className="field-body">
              - <Outline.ParameterTarget>x</Outline.ParameterTarget> – \{FedNdarray, VDataFrame} of shape (n\_samples, n\_features)
                Training vector, where <cite>n\_samples</cite> is the number of samples and
                <cite>n\_features</cite> is the number of features.
              - <Outline.ParameterTarget>y</Outline.ParameterTarget> – \{FedNdarray, VDataFrame} of shape (n\_samples,)
                Target vector relative to X.
              - <Outline.ParameterTarget>epochs</Outline.ParameterTarget> – int
                iteration rounds.
              - <Outline.ParameterTarget>learning\_rate</Outline.ParameterTarget> – float, default=0.1
                controls how much to change the model in one epoch.
              - <Outline.ParameterTarget>batch\_size</Outline.ParameterTarget> – int, default=1024
                how many samples use in one calculation.
              - <Outline.ParameterTarget>sig\_type</Outline.ParameterTarget> – str, default=t1
                sigmoid approximation type.
              - <Outline.ParameterTarget>reg\_type</Outline.ParameterTarget> – str, default=logistic
                Linear or Logistic regression.
              - <Outline.ParameterTarget>penalty</Outline.ParameterTarget> – str, default=None
                The penalty (aka regularization term) to be used.
              - <Outline.ParameterTarget>l2\_norm</Outline.ParameterTarget> – float, default=0.5
                L2 regularization term.
              - <Outline.ParameterTarget>eps</Outline.ParameterTarget> – float, default=1e-3
                If the W’s change rate is less than this threshold, the model is considered to be converged, and the training stops early. 0 disable.
              - <Outline.ParameterTarget>decay\_rate</Outline.ParameterTarget> (<em>decay\_epoch /</em>) – int, default=None
                decay learning rate, learning\_rate \* (decay\_rate \*\* floor(epoch / decay\_epoch)). None disable
                If strategy=policy\_sgd, then decay\_rate and decay\_epoch have default value 0.5, 5.
              - <Outline.ParameterTarget>strategy</Outline.ParameterTarget> –&#x20;

                str, default=naive\_sgd
                optimization strategy used in training
                > naive\_sgd means origin sgd
                > policy\_sgd(LR only) will scale the learning\_rate in each update like adam but with unify factor,
                so the batch\_size can be larger and the early stop strategy can be more aggressive, which accelerates
                training in most scenery(But not recommend for training with large regularization).
            </dd>

            <dt className="field-name">
              Returns
            </dt>

            <dd className="field-body">
              Final weights in SPUObject.
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.SSRegression.save_model"} module={"secretflow.ml.linear"} fullname={"SSRegression.save_model"} parameters={[]} description={"Save fit model in LinearModel format."}>
      <Outline.Signature fullname="SSRegression.save_model" id="secretflow.ml.linear.SSRegression.save_model">
        <Outline.Name>save\_model</Outline.Name><Outline.ParameterList><span>(</span><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[LinearModel](#secretflow.ml.linear.linear_model.LinearModel "secretflow.ml.linear.linear_model.LinearModel")</Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content>
        Save fit model in LinearModel format.
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.SSRegression.load_model"} module={"secretflow.ml.linear"} fullname={"SSRegression.load_model"} parameters={["m"]} description={"Load LinearModel format model."}>
      <Outline.Signature fullname="SSRegression.load_model" id="secretflow.ml.linear.SSRegression.load_model">
        <Outline.Name>load\_model</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">m</span><span>:</span><span>{" "}</span><span className="name">[LinearModel](#secretflow.ml.linear.linear_model.LinearModel "secretflow.ml.linear.linear_model.LinearModel")</span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.11)")</Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content>
        Load LinearModel format model.
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.SSRegression.predict"} module={"secretflow.ml.linear"} fullname={"SSRegression.predict"} parameters={["x", "batch_size", "to_pyu"]} description={"Predict using the model."}>
      <Outline.Signature fullname="SSRegression.predict" id="secretflow.ml.linear.SSRegression.predict">
        <Outline.Name>predict</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">x</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.mdx#secretflow.data.ndarray.FedNdarray "secretflow.data.ndarray.FedNdarray")<span>{" "}</span><span>|</span><span>{" "}</span>[VDataFrame](secretflow.data.data.vertical.mdx#secretflow.data.vertical.dataframe.VDataFrame "secretflow.data.vertical.dataframe.VDataFrame")</span></Outline.Parameter>, <Outline.Parameter><span className="name">batch\_size</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>1024</span></Outline.Parameter>, <Outline.Parameter><span className="name">to\_pyu</span><span>:</span><span>{" "}</span><span className="name">[PYU](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYU "secretflow.device.device.pyu.PYU")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[SPUObject](secretflow.device.device.device.mdx#secretflow.device.device.spu.SPUObject "secretflow.device.device.spu.SPUObject")<span>{" "}</span><span>|</span><span>{" "}</span>[FedNdarray](secretflow.data.mdx#secretflow.data.ndarray.FedNdarray "secretflow.data.ndarray.FedNdarray")</Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content>
        Predict using the model.

        <FieldList>
          <dl>
            <dt className="field-name">
              Parameters
            </dt>

            <dd className="field-body">
              - <Outline.ParameterTarget>x</Outline.ParameterTarget> – \{FedNdarray, VDataFrame} of shape (n\_samples, n\_features)
                Predict samples.
              - <Outline.ParameterTarget>batch\_size</Outline.ParameterTarget> – int, default=1024
                how many samples use in one calculation.
              - <Outline.ParameterTarget>to\_pyu</Outline.ParameterTarget> – the prediction initiator
                if not None predict result is reveal to to\_pyu device and save as FedNdarray
                otherwise, keep predict result in secret and save as SPUObject.
            </dd>

            <dt className="field-name">
              Returns
            </dt>

            <dd className="field-body">
              pred scores in SPUObject or FedNdarray, shape (n\_samples,)
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>
  </Outline.Content>
</Outline>

<Outline domain="py" objectType="class" target={"secretflow.ml.linear.LinearModel"} module={"secretflow.ml.linear"} fullname={"LinearModel"} parameters={["weights", "reg_type", "sig_type"]} description={"Bases: object"}>
  <Outline.Signature fullname="LinearModel" id="secretflow.ml.linear.LinearModel">
    <Outline.Keyword>class<span>{" "}</span></Outline.Keyword><Outline.Prefix>secretflow\.ml.linear.</Outline.Prefix><Outline.Name>LinearModel</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">weights</span><span>:</span><span>{" "}</span><span className="name">[SPUObject](secretflow.device.device.device.mdx#secretflow.device.device.spu.SPUObject "secretflow.device.device.spu.SPUObject")<span>{" "}</span><span>|</span><span>{" "}</span>[List](https://docs.python.org/3/library/typing.html#typing.List "(in Python v3.11)")<span>\[</span>[PYUObject](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYUObject "secretflow.device.device.pyu.PYUObject")<span>]</span></span></Outline.Parameter>, <Outline.Parameter><span className="name">reg\_type</span><span>:</span><span>{" "}</span><span className="name">[RegType](#secretflow.ml.linear.linear_model.RegType "secretflow.ml.linear.linear_model.RegType")</span></Outline.Parameter>, <Outline.Parameter><span className="name">sig\_type</span><span>:</span><span>{" "}</span><span className="name">[SigType](secretflow.utils.mdx#secretflow.utils.sigmoid.SigType "secretflow.utils.sigmoid.SigType")</span></Outline.Parameter><span>)</span></Outline.ParameterList>
  </Outline.Signature>

  <Outline.Content>
    Bases: [`object`](https://docs.python.org/3/library/functions.html#object "(in Python v3.11)")

    Unified linear regression model.

    <Outline domain="py" objectType="attribute" target={"secretflow.ml.linear.LinearModel.weights"} module={"secretflow.ml.linear"} fullname={"LinearModel.weights"} parameters={["weights", "reg_type", "sig_type"]} description={"{SPUObject, List[PYUObject]}\nfor mpc lr, use SPUObject save all weights; for fl lr, use list of PYUObject."}>
      <Outline.Signature fullname="LinearModel.weights" id="secretflow.ml.linear.LinearModel.weights">
        <Outline.Name>weights</Outline.Name>
      </Outline.Signature>

      <Outline.Content>
        \{SPUObject, List\[PYUObject]}
        for mpc lr, use SPUObject save all weights; for fl lr, use list of PYUObject.

        <FieldList>
          <dl>
            <dt className="field-name">
              Type
            </dt>

            <dd className="field-body">
              [secretflow.device.device.spu.SPUObject](secretflow.device.device.device.mdx#secretflow.device.device.spu.SPUObject "secretflow.device.device.spu.SPUObject") | List\[[secretflow.device.device.pyu.PYUObject](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYUObject "secretflow.device.device.pyu.PYUObject")]
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="attribute" target={"secretflow.ml.linear.LinearModel.reg_type"} module={"secretflow.ml.linear"} fullname={"LinearModel.reg_type"} parameters={["weights", "reg_type", "sig_type"]} description={"RegType\nlinear regression or logistic regression model."}>
      <Outline.Signature fullname="LinearModel.reg_type" id="secretflow.ml.linear.LinearModel.reg_type">
        <Outline.Name>reg\_type</Outline.Name>
      </Outline.Signature>

      <Outline.Content>
        RegType
        linear regression or logistic regression model.

        <FieldList>
          <dl>
            <dt className="field-name">
              Type
            </dt>

            <dd className="field-body">
              [secretflow.ml.linear.linear\_model.RegType](#secretflow.ml.linear.linear_model.RegType "secretflow.ml.linear.linear_model.RegType")
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="attribute" target={"secretflow.ml.linear.LinearModel.sig_type"} module={"secretflow.ml.linear"} fullname={"LinearModel.sig_type"} parameters={["weights", "reg_type", "sig_type"]} description={"SigType\nwhich sigmoid approximation should use, only use in mpc lr."}>
      <Outline.Signature fullname="LinearModel.sig_type" id="secretflow.ml.linear.LinearModel.sig_type">
        <Outline.Name>sig\_type</Outline.Name>
      </Outline.Signature>

      <Outline.Content>
        SigType
        which sigmoid approximation should use, only use in mpc lr.

        <FieldList>
          <dl>
            <dt className="field-name">
              Type
            </dt>

            <dd className="field-body">
              [secretflow.utils.sigmoid.SigType](secretflow.utils.mdx#secretflow.utils.sigmoid.SigType "secretflow.utils.sigmoid.SigType")
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>

    <strong>Attributes:</strong>

    <table>
      <tbody>
        <tr>
          <td>
            [`weights`](#id11 "secretflow.ml.linear.LinearModel.weights")
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [`reg_type`](#id12 "secretflow.ml.linear.LinearModel.reg_type")
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [`sig_type`](#id13 "secretflow.ml.linear.LinearModel.sig_type")
          </td>

          <td>

          </td>
        </tr>
      </tbody>
    </table>

    <strong>Methods:</strong>

    <table>
      <tbody>
        <tr>
          <td>
            [`__init__`](#secretflow.ml.linear.LinearModel.__init__ "secretflow.ml.linear.LinearModel.__init__")(weights, reg\_type, sig\_type)
          </td>

          <td>

          </td>
        </tr>
      </tbody>
    </table>

    <Outline domain="py" objectType="attribute" target={"id11"} module={"secretflow.ml.linear"} fullname={"LinearModel.weights"} parameters={["weights", "reg_type", "sig_type"]} description={"Bases: object"}>
      <Outline.Signature fullname="LinearModel.weights" id="id11">
        <Outline.Name>weights</Outline.Name><Outline.Keyword><span>:</span><span>{" "}</span>[SPUObject](secretflow.device.device.device.mdx#secretflow.device.device.spu.SPUObject "secretflow.device.device.spu.SPUObject")<span>{" "}</span><span>|</span><span>{" "}</span>[List](https://docs.python.org/3/library/typing.html#typing.List "(in Python v3.11)")<span>\[</span>[PYUObject](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYUObject "secretflow.device.device.pyu.PYUObject")<span>]</span></Outline.Keyword>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="attribute" target={"id12"} module={"secretflow.ml.linear"} fullname={"LinearModel.reg_type"} parameters={["weights", "reg_type", "sig_type"]} description={"Bases: object"}>
      <Outline.Signature fullname="LinearModel.reg_type" id="id12">
        <Outline.Name>reg\_type</Outline.Name><Outline.Keyword><span>:</span><span>{" "}</span>[RegType](#secretflow.ml.linear.linear_model.RegType "secretflow.ml.linear.linear_model.RegType")</Outline.Keyword>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="attribute" target={"id13"} module={"secretflow.ml.linear"} fullname={"LinearModel.sig_type"} parameters={["weights", "reg_type", "sig_type"]} description={"Bases: object"}>
      <Outline.Signature fullname="LinearModel.sig_type" id="id13">
        <Outline.Name>sig\_type</Outline.Name><Outline.Keyword><span>:</span><span>{" "}</span>[SigType](secretflow.utils.mdx#secretflow.utils.sigmoid.SigType "secretflow.utils.sigmoid.SigType")</Outline.Keyword>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.LinearModel.__init__"} module={"secretflow.ml.linear"} fullname={"LinearModel.__init__"} parameters={["weights", "reg_type", "sig_type"]} description={"Bases: object"}>
      <Outline.Signature fullname="LinearModel.__init__" id="secretflow.ml.linear.LinearModel.__init__">
        <Outline.Name>\_\_init\_\_</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">weights</span><span>:</span><span>{" "}</span><span className="name">[SPUObject](secretflow.device.device.device.mdx#secretflow.device.device.spu.SPUObject "secretflow.device.device.spu.SPUObject")<span>{" "}</span><span>|</span><span>{" "}</span>[List](https://docs.python.org/3/library/typing.html#typing.List "(in Python v3.11)")<span>\[</span>[PYUObject](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYUObject "secretflow.device.device.pyu.PYUObject")<span>]</span></span></Outline.Parameter>, <Outline.Parameter><span className="name">reg\_type</span><span>:</span><span>{" "}</span><span className="name">[RegType](#secretflow.ml.linear.linear_model.RegType "secretflow.ml.linear.linear_model.RegType")</span></Outline.Parameter>, <Outline.Parameter><span className="name">sig\_type</span><span>:</span><span>{" "}</span><span className="name">[SigType](secretflow.utils.mdx#secretflow.utils.sigmoid.SigType "secretflow.utils.sigmoid.SigType")</span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.11)")</Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content />
    </Outline>
  </Outline.Content>
</Outline>

<Outline domain="py" objectType="class" target={"secretflow.ml.linear.RegType"} module={"secretflow.ml.linear"} fullname={"RegType"} parameters={["value"]} description={"Bases: Enum"}>
  <Outline.Signature fullname="RegType" id="secretflow.ml.linear.RegType">
    <Outline.Keyword>class<span>{" "}</span></Outline.Keyword><Outline.Prefix>secretflow\.ml.linear.</Outline.Prefix><Outline.Name>RegType</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">value</span></Outline.Parameter><span>)</span></Outline.ParameterList>
  </Outline.Signature>

  <Outline.Content>
    Bases: [`Enum`](https://docs.python.org/3/library/enum.html#enum.Enum "(in Python v3.11)")

    An enumeration.

    <strong>Attributes:</strong>

    <table>
      <tbody>
        <tr>
          <td>
            [`Linear`](#secretflow.ml.linear.RegType.Linear "secretflow.ml.linear.RegType.Linear")
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [`Logistic`](#secretflow.ml.linear.RegType.Logistic "secretflow.ml.linear.RegType.Logistic")
          </td>

          <td>

          </td>
        </tr>
      </tbody>
    </table>

    <Outline domain="py" objectType="attribute" target={"secretflow.ml.linear.RegType.Linear"} module={"secretflow.ml.linear"} fullname={"RegType.Linear"} parameters={["value"]} description={"Bases: Enum"}>
      <Outline.Signature fullname="RegType.Linear" id="secretflow.ml.linear.RegType.Linear">
        <Outline.Name>Linear</Outline.Name><Outline.Keyword><span>{" "}</span><span>=</span><span>{" "}</span>'linear'</Outline.Keyword>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="attribute" target={"secretflow.ml.linear.RegType.Logistic"} module={"secretflow.ml.linear"} fullname={"RegType.Logistic"} parameters={["value"]} description={"Bases: Enum"}>
      <Outline.Signature fullname="RegType.Logistic" id="secretflow.ml.linear.RegType.Logistic">
        <Outline.Name>Logistic</Outline.Name><Outline.Keyword><span>{" "}</span><span>=</span><span>{" "}</span>'logistic'</Outline.Keyword>
      </Outline.Signature>

      <Outline.Content />
    </Outline>
  </Outline.Content>
</Outline>

<Outline domain="py" objectType="class" target={"secretflow.ml.linear.SSGLM"} module={"secretflow.ml.linear"} fullname={"SSGLM"} parameters={["spu"]} description={"Bases: object"}>
  <Outline.Signature fullname="SSGLM" id="secretflow.ml.linear.SSGLM">
    <Outline.Keyword>class<span>{" "}</span></Outline.Keyword><Outline.Prefix>secretflow\.ml.linear.</Outline.Prefix><Outline.Name>SSGLM</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">spu</span><span>:</span><span>{" "}</span><span className="name">[SPU](secretflow.device.device.device.mdx#secretflow.device.device.spu.SPU "secretflow.device.device.spu.SPU")</span></Outline.Parameter><span>)</span></Outline.ParameterList>
  </Outline.Signature>

  <Outline.Content>
    Bases: [`object`](https://docs.python.org/3/library/functions.html#object "(in Python v3.11)")

    <strong>Methods:</strong>

    <table>
      <tbody>
        <tr>
          <td>
            [`__init__`](#secretflow.ml.linear.SSGLM.__init__ "secretflow.ml.linear.SSGLM.__init__")(spu)
          </td>

          <td>

          </td>
        </tr>

        <tr>
          <td>
            [`fit_irls`](#secretflow.ml.linear.SSGLM.fit_irls "secretflow.ml.linear.SSGLM.fit_irls")(x, y, offset, weight, epochs, link, ...)
          </td>

          <td>
            Fit the model by IRLS(Iteratively reweighted least squares).
          </td>
        </tr>

        <tr>
          <td>
            [`fit_sgd`](#secretflow.ml.linear.SSGLM.fit_sgd "secretflow.ml.linear.SSGLM.fit_sgd")(x, y, offset, weight, epochs, link, dist)
          </td>

          <td>
            Fit the model by SGD(stochastic gradient descent).
          </td>
        </tr>

        <tr>
          <td>
            [`predict`](#secretflow.ml.linear.SSGLM.predict "secretflow.ml.linear.SSGLM.predict")(x\[, o, to\_pyu])
          </td>

          <td>
            Predict using the model.
          </td>
        </tr>
      </tbody>
    </table>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.SSGLM.__init__"} module={"secretflow.ml.linear"} fullname={"SSGLM.__init__"} parameters={["spu"]} description={"Bases: object"}>
      <Outline.Signature fullname="SSGLM.__init__" id="secretflow.ml.linear.SSGLM.__init__">
        <Outline.Name>\_\_init\_\_</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">spu</span><span>:</span><span>{" "}</span><span className="name">[SPU](secretflow.device.device.device.mdx#secretflow.device.device.spu.SPU "secretflow.device.device.spu.SPU")</span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.11)")</Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content />
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.SSGLM.fit_irls"} module={"secretflow.ml.linear"} fullname={"SSGLM.fit_irls"} parameters={["x", "y", "offset", "weight", "epochs", "link", "dist", "tweedie_power", "scale", "eps"]} description={"Fit the model by IRLS(Iteratively reweighted least squares)."}>
      <Outline.Signature fullname="SSGLM.fit_irls" id="secretflow.ml.linear.SSGLM.fit_irls">
        <Outline.Name>fit\_irls</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">x</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.mdx#secretflow.data.ndarray.FedNdarray "secretflow.data.ndarray.FedNdarray")<span>{" "}</span><span>|</span><span>{" "}</span>[VDataFrame](secretflow.data.data.vertical.mdx#secretflow.data.vertical.dataframe.VDataFrame "secretflow.data.vertical.dataframe.VDataFrame")</span></Outline.Parameter>, <Outline.Parameter><span className="name">y</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.mdx#secretflow.data.ndarray.FedNdarray "secretflow.data.ndarray.FedNdarray")<span>{" "}</span><span>|</span><span>{" "}</span>[VDataFrame](secretflow.data.data.vertical.mdx#secretflow.data.vertical.dataframe.VDataFrame "secretflow.data.vertical.dataframe.VDataFrame")</span></Outline.Parameter>, <Outline.Parameter><span className="name">offset</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.mdx#secretflow.data.ndarray.FedNdarray "secretflow.data.ndarray.FedNdarray")<span>{" "}</span><span>|</span><span>{" "}</span>[VDataFrame](secretflow.data.data.vertical.mdx#secretflow.data.vertical.dataframe.VDataFrame "secretflow.data.vertical.dataframe.VDataFrame")</span></Outline.Parameter>, <Outline.Parameter><span className="name">weight</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.mdx#secretflow.data.ndarray.FedNdarray "secretflow.data.ndarray.FedNdarray")<span>{" "}</span><span>|</span><span>{" "}</span>[VDataFrame](secretflow.data.data.vertical.mdx#secretflow.data.vertical.dataframe.VDataFrame "secretflow.data.vertical.dataframe.VDataFrame")</span></Outline.Parameter>, <Outline.Parameter><span className="name">epochs</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.11)")</span></Outline.Parameter>, <Outline.Parameter><span className="name">link</span><span>:</span><span>{" "}</span><span className="name">[str](https://docs.python.org/3/library/stdtypes.html#str "(in Python v3.11)")</span></Outline.Parameter>, <Outline.Parameter><span className="name">dist</span><span>:</span><span>{" "}</span><span className="name">[str](https://docs.python.org/3/library/stdtypes.html#str "(in Python v3.11)")</span></Outline.Parameter>, <Outline.Parameter><span className="name">tweedie\_power</span><span>:</span><span>{" "}</span><span className="name">[float](https://docs.python.org/3/library/functions.html#float "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>1</span></Outline.Parameter>, <Outline.Parameter><span className="name">scale</span><span>:</span><span>{" "}</span><span className="name">[float](https://docs.python.org/3/library/functions.html#float "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>1</span></Outline.Parameter>, <Outline.Parameter><span className="name">eps</span><span>:</span><span>{" "}</span><span className="name">[float](https://docs.python.org/3/library/functions.html#float "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>0.0001</span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.11)")</Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content>
        Fit the model by IRLS(Iteratively reweighted least squares).

        <FieldList>
          <dl>
            <dt className="field-name">
              Parameters
            </dt>

            <dd className="field-body">
              - <Outline.ParameterTarget>x</Outline.ParameterTarget> – \{FedNdarray, VDataFrame} of shape (n\_samples, n\_features)
                Training vector, where <cite>n\_samples</cite> is the number of samples and
                <cite>n\_features</cite> is the number of features.
              - <Outline.ParameterTarget>y</Outline.ParameterTarget> – \{FedNdarray, VDataFrame} of shape (n\_samples,)
                Target vector relative to X.
              - <Outline.ParameterTarget>offset</Outline.ParameterTarget> – \{FedNdarray, VDataFrame} of shape (n\_samples,)
                Specify a column to use as the offset, Offsets are per-row “bias values” that are used during model training.
              - <Outline.ParameterTarget>weight</Outline.ParameterTarget> – \{FedNdarray, VDataFrame} of shape (n\_samples,)
                Specify a column to use for the observation weights, which are used for bias correction.
              - <Outline.ParameterTarget>epochs</Outline.ParameterTarget> – int
                iteration rounds.
              - <Outline.ParameterTarget>link</Outline.ParameterTarget> – str
                Specify a link function (Logit, Log, Reciprocal, Indentity)
              - <Outline.ParameterTarget>dist</Outline.ParameterTarget> – str
                Specify a probability distribution (Bernoulli, Poisson, Gamma, Tweedie)
              - <Outline.ParameterTarget>tweedie\_power</Outline.ParameterTarget> –&#x20;

                float
                Tweedie distributions are a family of distributions that include normal, gamma, poisson and their combinations.
                > 0: Specialized as normal
                > 1: Specialized as poisson
                > 2: Specialized as gamma
                > (1,2): combinations of gamma and poisson
              - <Outline.ParameterTarget>scale</Outline.ParameterTarget> – float
                A guess value for distribution’s scale.
              - <Outline.ParameterTarget>learning\_rate</Outline.ParameterTarget> – float, default=0.1
                controls how much to change the model in one epoch.
              - <Outline.ParameterTarget>batch\_size</Outline.ParameterTarget> – int, default=1024
                how many samples use in one calculation.
              - <Outline.ParameterTarget>iter\_start\_irls</Outline.ParameterTarget> – int, default=0
                run a few rounds of irls training as the initialization of w, 0 disable.
              - <Outline.ParameterTarget>eps</Outline.ParameterTarget> – float, default=1e-4
                If the W’s change rate is less than this threshold, the model is considered to be converged, and the training stops early. 0 disable.
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.SSGLM.fit_sgd"} module={"secretflow.ml.linear"} fullname={"SSGLM.fit_sgd"} parameters={["x", "y", "offset", "weight", "epochs", "link", "dist", "tweedie_power", "scale", "learning_rate", "batch_size", "iter_start_irls", "eps", "decay_epoch", "decay_rate"]} description={"Fit the model by SGD(stochastic gradient descent)."}>
      <Outline.Signature fullname="SSGLM.fit_sgd" id="secretflow.ml.linear.SSGLM.fit_sgd">
        <Outline.Name>fit\_sgd</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">x</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.mdx#secretflow.data.ndarray.FedNdarray "secretflow.data.ndarray.FedNdarray")<span>{" "}</span><span>|</span><span>{" "}</span>[VDataFrame](secretflow.data.data.vertical.mdx#secretflow.data.vertical.dataframe.VDataFrame "secretflow.data.vertical.dataframe.VDataFrame")</span></Outline.Parameter>, <Outline.Parameter><span className="name">y</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.mdx#secretflow.data.ndarray.FedNdarray "secretflow.data.ndarray.FedNdarray")<span>{" "}</span><span>|</span><span>{" "}</span>[VDataFrame](secretflow.data.data.vertical.mdx#secretflow.data.vertical.dataframe.VDataFrame "secretflow.data.vertical.dataframe.VDataFrame")</span></Outline.Parameter>, <Outline.Parameter><span className="name">offset</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.mdx#secretflow.data.ndarray.FedNdarray "secretflow.data.ndarray.FedNdarray")<span>{" "}</span><span>|</span><span>{" "}</span>[VDataFrame](secretflow.data.data.vertical.mdx#secretflow.data.vertical.dataframe.VDataFrame "secretflow.data.vertical.dataframe.VDataFrame")</span></Outline.Parameter>, <Outline.Parameter><span className="name">weight</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.mdx#secretflow.data.ndarray.FedNdarray "secretflow.data.ndarray.FedNdarray")<span>{" "}</span><span>|</span><span>{" "}</span>[VDataFrame](secretflow.data.data.vertical.mdx#secretflow.data.vertical.dataframe.VDataFrame "secretflow.data.vertical.dataframe.VDataFrame")</span></Outline.Parameter>, <Outline.Parameter><span className="name">epochs</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.11)")</span></Outline.Parameter>, <Outline.Parameter><span className="name">link</span><span>:</span><span>{" "}</span><span className="name">[str](https://docs.python.org/3/library/stdtypes.html#str "(in Python v3.11)")</span></Outline.Parameter>, <Outline.Parameter><span className="name">dist</span><span>:</span><span>{" "}</span><span className="name">[str](https://docs.python.org/3/library/stdtypes.html#str "(in Python v3.11)")</span></Outline.Parameter>, <Outline.Parameter><span className="name">tweedie\_power</span><span>:</span><span>{" "}</span><span className="name">[float](https://docs.python.org/3/library/functions.html#float "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>1</span></Outline.Parameter>, <Outline.Parameter><span className="name">scale</span><span>:</span><span>{" "}</span><span className="name">[float](https://docs.python.org/3/library/functions.html#float "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>1</span></Outline.Parameter>, <Outline.Parameter><span className="name">learning\_rate</span><span>:</span><span>{" "}</span><span className="name">[float](https://docs.python.org/3/library/functions.html#float "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>0.1</span></Outline.Parameter>, <Outline.Parameter><span className="name">batch\_size</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>1024</span></Outline.Parameter>, <Outline.Parameter><span className="name">iter\_start\_irls</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>0</span></Outline.Parameter>, <Outline.Parameter><span className="name">eps</span><span>:</span><span>{" "}</span><span className="name">[float](https://docs.python.org/3/library/functions.html#float "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>0.0001</span></Outline.Parameter>, <Outline.Parameter><span className="name">decay\_epoch</span><span>:</span><span>{" "}</span><span className="name">[int](https://docs.python.org/3/library/functions.html#int "(in Python v3.11)")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter>, <Outline.Parameter><span className="name">decay\_rate</span><span>:</span><span>{" "}</span><span className="name">[float](https://docs.python.org/3/library/functions.html#float "(in Python v3.11)")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.11)")</Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content>
        Fit the model by SGD(stochastic gradient descent).

        <FieldList>
          <dl>
            <dt className="field-name">
              Parameters
            </dt>

            <dd className="field-body">
              - <Outline.ParameterTarget>x</Outline.ParameterTarget> – \{FedNdarray, VDataFrame} of shape (n\_samples, n\_features)
                Training vector, where <cite>n\_samples</cite> is the number of samples and
                <cite>n\_features</cite> is the number of features.
              - <Outline.ParameterTarget>y</Outline.ParameterTarget> – \{FedNdarray, VDataFrame} of shape (n\_samples,)
                Target vector relative to X.
              - <Outline.ParameterTarget>offset</Outline.ParameterTarget> – \{FedNdarray, VDataFrame} of shape (n\_samples,)
                Specify a column to use as the offset, Offsets are per-row “bias values” that are used during model training.
              - <Outline.ParameterTarget>weight</Outline.ParameterTarget> – \{FedNdarray, VDataFrame} of shape (n\_samples,)
                Specify a column to use for the observation weights, which are used for bias correction.
              - <Outline.ParameterTarget>epochs</Outline.ParameterTarget> – int
                iteration rounds.
              - <Outline.ParameterTarget>link</Outline.ParameterTarget> – str
                Specify a link function (Logit, Log, Reciprocal, Indentity)
              - <Outline.ParameterTarget>dist</Outline.ParameterTarget> – str
                Specify a probability distribution (Bernoulli, Poisson, Gamma, Tweedie)
              - <Outline.ParameterTarget>tweedie\_power</Outline.ParameterTarget> –&#x20;

                float
                Tweedie distributions are a family of distributions that include normal, gamma, poisson and their combinations.
                > 0: Specialized as normal
                > 1: Specialized as poisson
                > 2: Specialized as gamma
                > (1,2): combinations of gamma and poisson
              - <Outline.ParameterTarget>scale</Outline.ParameterTarget> – float
                A guess value for distribution’s scale.
              - <Outline.ParameterTarget>learning\_rate</Outline.ParameterTarget> – float, default=0.1
                controls how much to change the model in one epoch.
              - <Outline.ParameterTarget>batch\_size</Outline.ParameterTarget> – int, default=1024
                how many samples use in one calculation.
              - <Outline.ParameterTarget>iter\_start\_irls</Outline.ParameterTarget> – int, default=0
                run a few rounds of irls training as the initialization of w, 0 disable.
              - <Outline.ParameterTarget>eps</Outline.ParameterTarget> – float, default=1e-4
                If the W’s change rate is less than this threshold, the model is considered to be converged, and the training stops early. 0 disable.
              - <Outline.ParameterTarget>decay\_rate</Outline.ParameterTarget> (<em>decay\_epoch /</em>) – int, default=None
                decay learning rate, learning\_rate \* (decay\_rate \*\* floor(epoch / decay\_epoch)). None disable
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>

    <Outline domain="py" objectType="method" target={"secretflow.ml.linear.SSGLM.predict"} module={"secretflow.ml.linear"} fullname={"SSGLM.predict"} parameters={["x", "o", "to_pyu"]} description={"Predict using the model."}>
      <Outline.Signature fullname="SSGLM.predict" id="secretflow.ml.linear.SSGLM.predict">
        <Outline.Name>predict</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">x</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.mdx#secretflow.data.ndarray.FedNdarray "secretflow.data.ndarray.FedNdarray")<span>{" "}</span><span>|</span><span>{" "}</span>[VDataFrame](secretflow.data.data.vertical.mdx#secretflow.data.vertical.dataframe.VDataFrame "secretflow.data.vertical.dataframe.VDataFrame")</span></Outline.Parameter>, <Outline.Parameter><span className="name">o</span><span>:</span><span>{" "}</span><span className="name">[FedNdarray](secretflow.data.mdx#secretflow.data.ndarray.FedNdarray "secretflow.data.ndarray.FedNdarray")<span>{" "}</span><span>|</span><span>{" "}</span>[VDataFrame](secretflow.data.data.vertical.mdx#secretflow.data.vertical.dataframe.VDataFrame "secretflow.data.vertical.dataframe.VDataFrame")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter>, <Outline.Parameter><span className="name">to\_pyu</span><span>:</span><span>{" "}</span><span className="name">[PYU](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYU "secretflow.device.device.pyu.PYU")<span>{" "}</span><span>|</span><span>{" "}</span>[None](https://docs.python.org/3/library/constants.html#None "(in Python v3.11)")</span><span>{" "}</span><span>=</span><span>{" "}</span><span>None</span></Outline.Parameter><span>)</span></Outline.ParameterList><Outline.ReturnType><span>{" \u2192 "}</span>[SPUObject](secretflow.device.device.device.mdx#secretflow.device.device.spu.SPUObject "secretflow.device.device.spu.SPUObject")<span>{" "}</span><span>|</span><span>{" "}</span>[PYUObject](secretflow.device.device.device.mdx#secretflow.device.device.pyu.PYUObject "secretflow.device.device.pyu.PYUObject")</Outline.ReturnType>
      </Outline.Signature>

      <Outline.Content>
        Predict using the model.

        <FieldList>
          <dl>
            <dt className="field-name">
              Parameters
            </dt>

            <dd className="field-body">
              - <Outline.ParameterTarget>x</Outline.ParameterTarget> – \{FedNdarray, VDataFrame} of shape (n\_samples, n\_features)
                Predict samples.
              - <Outline.ParameterTarget>o</Outline.ParameterTarget> – \{FedNdarray, VDataFrame} of shape (n\_samples,)
                Specify a column to use as the offset as per-row “bias values” use in predict
              - <Outline.ParameterTarget>to\_pyu</Outline.ParameterTarget> – the prediction initiator
                if not None predict result is reveal to to\_pyu device and save as FedNdarray
                otherwise, keep predict result in secret and save as SPUObject.
            </dd>

            <dt className="field-name">
              Returns
            </dt>

            <dd className="field-body">
              pred scores in SPUObject, shape (n\_samples,)
            </dd>
          </dl>
        </FieldList>
      </Outline.Content>
    </Outline>
  </Outline.Content>
</Outline>
